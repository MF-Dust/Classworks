var Xs=Object.defineProperty;var Ks=(n,e,t)=>e in n?Xs(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var z=(n,e,t)=>Ks(n,typeof e!="symbol"?e+"":e,t);import{V as Qt,a as at,b as Un,m as Qs,H as Js,M as ea,c as ta,d as na,e as jt,p as Hn,u as jn}from"./VSheet-C1lpgMpg.js";import{_ as fs,h as A,s as Ie,f as G,o as T,w as f,c as h,i as v,j as ue,k as E,l as w,n as L,q as te,t as sa,v as C,x as ce,T as Jt,F as K,y as re,z as ps,g as Ee,p as _e,b as Re,A as aa,B as W,C as rn,I as St,D as ms,M as gs,E as ln,G as ia,H as ot,J as ze,K as Tt,L as en,N as _t,O as tn,P as ks,Q as lt,R as bs,S as ys,U as ra,W as la,X as oa,Y as ca,Z as ua,$ as da,a0 as ha,r as Gt,a1 as Gn,a2 as Wt,a3 as Wn,a4 as fa,a5 as kt,a6 as pa,a7 as Yn}from"./index-Co3nJdql.js";import{V as le,a as Se,b as oe,c as ma,d as ga,e as bt,f as ka,g as yt,h as Yt,i as ba}from"./VRow-l3sFO9V_.js";import{V as Ce,a as Te,b as ya,c as xa,d as va,e as wa,f as Sa,g as Ta}from"./VSpacer-Dk5eErFK.js";import{V as _a,a as Da}from"./VTextField-CYXbqfUk.js";import"./ssrBoot-gyfxiZHJ.js";const Aa={name:"RandomPicker",props:{studentList:{type:Array,required:!0},attendance:{type:Object,required:!0,default:()=>({absent:[],late:[],exclude:[]})}},data(){return{dialog:!1,count:A("randomPicker.defaultCount"),pickingMode:"individual",numberOfGroups:A("randomPicker.numberOfGroups"),isPickingStarted:!1,isAnimating:!1,pickedStudents:[],pickedGroups:[],animationStudents:[],highlightedIndices:[],animationTimer:null,getSetting:A,tempFilters:{excludeAbsent:A("randomPicker.excludeAbsent"),excludeLate:A("randomPicker.excludeLate"),excludeExcluded:A("randomPicker.excludeExcluded")}}},computed:{absentCount(){return this.attendance.absent?this.attendance.absent.length:0},lateCount(){return this.attendance.late?this.attendance.late.length:0},excludedCount(){return this.attendance.exclude?this.attendance.exclude.length:0},filteredStudents(){return!this.studentList||!this.studentList.length?[]:this.studentList.filter(n=>!(this.tempFilters.excludeAbsent&&this.attendance.absent.includes(n)||this.tempFilters.excludeLate&&this.attendance.late.includes(n)||this.tempFilters.excludeExcluded&&this.attendance.exclude.includes(n)))},availableStudents(){return this.filteredStudents},maxAllowedCount(){if(this.pickingMode==="individual")return Math.min(A("randomPicker.maxCount"),this.filteredStudents.length);{const n=Ie["randomPicker.numberOfGroups"].validate?Ie["randomPicker.numberOfGroups"].validate(10)?10:2:10;return Math.min(n,Math.floor(this.filteredStudents.length/2))}},minAllowedCount(){return this.pickingMode==="individual"?1:2},countLabel(){return this.pickingMode==="individual"?"人数":"组数"},startDisabled(){return this.pickingMode==="individual"?this.filteredStudents.length===0||this.count>this.filteredStudents.length:this.filteredStudents.length<this.numberOfGroups||this.numberOfGroups<2},remainingStudents(){return this.filteredStudents.filter(n=>!this.pickedStudents.includes(n))}},watch:{dialog(n){n?(this.count=A("randomPicker.defaultCount"),this.isPickingStarted=!1,this.isAnimating=!1,this.pickedStudents=[],this.tempFilters={excludeAbsent:A("randomPicker.excludeAbsent"),excludeLate:A("randomPicker.excludeLate"),excludeExcluded:A("randomPicker.excludeExcluded")}):this.animationTimer&&(clearTimeout(this.animationTimer),this.animationTimer=null)},tempFilters:{handler(){this.count>this.maxAllowedCount&&(this.count=Math.max(1,this.maxAllowedCount))},deep:!0}},methods:{open(){this.dialog=!0,this.resetPicker(!1),this.count=A("randomPicker.defaultCount"),this.numberOfGroups=A("randomPicker.numberOfGroups"),this.tempFilters.excludeAbsent=A("randomPicker.excludeAbsent"),this.tempFilters.excludeLate=A("randomPicker.excludeLate"),this.tempFilters.excludeExcluded=A("randomPicker.excludeExcluded")},decrementCount(){this.pickingMode==="individual"&&this.count>1?this.count--:this.pickingMode==="group"&&this.numberOfGroups>this.minAllowedCount&&this.numberOfGroups--},incrementCount(){this.pickingMode==="individual"&&this.count<this.maxAllowedCount?this.count++:this.pickingMode==="group"&&this.numberOfGroups<this.maxAllowedCount&&this.numberOfGroups++},startPicking(){this.startDisabled||(this.isPickingStarted=!0,this.pickedStudents=[],this.pickedGroups=[],this.pickingMode==="individual"?this.startIndividualPicking():this.startGroupPicking())},startIndividualPicking(){A("randomPicker.animation")&&this.count>0?(this.isAnimating=!0,this.runAnimation(()=>{this.pickStudents(),this.isAnimating=!1})):(this.pickStudents(),this.isAnimating=!1)},startGroupPicking(){this.isAnimating=!1,this.pickGroups()},pickStudents(){const n=[...this.filteredStudents].sort(()=>.5-Math.random());this.pickedStudents=n.slice(0,this.count)},pickGroups(){if(this.filteredStudents.length<this.numberOfGroups||this.numberOfGroups<2){console.error("无法分组，学生人数不足或组数无效"),this.pickedGroups=[];return}let n=[...this.filteredStudents].sort(()=>.5-Math.random());const e=Array.from({length:this.numberOfGroups},()=>[]);let t=0;n.forEach(a=>{e[t].push(a),t=(t+1)%this.numberOfGroups}),this.pickedGroups=e},runAnimation(n){let t=0;const a=50,s=()=>{this.highlightedIndices=[];const i=[];for(let o=0;o<this.count;o++){let d;do d=Math.floor(Math.random()*this.animationStudents.length);while(i.includes(d));i.push(d)}this.highlightedIndices=i,t++;const l=a+t*20;t<5?this.animationTimer=setTimeout(s,l):setTimeout(()=>{this.finishPicking()},500)};s()},finishPicking(){this.isAnimating=!1;const n=[...this.filteredStudents].sort(()=>.5-Math.random());this.pickedStudents=n.slice(0,this.count)},resetPicker(){this.isPickingStarted=!1,this.isAnimating=!1,this.pickedStudents=[],this.pickedGroups=[],this.animationStudents=[],this.highlightedIndices=[],clearTimeout(this.animationTimer),this.count=A("randomPicker.defaultCount"),this.numberOfGroups=A("randomPicker.numberOfGroups"),resetFilters&&(this.tempFilters.excludeAbsent=A("randomPicker.excludeAbsent"),this.tempFilters.excludeLate=A("randomPicker.excludeLate"),this.tempFilters.excludeExcluded=A("randomPicker.excludeExcluded"))}}},Ca={class:"text-h6 mb-4"},Ea={class:"d-flex justify-center align-center counter-container"},Ra={class:"count-display mx-8"},La={class:"text-h2 font-weight-bold"},Pa={class:"text-subtitle-1 ml-2"},Ma={class:"mt-4"},Na={key:0,class:"mt-4 text-warning"},Oa={key:1,class:"mt-4 text-error"},Ia={class:"mt-4 text-caption"},za={class:"pa-2"},Fa={key:0},Va={key:1},Ba={key:2},Ua={class:"d-flex flex-wrap justify-center gap-2 mt-4"},Ha={key:0,class:"animation-container"},ja={class:"animation-wrapper"},Ga={key:1,class:"result-display"},Wa={key:0},Ya={key:1},qa={key:0,class:"text-grey"},$a={class:"mt-8 d-flex justify-center"};function Za(n,e,t,a,s,i){return T(),G(at,{modelValue:s.dialog,"onUpdate:modelValue":e[7]||(e[7]=l=>s.dialog=l),"max-width":"600","fullscreen-breakpoint":"sm"},{default:f(()=>[h(le,{class:"random-picker-card"},{default:f(()=>[h(Se,{class:"text-h5 d-flex align-center"},{default:f(()=>[h(ue,{icon:"mdi-account-question",class:"mr-2"}),e[8]||(e[8]=v(" 随机抽选 ")),h(Ce),h(E,{icon:"mdi-close",variant:"text",onClick:e[0]||(e[0]=l=>s.dialog=!1)})]),_:1}),s.isPickingStarted?(T(),G(oe,{key:1,class:"text-center py-6"},{default:f(()=>[s.isAnimating&&s.pickingMode==="individual"?(T(),L("div",Ha,[w("div",ja,[h(Jt,{name:"shuffle",tag:"div",class:"shuffle-container"},{default:f(()=>[(T(!0),L(K,null,re(s.animationStudents,(l,o)=>(T(),L("div",{key:l.id,class:ps(["student-item",{highlighted:s.highlightedIndices.includes(o)}])},C(l.name),3))),128))]),_:1})])])):(T(),L("div",Ga,[e[14]||(e[14]=w("div",{class:"text-h6 mb-4"},"抽取结果",-1)),s.pickingMode==="individual"?(T(),L("div",Wa,[(T(!0),L(K,null,re(s.pickedStudents,(l,o)=>(T(),G(le,{key:o,variant:"outlined",color:"primary",class:"mb-2 result-card"},{default:f(()=>[h(oe,{class:"text-h4 text-center py-4 d-flex align-center justify-center"},{default:f(()=>[v(C(l)+" ",1),h(E,{icon:"mdi-refresh",variant:"text",size:"small",class:"ml-2 refresh-btn",onClick:d=>n.refreshSingleStudent(o),disabled:i.remainingStudents.length===0,title:i.remainingStudents.length===0?"没有更多可用学生":"重新抽取此学生"},null,8,["onClick","disabled","title"])]),_:2},1024)]),_:2},1024))),128))])):s.pickingMode==="group"?(T(),L("div",Ya,[(T(!0),L(K,null,re(s.pickedGroups,(l,o)=>(T(),G(le,{key:o,class:"mb-3 group-result-card",variant:"tonal"},{default:f(()=>[h(Se,{class:"group-title"},{default:f(()=>[v("小组 "+C(o+1),1)]),_:2},1024),h(oe,null,{default:f(()=>[(T(!0),L(K,null,re(l,d=>(T(),G(Te,{key:d,class:"student-chip",label:"",size:"large"},{default:f(()=>[v(C(d),1)]),_:2},1024))),128)),l.length===0?(T(),L("div",qa,"（空）")):te("",!0)]),_:2},1024)]),_:2},1024))),128))])):te("",!0),w("div",$a,[h(E,{color:"primary","prepend-icon":"mdi-refresh",onClick:e[5]||(e[5]=l=>i.resetPicker()),size:"large",class:"mx-2"},{default:f(()=>e[12]||(e[12]=[v(" 重新抽取 ")])),_:1}),h(E,{color:"grey",variant:"outlined",onClick:e[6]||(e[6]=l=>s.dialog=!1),size:"large",class:"mx-2"},{default:f(()=>e[13]||(e[13]=[v(" 关闭 ")])),_:1})])]))]),_:1})):(T(),G(oe,{key:0,class:"text-center py-6"},{default:f(()=>[h(sa,{modelValue:s.pickingMode,"onUpdate:modelValue":e[1]||(e[1]=l=>s.pickingMode=l),mandatory:"",color:"primary",variant:"outlined",class:"mode-toggle"},{default:f(()=>[h(E,{value:"individual","prepend-icon":"mdi-account"},{default:f(()=>e[9]||(e[9]=[v(" 抽个人 ")])),_:1}),h(E,{value:"group","prepend-icon":"mdi-account-group"},{default:f(()=>e[10]||(e[10]=[v(" 抽小组 ")])),_:1})]),_:1},8,["modelValue"]),w("div",Ca,"请选择抽取"+C(i.countLabel),1),w("div",Ea,[h(E,{size:"x-large",icon:"mdi-minus",variant:"tonal",color:"primary",disabled:(s.pickingMode==="individual"?s.count:s.numberOfGroups)<=i.minAllowedCount,onClick:i.decrementCount,class:"counter-btn"},null,8,["disabled","onClick"]),w("div",Ra,[w("span",La,C(s.pickingMode==="individual"?s.count:s.numberOfGroups),1),w("span",Pa,C(i.countLabel),1)]),h(E,{size:"x-large",icon:"mdi-plus",variant:"tonal",color:"primary",disabled:(s.pickingMode==="individual"?s.count:s.numberOfGroups)>=i.maxAllowedCount,onClick:i.incrementCount,class:"counter-btn"},null,8,["disabled","onClick"])]),w("div",Ma,[h(E,{size:"x-large",color:"primary","prepend-icon":"mdi-dice-multiple",onClick:i.startPicking,disabled:i.startDisabled,class:"start-btn"},{default:f(()=>e[11]||(e[11]=[v(" 开始抽取 ")])),_:1},8,["onClick","disabled"])]),i.startDisabled&&i.filteredStudents.length>0?(T(),L("div",Na,C(s.pickingMode==="group"?"学生人数不足以分成所选组数":"可抽取学生人数不足"),1)):i.filteredStudents.length===0?(T(),L("div",Oa," 没有可抽取的学生，请调整过滤选项 ")):te("",!0),w("div",Ia,[v(" 当前可抽取学生: "+C(i.filteredStudents.length)+"人 ",1),h(Qt,{location:"bottom"},{activator:f(({props:l})=>[h(ue,ce(l,{icon:"mdi-information-outline",size:"small",class:"ml-1"}),null,16)]),default:f(()=>[w("div",za,[s.tempFilters.excludeAbsent?(T(),L("div",Fa,"• 已排除请假学生 ("+C(i.absentCount)+"人)",1)):te("",!0),s.tempFilters.excludeLate?(T(),L("div",Va,"• 已排除迟到学生 ("+C(i.lateCount)+"人)",1)):te("",!0),s.tempFilters.excludeExcluded?(T(),L("div",Ba,"• 已排除不参与学生 ("+C(i.excludedCount)+"人)",1)):te("",!0)])]),_:1}),w("div",Ua,[h(Te,{color:s.tempFilters.excludeLate?"warning":"default",variant:s.tempFilters.excludeLate?"elevated":"text",onClick:e[2]||(e[2]=l=>s.tempFilters.excludeLate=!s.tempFilters.excludeLate),"prepend-icon":"mdi-clock-alert",class:"filter-chip"},{default:f(()=>[v(C(s.tempFilters.excludeLate?"排除":"包含")+"迟到学生 ",1)]),_:1},8,["color","variant"]),h(Te,{color:s.tempFilters.excludeAbsent?"error":"default",variant:s.tempFilters.excludeAbsent?"elevated":"text",onClick:e[3]||(e[3]=l=>s.tempFilters.excludeAbsent=!s.tempFilters.excludeAbsent),"prepend-icon":"mdi-account-off",class:"filter-chip"},{default:f(()=>[v(C(s.tempFilters.excludeAbsent?"排除":"包含")+"请假学生 ",1)]),_:1},8,["color","variant"]),h(Te,{color:s.tempFilters.excludeExcluded?"grey":"default",variant:s.tempFilters.excludeExcluded?"elevated":"text",onClick:e[4]||(e[4]=l=>s.tempFilters.excludeExcluded=!s.tempFilters.excludeExcluded),"prepend-icon":"mdi-account-cancel",class:"filter-chip"},{default:f(()=>[v(C(s.tempFilters.excludeExcluded?"排除":"包含")+"不参与学生 ",1)]),_:1},8,["color","variant"])])])]),_:1}))]),_:1})]),_:1},8,["modelValue"])}const Xa=fs(Aa,[["render",Za],["__scopeId","data-v-8126bf3a"]]);function Ka(n,e){let t=null;return function(...a){t&&clearTimeout(t),t=setTimeout(()=>{n.apply(this,a)},e)}}function Qa(n,e){let t=null,a=0;return function(...s){const i=Date.now();i-a<e?(t&&clearTimeout(t),t=setTimeout(()=>{a=i,n.apply(this,s)},e)):(a=i,n.apply(this,s))}}function on(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}let Ve=on();function xs(n){Ve=n}const it={exec:()=>null};function N(n,e=""){let t=typeof n=="string"?n:n.source;const a={replace:(s,i)=>{let l=typeof i=="string"?i:i.source;return l=l.replace(ne.caret,"$1"),t=t.replace(s,l),a},getRegex:()=>new RegExp(t,e)};return a}const ne={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:n=>new RegExp(`^( {0,3}${n})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}#`),htmlBeginRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}<(?:[a-z].*>|!--)`,"i")},Ja=/^(?:[ \t]*(?:\n|$))+/,ei=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,ti=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,ct=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,ni=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,cn=/(?:[*+-]|\d{1,9}[.)])/,vs=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,ws=N(vs).replace(/bull/g,cn).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),si=N(vs).replace(/bull/g,cn).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),un=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,ai=/^[^\n]+/,dn=/(?!\s*\])(?:\\.|[^\[\]\\])+/,ii=N(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",dn).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),ri=N(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,cn).getRegex(),Rt="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",hn=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,li=N("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",hn).replace("tag",Rt).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Ss=N(un).replace("hr",ct).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Rt).getRegex(),oi=N(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",Ss).getRegex(),fn={blockquote:oi,code:ei,def:ii,fences:ti,heading:ni,hr:ct,html:li,lheading:ws,list:ri,newline:Ja,paragraph:Ss,table:it,text:ai},qn=N("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",ct).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Rt).getRegex(),ci={...fn,lheading:si,table:qn,paragraph:N(un).replace("hr",ct).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",qn).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Rt).getRegex()},ui={...fn,html:N(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",hn).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:it,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:N(un).replace("hr",ct).replace("heading",` *#{1,6} *[^
]`).replace("lheading",ws).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},di=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,hi=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,Ts=/^( {2,}|\\)\n(?!\s*$)/,fi=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,Lt=/[\p{P}\p{S}]/u,pn=/[\s\p{P}\p{S}]/u,_s=/[^\s\p{P}\p{S}]/u,pi=N(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,pn).getRegex(),Ds=/(?!~)[\p{P}\p{S}]/u,mi=/(?!~)[\s\p{P}\p{S}]/u,gi=/(?:[^\s\p{P}\p{S}]|~)/u,ki=/\[[^[\]]*?\]\((?:\\.|[^\\\(\)]|\((?:\\.|[^\\\(\)])*\))*\)|`[^`]*?`|<[^<>]*?>/g,As=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,bi=N(As,"u").replace(/punct/g,Lt).getRegex(),yi=N(As,"u").replace(/punct/g,Ds).getRegex(),Cs="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",xi=N(Cs,"gu").replace(/notPunctSpace/g,_s).replace(/punctSpace/g,pn).replace(/punct/g,Lt).getRegex(),vi=N(Cs,"gu").replace(/notPunctSpace/g,gi).replace(/punctSpace/g,mi).replace(/punct/g,Ds).getRegex(),wi=N("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,_s).replace(/punctSpace/g,pn).replace(/punct/g,Lt).getRegex(),Si=N(/\\(punct)/,"gu").replace(/punct/g,Lt).getRegex(),Ti=N(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),_i=N(hn).replace("(?:-->|$)","-->").getRegex(),Di=N("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",_i).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),At=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,Ai=N(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",At).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),Es=N(/^!?\[(label)\]\[(ref)\]/).replace("label",At).replace("ref",dn).getRegex(),Rs=N(/^!?\[(ref)\](?:\[\])?/).replace("ref",dn).getRegex(),Ci=N("reflink|nolink(?!\\()","g").replace("reflink",Es).replace("nolink",Rs).getRegex(),mn={_backpedal:it,anyPunctuation:Si,autolink:Ti,blockSkip:ki,br:Ts,code:hi,del:it,emStrongLDelim:bi,emStrongRDelimAst:xi,emStrongRDelimUnd:wi,escape:di,link:Ai,nolink:Rs,punctuation:pi,reflink:Es,reflinkSearch:Ci,tag:Di,text:fi,url:it},Ei={...mn,link:N(/^!?\[(label)\]\((.*?)\)/).replace("label",At).getRegex(),reflink:N(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",At).getRegex()},nn={...mn,emStrongRDelimAst:vi,emStrongLDelim:yi,url:N(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\.|[^\\])*?(?:\\.|[^\s~\\]))\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},Ri={...nn,br:N(Ts).replace("{2,}","*").getRegex(),text:N(nn.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},xt={normal:fn,gfm:ci,pedantic:ui},Ke={normal:mn,gfm:nn,breaks:Ri,pedantic:Ei},Li={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},$n=n=>Li[n];function ye(n,e){if(e){if(ne.escapeTest.test(n))return n.replace(ne.escapeReplace,$n)}else if(ne.escapeTestNoEncode.test(n))return n.replace(ne.escapeReplaceNoEncode,$n);return n}function Zn(n){try{n=encodeURI(n).replace(ne.percentDecode,"%")}catch{return null}return n}function Xn(n,e){var i;const t=n.replace(ne.findPipe,(l,o,d)=>{let r=!1,c=o;for(;--c>=0&&d[c]==="\\";)r=!r;return r?"|":" |"}),a=t.split(ne.splitPipe);let s=0;if(a[0].trim()||a.shift(),a.length>0&&!((i=a.at(-1))!=null&&i.trim())&&a.pop(),e)if(a.length>e)a.splice(e);else for(;a.length<e;)a.push("");for(;s<a.length;s++)a[s]=a[s].trim().replace(ne.slashPipe,"|");return a}function Qe(n,e,t){const a=n.length;if(a===0)return"";let s=0;for(;s<a&&n.charAt(a-s-1)===e;)s++;return n.slice(0,a-s)}function Pi(n,e){if(n.indexOf(e[1])===-1)return-1;let t=0;for(let a=0;a<n.length;a++)if(n[a]==="\\")a++;else if(n[a]===e[0])t++;else if(n[a]===e[1]&&(t--,t<0))return a;return t>0?-2:-1}function Kn(n,e,t,a,s){const i=e.href,l=e.title||null,o=n[1].replace(s.other.outputLinkReplace,"$1");a.state.inLink=!0;const d={type:n[0].charAt(0)==="!"?"image":"link",raw:t,href:i,title:l,text:o,tokens:a.inlineTokens(o)};return a.state.inLink=!1,d}function Mi(n,e,t){const a=n.match(t.other.indentCodeCompensation);if(a===null)return e;const s=a[1];return e.split(`
`).map(i=>{const l=i.match(t.other.beginningSpace);if(l===null)return i;const[o]=l;return o.length>=s.length?i.slice(s.length):i}).join(`
`)}class Ct{constructor(e){z(this,"options");z(this,"rules");z(this,"lexer");this.options=e||Ve}space(e){const t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){const t=this.rules.block.code.exec(e);if(t){const a=t[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?a:Qe(a,`
`)}}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const a=t[0],s=Mi(a,t[3]||"",this.rules);return{type:"code",raw:a,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:s}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let a=t[2].trim();if(this.rules.other.endingHash.test(a)){const s=Qe(a,"#");(this.options.pedantic||!s||this.rules.other.endingSpaceChar.test(s))&&(a=s.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:a,tokens:this.lexer.inline(a)}}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:Qe(t[0],`
`)}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){let a=Qe(t[0],`
`).split(`
`),s="",i="";const l=[];for(;a.length>0;){let o=!1;const d=[];let r;for(r=0;r<a.length;r++)if(this.rules.other.blockquoteStart.test(a[r]))d.push(a[r]),o=!0;else if(!o)d.push(a[r]);else break;a=a.slice(r);const c=d.join(`
`),g=c.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");s=s?`${s}
${c}`:c,i=i?`${i}
${g}`:g;const k=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(g,l,!0),this.lexer.state.top=k,a.length===0)break;const p=l.at(-1);if((p==null?void 0:p.type)==="code")break;if((p==null?void 0:p.type)==="blockquote"){const b=p,y=b.raw+`
`+a.join(`
`),M=this.blockquote(y);l[l.length-1]=M,s=s.substring(0,s.length-b.raw.length)+M.raw,i=i.substring(0,i.length-b.text.length)+M.text;break}else if((p==null?void 0:p.type)==="list"){const b=p,y=b.raw+`
`+a.join(`
`),M=this.list(y);l[l.length-1]=M,s=s.substring(0,s.length-p.raw.length)+M.raw,i=i.substring(0,i.length-b.raw.length)+M.raw,a=y.substring(l.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:s,tokens:l,text:i}}}list(e){let t=this.rules.block.list.exec(e);if(t){let a=t[1].trim();const s=a.length>1,i={type:"list",raw:"",ordered:s,start:s?+a.slice(0,-1):"",loose:!1,items:[]};a=s?`\\d{1,9}\\${a.slice(-1)}`:`\\${a}`,this.options.pedantic&&(a=s?a:"[*+-]");const l=this.rules.other.listItemRegex(a);let o=!1;for(;e;){let r=!1,c="",g="";if(!(t=l.exec(e))||this.rules.block.hr.test(e))break;c=t[0],e=e.substring(c.length);let k=t[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,D=>" ".repeat(3*D.length)),p=e.split(`
`,1)[0],b=!k.trim(),y=0;if(this.options.pedantic?(y=2,g=k.trimStart()):b?y=t[1].length+1:(y=t[2].search(this.rules.other.nonSpaceChar),y=y>4?1:y,g=k.slice(y),y+=t[1].length),b&&this.rules.other.blankLine.test(p)&&(c+=p+`
`,e=e.substring(p.length+1),r=!0),!r){const D=this.rules.other.nextBulletRegex(y),H=this.rules.other.hrRegex(y),O=this.rules.other.fencesBeginRegex(y),j=this.rules.other.headingBeginRegex(y),pe=this.rules.other.htmlBeginRegex(y);for(;e;){const De=e.split(`
`,1)[0];let ge;if(p=De,this.options.pedantic?(p=p.replace(this.rules.other.listReplaceNesting,"  "),ge=p):ge=p.replace(this.rules.other.tabCharGlobal,"    "),O.test(p)||j.test(p)||pe.test(p)||D.test(p)||H.test(p))break;if(ge.search(this.rules.other.nonSpaceChar)>=y||!p.trim())g+=`
`+ge.slice(y);else{if(b||k.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||O.test(k)||j.test(k)||H.test(k))break;g+=`
`+p}!b&&!p.trim()&&(b=!0),c+=De+`
`,e=e.substring(De.length+1),k=ge.slice(y)}}i.loose||(o?i.loose=!0:this.rules.other.doubleBlankLine.test(c)&&(o=!0));let M=null,P;this.options.gfm&&(M=this.rules.other.listIsTask.exec(g),M&&(P=M[0]!=="[ ] ",g=g.replace(this.rules.other.listReplaceTask,""))),i.items.push({type:"list_item",raw:c,task:!!M,checked:P,loose:!1,text:g,tokens:[]}),i.raw+=c}const d=i.items.at(-1);if(d)d.raw=d.raw.trimEnd(),d.text=d.text.trimEnd();else return;i.raw=i.raw.trimEnd();for(let r=0;r<i.items.length;r++)if(this.lexer.state.top=!1,i.items[r].tokens=this.lexer.blockTokens(i.items[r].text,[]),!i.loose){const c=i.items[r].tokens.filter(k=>k.type==="space"),g=c.length>0&&c.some(k=>this.rules.other.anyLine.test(k.raw));i.loose=g}if(i.loose)for(let r=0;r<i.items.length;r++)i.items[r].loose=!0;return i}}html(e){const t=this.rules.block.html.exec(e);if(t)return{type:"html",block:!0,raw:t[0],pre:t[1]==="pre"||t[1]==="script"||t[1]==="style",text:t[0]}}def(e){const t=this.rules.block.def.exec(e);if(t){const a=t[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),s=t[2]?t[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",i=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:a,raw:t[0],href:s,title:i}}}table(e){var o;const t=this.rules.block.table.exec(e);if(!t||!this.rules.other.tableDelimiter.test(t[2]))return;const a=Xn(t[1]),s=t[2].replace(this.rules.other.tableAlignChars,"").split("|"),i=(o=t[3])!=null&&o.trim()?t[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],l={type:"table",raw:t[0],header:[],align:[],rows:[]};if(a.length===s.length){for(const d of s)this.rules.other.tableAlignRight.test(d)?l.align.push("right"):this.rules.other.tableAlignCenter.test(d)?l.align.push("center"):this.rules.other.tableAlignLeft.test(d)?l.align.push("left"):l.align.push(null);for(let d=0;d<a.length;d++)l.header.push({text:a[d],tokens:this.lexer.inline(a[d]),header:!0,align:l.align[d]});for(const d of i)l.rows.push(Xn(d,l.header.length).map((r,c)=>({text:r,tokens:this.lexer.inline(r),header:!1,align:l.align[c]})));return l}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:t[2].charAt(0)==="="?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const a=t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:a,tokens:this.lexer.inline(a)}}}text(e){const t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:t[1]}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&this.rules.other.startATag.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){const t=this.rules.inline.link.exec(e);if(t){const a=t[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(a)){if(!this.rules.other.endAngleBracket.test(a))return;const l=Qe(a.slice(0,-1),"\\");if((a.length-l.length)%2===0)return}else{const l=Pi(t[2],"()");if(l===-2)return;if(l>-1){const d=(t[0].indexOf("!")===0?5:4)+t[1].length+l;t[2]=t[2].substring(0,l),t[0]=t[0].substring(0,d).trim(),t[3]=""}}let s=t[2],i="";if(this.options.pedantic){const l=this.rules.other.pedanticHrefTitle.exec(s);l&&(s=l[1],i=l[3])}else i=t[3]?t[3].slice(1,-1):"";return s=s.trim(),this.rules.other.startAngleBracket.test(s)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(a)?s=s.slice(1):s=s.slice(1,-1)),Kn(t,{href:s&&s.replace(this.rules.inline.anyPunctuation,"$1"),title:i&&i.replace(this.rules.inline.anyPunctuation,"$1")},t[0],this.lexer,this.rules)}}reflink(e,t){let a;if((a=this.rules.inline.reflink.exec(e))||(a=this.rules.inline.nolink.exec(e))){const s=(a[2]||a[1]).replace(this.rules.other.multipleSpaceGlobal," "),i=t[s.toLowerCase()];if(!i){const l=a[0].charAt(0);return{type:"text",raw:l,text:l}}return Kn(a,i,a[0],this.lexer,this.rules)}}emStrong(e,t,a=""){let s=this.rules.inline.emStrongLDelim.exec(e);if(!s||s[3]&&a.match(this.rules.other.unicodeAlphaNumeric))return;if(!(s[1]||s[2]||"")||!a||this.rules.inline.punctuation.exec(a)){const l=[...s[0]].length-1;let o,d,r=l,c=0;const g=s[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(g.lastIndex=0,t=t.slice(-1*e.length+l);(s=g.exec(t))!=null;){if(o=s[1]||s[2]||s[3]||s[4]||s[5]||s[6],!o)continue;if(d=[...o].length,s[3]||s[4]){r+=d;continue}else if((s[5]||s[6])&&l%3&&!((l+d)%3)){c+=d;continue}if(r-=d,r>0)continue;d=Math.min(d,d+r+c);const k=[...s[0]][0].length,p=e.slice(0,l+s.index+k+d);if(Math.min(l,d)%2){const y=p.slice(1,-1);return{type:"em",raw:p,text:y,tokens:this.lexer.inlineTokens(y)}}const b=p.slice(2,-2);return{type:"strong",raw:p,text:b,tokens:this.lexer.inlineTokens(b)}}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let a=t[2].replace(this.rules.other.newLineCharGlobal," ");const s=this.rules.other.nonSpaceChar.test(a),i=this.rules.other.startingSpaceChar.test(a)&&this.rules.other.endingSpaceChar.test(a);return s&&i&&(a=a.substring(1,a.length-1)),{type:"codespan",raw:t[0],text:a}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){const t=this.rules.inline.autolink.exec(e);if(t){let a,s;return t[2]==="@"?(a=t[1],s="mailto:"+a):(a=t[1],s=a),{type:"link",raw:t[0],text:a,href:s,tokens:[{type:"text",raw:a,text:a}]}}}url(e){var a;let t;if(t=this.rules.inline.url.exec(e)){let s,i;if(t[2]==="@")s=t[0],i="mailto:"+s;else{let l;do l=t[0],t[0]=((a=this.rules.inline._backpedal.exec(t[0]))==null?void 0:a[0])??"";while(l!==t[0]);s=t[0],t[1]==="www."?i="http://"+t[0]:i=t[0]}return{type:"link",raw:t[0],text:s,href:i,tokens:[{type:"text",raw:s,text:s}]}}}inlineText(e){const t=this.rules.inline.text.exec(e);if(t){const a=this.lexer.state.inRawBlock;return{type:"text",raw:t[0],text:t[0],escaped:a}}}}class de{constructor(e){z(this,"tokens");z(this,"options");z(this,"state");z(this,"tokenizer");z(this,"inlineQueue");this.tokens=[],this.tokens.links=Object.create(null),this.options=e||Ve,this.options.tokenizer=this.options.tokenizer||new Ct,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const t={other:ne,block:xt.normal,inline:Ke.normal};this.options.pedantic?(t.block=xt.pedantic,t.inline=Ke.pedantic):this.options.gfm&&(t.block=xt.gfm,this.options.breaks?t.inline=Ke.breaks:t.inline=Ke.gfm),this.tokenizer.rules=t}static get rules(){return{block:xt,inline:Ke}}static lex(e,t){return new de(t).lex(e)}static lexInline(e,t){return new de(t).inlineTokens(e)}lex(e){e=e.replace(ne.carriageReturn,`
`),this.blockTokens(e,this.tokens);for(let t=0;t<this.inlineQueue.length;t++){const a=this.inlineQueue[t];this.inlineTokens(a.src,a.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,t=[],a=!1){var s,i,l;for(this.options.pedantic&&(e=e.replace(ne.tabCharGlobal,"    ").replace(ne.spaceLine,""));e;){let o;if((i=(s=this.options.extensions)==null?void 0:s.block)!=null&&i.some(r=>(o=r.call({lexer:this},e,t))?(e=e.substring(o.raw.length),t.push(o),!0):!1))continue;if(o=this.tokenizer.space(e)){e=e.substring(o.raw.length);const r=t.at(-1);o.raw.length===1&&r!==void 0?r.raw+=`
`:t.push(o);continue}if(o=this.tokenizer.code(e)){e=e.substring(o.raw.length);const r=t.at(-1);(r==null?void 0:r.type)==="paragraph"||(r==null?void 0:r.type)==="text"?(r.raw+=`
`+o.raw,r.text+=`
`+o.text,this.inlineQueue.at(-1).src=r.text):t.push(o);continue}if(o=this.tokenizer.fences(e)){e=e.substring(o.raw.length),t.push(o);continue}if(o=this.tokenizer.heading(e)){e=e.substring(o.raw.length),t.push(o);continue}if(o=this.tokenizer.hr(e)){e=e.substring(o.raw.length),t.push(o);continue}if(o=this.tokenizer.blockquote(e)){e=e.substring(o.raw.length),t.push(o);continue}if(o=this.tokenizer.list(e)){e=e.substring(o.raw.length),t.push(o);continue}if(o=this.tokenizer.html(e)){e=e.substring(o.raw.length),t.push(o);continue}if(o=this.tokenizer.def(e)){e=e.substring(o.raw.length);const r=t.at(-1);(r==null?void 0:r.type)==="paragraph"||(r==null?void 0:r.type)==="text"?(r.raw+=`
`+o.raw,r.text+=`
`+o.raw,this.inlineQueue.at(-1).src=r.text):this.tokens.links[o.tag]||(this.tokens.links[o.tag]={href:o.href,title:o.title});continue}if(o=this.tokenizer.table(e)){e=e.substring(o.raw.length),t.push(o);continue}if(o=this.tokenizer.lheading(e)){e=e.substring(o.raw.length),t.push(o);continue}let d=e;if((l=this.options.extensions)!=null&&l.startBlock){let r=1/0;const c=e.slice(1);let g;this.options.extensions.startBlock.forEach(k=>{g=k.call({lexer:this},c),typeof g=="number"&&g>=0&&(r=Math.min(r,g))}),r<1/0&&r>=0&&(d=e.substring(0,r+1))}if(this.state.top&&(o=this.tokenizer.paragraph(d))){const r=t.at(-1);a&&(r==null?void 0:r.type)==="paragraph"?(r.raw+=`
`+o.raw,r.text+=`
`+o.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=r.text):t.push(o),a=d.length!==e.length,e=e.substring(o.raw.length);continue}if(o=this.tokenizer.text(e)){e=e.substring(o.raw.length);const r=t.at(-1);(r==null?void 0:r.type)==="text"?(r.raw+=`
`+o.raw,r.text+=`
`+o.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=r.text):t.push(o);continue}if(e){const r="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(r);break}else throw new Error(r)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){var o,d,r;let a=e,s=null;if(this.tokens.links){const c=Object.keys(this.tokens.links);if(c.length>0)for(;(s=this.tokenizer.rules.inline.reflinkSearch.exec(a))!=null;)c.includes(s[0].slice(s[0].lastIndexOf("[")+1,-1))&&(a=a.slice(0,s.index)+"["+"a".repeat(s[0].length-2)+"]"+a.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(s=this.tokenizer.rules.inline.anyPunctuation.exec(a))!=null;)a=a.slice(0,s.index)+"++"+a.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;(s=this.tokenizer.rules.inline.blockSkip.exec(a))!=null;)a=a.slice(0,s.index)+"["+"a".repeat(s[0].length-2)+"]"+a.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);let i=!1,l="";for(;e;){i||(l=""),i=!1;let c;if((d=(o=this.options.extensions)==null?void 0:o.inline)!=null&&d.some(k=>(c=k.call({lexer:this},e,t))?(e=e.substring(c.raw.length),t.push(c),!0):!1))continue;if(c=this.tokenizer.escape(e)){e=e.substring(c.raw.length),t.push(c);continue}if(c=this.tokenizer.tag(e)){e=e.substring(c.raw.length),t.push(c);continue}if(c=this.tokenizer.link(e)){e=e.substring(c.raw.length),t.push(c);continue}if(c=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(c.raw.length);const k=t.at(-1);c.type==="text"&&(k==null?void 0:k.type)==="text"?(k.raw+=c.raw,k.text+=c.text):t.push(c);continue}if(c=this.tokenizer.emStrong(e,a,l)){e=e.substring(c.raw.length),t.push(c);continue}if(c=this.tokenizer.codespan(e)){e=e.substring(c.raw.length),t.push(c);continue}if(c=this.tokenizer.br(e)){e=e.substring(c.raw.length),t.push(c);continue}if(c=this.tokenizer.del(e)){e=e.substring(c.raw.length),t.push(c);continue}if(c=this.tokenizer.autolink(e)){e=e.substring(c.raw.length),t.push(c);continue}if(!this.state.inLink&&(c=this.tokenizer.url(e))){e=e.substring(c.raw.length),t.push(c);continue}let g=e;if((r=this.options.extensions)!=null&&r.startInline){let k=1/0;const p=e.slice(1);let b;this.options.extensions.startInline.forEach(y=>{b=y.call({lexer:this},p),typeof b=="number"&&b>=0&&(k=Math.min(k,b))}),k<1/0&&k>=0&&(g=e.substring(0,k+1))}if(c=this.tokenizer.inlineText(g)){e=e.substring(c.raw.length),c.raw.slice(-1)!=="_"&&(l=c.raw.slice(-1)),i=!0;const k=t.at(-1);(k==null?void 0:k.type)==="text"?(k.raw+=c.raw,k.text+=c.text):t.push(c);continue}if(e){const k="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(k);break}else throw new Error(k)}}return t}}class Et{constructor(e){z(this,"options");z(this,"parser");this.options=e||Ve}space(e){return""}code({text:e,lang:t,escaped:a}){var l;const s=(l=(t||"").match(ne.notSpaceStart))==null?void 0:l[0],i=e.replace(ne.endingNewline,"")+`
`;return s?'<pre><code class="language-'+ye(s)+'">'+(a?i:ye(i,!0))+`</code></pre>
`:"<pre><code>"+(a?i:ye(i,!0))+`</code></pre>
`}blockquote({tokens:e}){return`<blockquote>
${this.parser.parse(e)}</blockquote>
`}html({text:e}){return e}heading({tokens:e,depth:t}){return`<h${t}>${this.parser.parseInline(e)}</h${t}>
`}hr(e){return`<hr>
`}list(e){const t=e.ordered,a=e.start;let s="";for(let o=0;o<e.items.length;o++){const d=e.items[o];s+=this.listitem(d)}const i=t?"ol":"ul",l=t&&a!==1?' start="'+a+'"':"";return"<"+i+l+`>
`+s+"</"+i+`>
`}listitem(e){var a;let t="";if(e.task){const s=this.checkbox({checked:!!e.checked});e.loose?((a=e.tokens[0])==null?void 0:a.type)==="paragraph"?(e.tokens[0].text=s+" "+e.tokens[0].text,e.tokens[0].tokens&&e.tokens[0].tokens.length>0&&e.tokens[0].tokens[0].type==="text"&&(e.tokens[0].tokens[0].text=s+" "+ye(e.tokens[0].tokens[0].text),e.tokens[0].tokens[0].escaped=!0)):e.tokens.unshift({type:"text",raw:s+" ",text:s+" ",escaped:!0}):t+=s+" "}return t+=this.parser.parse(e.tokens,!!e.loose),`<li>${t}</li>
`}checkbox({checked:e}){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:e}){return`<p>${this.parser.parseInline(e)}</p>
`}table(e){let t="",a="";for(let i=0;i<e.header.length;i++)a+=this.tablecell(e.header[i]);t+=this.tablerow({text:a});let s="";for(let i=0;i<e.rows.length;i++){const l=e.rows[i];a="";for(let o=0;o<l.length;o++)a+=this.tablecell(l[o]);s+=this.tablerow({text:a})}return s&&(s=`<tbody>${s}</tbody>`),`<table>
<thead>
`+t+`</thead>
`+s+`</table>
`}tablerow({text:e}){return`<tr>
${e}</tr>
`}tablecell(e){const t=this.parser.parseInline(e.tokens),a=e.header?"th":"td";return(e.align?`<${a} align="${e.align}">`:`<${a}>`)+t+`</${a}>
`}strong({tokens:e}){return`<strong>${this.parser.parseInline(e)}</strong>`}em({tokens:e}){return`<em>${this.parser.parseInline(e)}</em>`}codespan({text:e}){return`<code>${ye(e,!0)}</code>`}br(e){return"<br>"}del({tokens:e}){return`<del>${this.parser.parseInline(e)}</del>`}link({href:e,title:t,tokens:a}){const s=this.parser.parseInline(a),i=Zn(e);if(i===null)return s;e=i;let l='<a href="'+e+'"';return t&&(l+=' title="'+ye(t)+'"'),l+=">"+s+"</a>",l}image({href:e,title:t,text:a,tokens:s}){s&&(a=this.parser.parseInline(s,this.parser.textRenderer));const i=Zn(e);if(i===null)return ye(a);e=i;let l=`<img src="${e}" alt="${a}"`;return t&&(l+=` title="${ye(t)}"`),l+=">",l}text(e){return"tokens"in e&&e.tokens?this.parser.parseInline(e.tokens):"escaped"in e&&e.escaped?e.text:ye(e.text)}}class gn{strong({text:e}){return e}em({text:e}){return e}codespan({text:e}){return e}del({text:e}){return e}html({text:e}){return e}text({text:e}){return e}link({text:e}){return""+e}image({text:e}){return""+e}br(){return""}}class he{constructor(e){z(this,"options");z(this,"renderer");z(this,"textRenderer");this.options=e||Ve,this.options.renderer=this.options.renderer||new Et,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new gn}static parse(e,t){return new he(t).parse(e)}static parseInline(e,t){return new he(t).parseInline(e)}parse(e,t=!0){var s,i;let a="";for(let l=0;l<e.length;l++){const o=e[l];if((i=(s=this.options.extensions)==null?void 0:s.renderers)!=null&&i[o.type]){const r=o,c=this.options.extensions.renderers[r.type].call({parser:this},r);if(c!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(r.type)){a+=c||"";continue}}const d=o;switch(d.type){case"space":{a+=this.renderer.space(d);continue}case"hr":{a+=this.renderer.hr(d);continue}case"heading":{a+=this.renderer.heading(d);continue}case"code":{a+=this.renderer.code(d);continue}case"table":{a+=this.renderer.table(d);continue}case"blockquote":{a+=this.renderer.blockquote(d);continue}case"list":{a+=this.renderer.list(d);continue}case"html":{a+=this.renderer.html(d);continue}case"paragraph":{a+=this.renderer.paragraph(d);continue}case"text":{let r=d,c=this.renderer.text(r);for(;l+1<e.length&&e[l+1].type==="text";)r=e[++l],c+=`
`+this.renderer.text(r);t?a+=this.renderer.paragraph({type:"paragraph",raw:c,text:c,tokens:[{type:"text",raw:c,text:c,escaped:!0}]}):a+=c;continue}default:{const r='Token with "'+d.type+'" type was not found.';if(this.options.silent)return console.error(r),"";throw new Error(r)}}}return a}parseInline(e,t=this.renderer){var s,i;let a="";for(let l=0;l<e.length;l++){const o=e[l];if((i=(s=this.options.extensions)==null?void 0:s.renderers)!=null&&i[o.type]){const r=this.options.extensions.renderers[o.type].call({parser:this},o);if(r!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(o.type)){a+=r||"";continue}}const d=o;switch(d.type){case"escape":{a+=t.text(d);break}case"html":{a+=t.html(d);break}case"link":{a+=t.link(d);break}case"image":{a+=t.image(d);break}case"strong":{a+=t.strong(d);break}case"em":{a+=t.em(d);break}case"codespan":{a+=t.codespan(d);break}case"br":{a+=t.br(d);break}case"del":{a+=t.del(d);break}case"text":{a+=t.text(d);break}default:{const r='Token with "'+d.type+'" type was not found.';if(this.options.silent)return console.error(r),"";throw new Error(r)}}}return a}}class rt{constructor(e){z(this,"options");z(this,"block");this.options=e||Ve}preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}provideLexer(){return this.block?de.lex:de.lexInline}provideParser(){return this.block?he.parse:he.parseInline}}z(rt,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens"]));class Ni{constructor(...e){z(this,"defaults",on());z(this,"options",this.setOptions);z(this,"parse",this.parseMarkdown(!0));z(this,"parseInline",this.parseMarkdown(!1));z(this,"Parser",he);z(this,"Renderer",Et);z(this,"TextRenderer",gn);z(this,"Lexer",de);z(this,"Tokenizer",Ct);z(this,"Hooks",rt);this.use(...e)}walkTokens(e,t){var s,i;let a=[];for(const l of e)switch(a=a.concat(t.call(this,l)),l.type){case"table":{const o=l;for(const d of o.header)a=a.concat(this.walkTokens(d.tokens,t));for(const d of o.rows)for(const r of d)a=a.concat(this.walkTokens(r.tokens,t));break}case"list":{const o=l;a=a.concat(this.walkTokens(o.items,t));break}default:{const o=l;(i=(s=this.defaults.extensions)==null?void 0:s.childTokens)!=null&&i[o.type]?this.defaults.extensions.childTokens[o.type].forEach(d=>{const r=o[d].flat(1/0);a=a.concat(this.walkTokens(r,t))}):o.tokens&&(a=a.concat(this.walkTokens(o.tokens,t)))}}return a}use(...e){const t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(a=>{const s={...a};if(s.async=this.defaults.async||s.async||!1,a.extensions&&(a.extensions.forEach(i=>{if(!i.name)throw new Error("extension name required");if("renderer"in i){const l=t.renderers[i.name];l?t.renderers[i.name]=function(...o){let d=i.renderer.apply(this,o);return d===!1&&(d=l.apply(this,o)),d}:t.renderers[i.name]=i.renderer}if("tokenizer"in i){if(!i.level||i.level!=="block"&&i.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const l=t[i.level];l?l.unshift(i.tokenizer):t[i.level]=[i.tokenizer],i.start&&(i.level==="block"?t.startBlock?t.startBlock.push(i.start):t.startBlock=[i.start]:i.level==="inline"&&(t.startInline?t.startInline.push(i.start):t.startInline=[i.start]))}"childTokens"in i&&i.childTokens&&(t.childTokens[i.name]=i.childTokens)}),s.extensions=t),a.renderer){const i=this.defaults.renderer||new Et(this.defaults);for(const l in a.renderer){if(!(l in i))throw new Error(`renderer '${l}' does not exist`);if(["options","parser"].includes(l))continue;const o=l,d=a.renderer[o],r=i[o];i[o]=(...c)=>{let g=d.apply(i,c);return g===!1&&(g=r.apply(i,c)),g||""}}s.renderer=i}if(a.tokenizer){const i=this.defaults.tokenizer||new Ct(this.defaults);for(const l in a.tokenizer){if(!(l in i))throw new Error(`tokenizer '${l}' does not exist`);if(["options","rules","lexer"].includes(l))continue;const o=l,d=a.tokenizer[o],r=i[o];i[o]=(...c)=>{let g=d.apply(i,c);return g===!1&&(g=r.apply(i,c)),g}}s.tokenizer=i}if(a.hooks){const i=this.defaults.hooks||new rt;for(const l in a.hooks){if(!(l in i))throw new Error(`hook '${l}' does not exist`);if(["options","block"].includes(l))continue;const o=l,d=a.hooks[o],r=i[o];rt.passThroughHooks.has(l)?i[o]=c=>{if(this.defaults.async)return Promise.resolve(d.call(i,c)).then(k=>r.call(i,k));const g=d.call(i,c);return r.call(i,g)}:i[o]=(...c)=>{let g=d.apply(i,c);return g===!1&&(g=r.apply(i,c)),g}}s.hooks=i}if(a.walkTokens){const i=this.defaults.walkTokens,l=a.walkTokens;s.walkTokens=function(o){let d=[];return d.push(l.call(this,o)),i&&(d=d.concat(i.call(this,o))),d}}this.defaults={...this.defaults,...s}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,t){return de.lex(e,t??this.defaults)}parser(e,t){return he.parse(e,t??this.defaults)}parseMarkdown(e){return(a,s)=>{const i={...s},l={...this.defaults,...i},o=this.onError(!!l.silent,!!l.async);if(this.defaults.async===!0&&i.async===!1)return o(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof a>"u"||a===null)return o(new Error("marked(): input parameter is undefined or null"));if(typeof a!="string")return o(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(a)+", string expected"));l.hooks&&(l.hooks.options=l,l.hooks.block=e);const d=l.hooks?l.hooks.provideLexer():e?de.lex:de.lexInline,r=l.hooks?l.hooks.provideParser():e?he.parse:he.parseInline;if(l.async)return Promise.resolve(l.hooks?l.hooks.preprocess(a):a).then(c=>d(c,l)).then(c=>l.hooks?l.hooks.processAllTokens(c):c).then(c=>l.walkTokens?Promise.all(this.walkTokens(c,l.walkTokens)).then(()=>c):c).then(c=>r(c,l)).then(c=>l.hooks?l.hooks.postprocess(c):c).catch(o);try{l.hooks&&(a=l.hooks.preprocess(a));let c=d(a,l);l.hooks&&(c=l.hooks.processAllTokens(c)),l.walkTokens&&this.walkTokens(c,l.walkTokens);let g=r(c,l);return l.hooks&&(g=l.hooks.postprocess(g)),g}catch(c){return o(c)}}}onError(e,t){return a=>{if(a.message+=`
Please report this to https://github.com/markedjs/marked.`,e){const s="<p>An error occurred:</p><pre>"+ye(a.message+"",!0)+"</pre>";return t?Promise.resolve(s):s}if(t)return Promise.reject(a);throw a}}}const Fe=new Ni;function I(n,e){return Fe.parse(n,e)}I.options=I.setOptions=function(n){return Fe.setOptions(n),I.defaults=Fe.defaults,xs(I.defaults),I};I.getDefaults=on;I.defaults=Ve;I.use=function(...n){return Fe.use(...n),I.defaults=Fe.defaults,xs(I.defaults),I};I.walkTokens=function(n,e){return Fe.walkTokens(n,e)};I.parseInline=Fe.parseInline;I.Parser=he;I.parser=he.parse;I.Renderer=Et;I.TextRenderer=gn;I.Lexer=de;I.lexer=de.lex;I.Tokenizer=Ct;I.Hooks=rt;I.parse=I;I.options;I.setOptions;I.use;I.walkTokens;I.parseInline;he.parse;de.lex;/*! @license DOMPurify 3.2.5 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.5/LICENSE */const{entries:Ls,setPrototypeOf:Qn,isFrozen:Oi,getPrototypeOf:Ii,getOwnPropertyDescriptor:zi}=Object;let{freeze:se,seal:fe,create:Ps}=Object,{apply:sn,construct:an}=typeof Reflect<"u"&&Reflect;se||(se=function(e){return e});fe||(fe=function(e){return e});sn||(sn=function(e,t,a){return e.apply(t,a)});an||(an=function(e,t){return new e(...t)});const vt=ae(Array.prototype.forEach),Fi=ae(Array.prototype.lastIndexOf),Jn=ae(Array.prototype.pop),Je=ae(Array.prototype.push),Vi=ae(Array.prototype.splice),Dt=ae(String.prototype.toLowerCase),qt=ae(String.prototype.toString),es=ae(String.prototype.match),et=ae(String.prototype.replace),Bi=ae(String.prototype.indexOf),Ui=ae(String.prototype.trim),me=ae(Object.prototype.hasOwnProperty),ee=ae(RegExp.prototype.test),tt=Hi(TypeError);function ae(n){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var t=arguments.length,a=new Array(t>1?t-1:0),s=1;s<t;s++)a[s-1]=arguments[s];return sn(n,e,a)}}function Hi(n){return function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return an(n,t)}}function R(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Dt;Qn&&Qn(n,null);let a=e.length;for(;a--;){let s=e[a];if(typeof s=="string"){const i=t(s);i!==s&&(Oi(e)||(e[a]=i),s=i)}n[s]=!0}return n}function ji(n){for(let e=0;e<n.length;e++)me(n,e)||(n[e]=null);return n}function Oe(n){const e=Ps(null);for(const[t,a]of Ls(n))me(n,t)&&(Array.isArray(a)?e[t]=ji(a):a&&typeof a=="object"&&a.constructor===Object?e[t]=Oe(a):e[t]=a);return e}function nt(n,e){for(;n!==null;){const a=zi(n,e);if(a){if(a.get)return ae(a.get);if(typeof a.value=="function")return ae(a.value)}n=Ii(n)}function t(){return null}return t}const ts=se(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),$t=se(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Zt=se(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Gi=se(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Xt=se(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),Wi=se(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),ns=se(["#text"]),ss=se(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),Kt=se(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),as=se(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),wt=se(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Yi=fe(/\{\{[\w\W]*|[\w\W]*\}\}/gm),qi=fe(/<%[\w\W]*|[\w\W]*%>/gm),$i=fe(/\$\{[\w\W]*/gm),Zi=fe(/^data-[\-\w.\u00B7-\uFFFF]+$/),Xi=fe(/^aria-[\-\w]+$/),Ms=fe(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Ki=fe(/^(?:\w+script|data):/i),Qi=fe(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Ns=fe(/^html$/i),Ji=fe(/^[a-z][.\w]*(-[.\w]+)+$/i);var is=Object.freeze({__proto__:null,ARIA_ATTR:Xi,ATTR_WHITESPACE:Qi,CUSTOM_ELEMENT:Ji,DATA_ATTR:Zi,DOCTYPE_NAME:Ns,ERB_EXPR:qi,IS_ALLOWED_URI:Ms,IS_SCRIPT_OR_DATA:Ki,MUSTACHE_EXPR:Yi,TMPLIT_EXPR:$i});const st={element:1,text:3,progressingInstruction:7,comment:8,document:9},er=function(){return typeof window>"u"?null:window},tr=function(e,t){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let a=null;const s="data-tt-policy-suffix";t&&t.hasAttribute(s)&&(a=t.getAttribute(s));const i="dompurify"+(a?"#"+a:"");try{return e.createPolicy(i,{createHTML(l){return l},createScriptURL(l){return l}})}catch{return console.warn("TrustedTypes policy "+i+" could not be created."),null}},rs=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function Os(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:er();const e=S=>Os(S);if(e.version="3.2.5",e.removed=[],!n||!n.document||n.document.nodeType!==st.document||!n.Element)return e.isSupported=!1,e;let{document:t}=n;const a=t,s=a.currentScript,{DocumentFragment:i,HTMLTemplateElement:l,Node:o,Element:d,NodeFilter:r,NamedNodeMap:c=n.NamedNodeMap||n.MozNamedAttrMap,HTMLFormElement:g,DOMParser:k,trustedTypes:p}=n,b=d.prototype,y=nt(b,"cloneNode"),M=nt(b,"remove"),P=nt(b,"nextSibling"),D=nt(b,"childNodes"),H=nt(b,"parentNode");if(typeof l=="function"){const S=t.createElement("template");S.content&&S.content.ownerDocument&&(t=S.content.ownerDocument)}let O,j="";const{implementation:pe,createNodeIterator:De,createDocumentFragment:ge,getElementsByTagName:Le}=t,{importNode:Pe}=a;let _=rs();e.isSupported=typeof Ls=="function"&&typeof H=="function"&&pe&&pe.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:F,ERB_EXPR:Q,TMPLIT_EXPR:xe,DATA_ATTR:Ye,ARIA_ATTR:Me,IS_SCRIPT_OR_DATA:Ae,ATTR_WHITESPACE:B,CUSTOM_ELEMENT:Us}=is;let{IS_ALLOWED_URI:kn}=is,Y=null;const bn=R({},[...ts,...$t,...Zt,...Xt,...ns]);let $=null;const yn=R({},[...ss,...Kt,...as,...wt]);let U=Object.seal(Ps(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),qe=null,Pt=null,xn=!0,Mt=!0,vn=!1,wn=!0,Be=!1,Nt=!0,Ne=!1,Ot=!1,It=!1,Ue=!1,ut=!1,dt=!1,Sn=!0,Tn=!1;const Hs="user-content-";let zt=!0,$e=!1,He={},je=null;const _n=R({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Dn=null;const An=R({},["audio","video","img","source","image","track"]);let Ft=null;const Cn=R({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),ht="http://www.w3.org/1998/Math/MathML",ft="http://www.w3.org/2000/svg",ve="http://www.w3.org/1999/xhtml";let Ge=ve,Vt=!1,Bt=null;const js=R({},[ht,ft,ve],qt);let pt=R({},["mi","mo","mn","ms","mtext"]),mt=R({},["annotation-xml"]);const Gs=R({},["title","style","font","a","script"]);let Ze=null;const Ws=["application/xhtml+xml","text/html"],Ys="text/html";let q=null,We=null;const qs=t.createElement("form"),En=function(u){return u instanceof RegExp||u instanceof Function},Ut=function(){let u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(We&&We===u)){if((!u||typeof u!="object")&&(u={}),u=Oe(u),Ze=Ws.indexOf(u.PARSER_MEDIA_TYPE)===-1?Ys:u.PARSER_MEDIA_TYPE,q=Ze==="application/xhtml+xml"?qt:Dt,Y=me(u,"ALLOWED_TAGS")?R({},u.ALLOWED_TAGS,q):bn,$=me(u,"ALLOWED_ATTR")?R({},u.ALLOWED_ATTR,q):yn,Bt=me(u,"ALLOWED_NAMESPACES")?R({},u.ALLOWED_NAMESPACES,qt):js,Ft=me(u,"ADD_URI_SAFE_ATTR")?R(Oe(Cn),u.ADD_URI_SAFE_ATTR,q):Cn,Dn=me(u,"ADD_DATA_URI_TAGS")?R(Oe(An),u.ADD_DATA_URI_TAGS,q):An,je=me(u,"FORBID_CONTENTS")?R({},u.FORBID_CONTENTS,q):_n,qe=me(u,"FORBID_TAGS")?R({},u.FORBID_TAGS,q):{},Pt=me(u,"FORBID_ATTR")?R({},u.FORBID_ATTR,q):{},He=me(u,"USE_PROFILES")?u.USE_PROFILES:!1,xn=u.ALLOW_ARIA_ATTR!==!1,Mt=u.ALLOW_DATA_ATTR!==!1,vn=u.ALLOW_UNKNOWN_PROTOCOLS||!1,wn=u.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Be=u.SAFE_FOR_TEMPLATES||!1,Nt=u.SAFE_FOR_XML!==!1,Ne=u.WHOLE_DOCUMENT||!1,Ue=u.RETURN_DOM||!1,ut=u.RETURN_DOM_FRAGMENT||!1,dt=u.RETURN_TRUSTED_TYPE||!1,It=u.FORCE_BODY||!1,Sn=u.SANITIZE_DOM!==!1,Tn=u.SANITIZE_NAMED_PROPS||!1,zt=u.KEEP_CONTENT!==!1,$e=u.IN_PLACE||!1,kn=u.ALLOWED_URI_REGEXP||Ms,Ge=u.NAMESPACE||ve,pt=u.MATHML_TEXT_INTEGRATION_POINTS||pt,mt=u.HTML_INTEGRATION_POINTS||mt,U=u.CUSTOM_ELEMENT_HANDLING||{},u.CUSTOM_ELEMENT_HANDLING&&En(u.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(U.tagNameCheck=u.CUSTOM_ELEMENT_HANDLING.tagNameCheck),u.CUSTOM_ELEMENT_HANDLING&&En(u.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(U.attributeNameCheck=u.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),u.CUSTOM_ELEMENT_HANDLING&&typeof u.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(U.allowCustomizedBuiltInElements=u.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Be&&(Mt=!1),ut&&(Ue=!0),He&&(Y=R({},ns),$=[],He.html===!0&&(R(Y,ts),R($,ss)),He.svg===!0&&(R(Y,$t),R($,Kt),R($,wt)),He.svgFilters===!0&&(R(Y,Zt),R($,Kt),R($,wt)),He.mathMl===!0&&(R(Y,Xt),R($,as),R($,wt))),u.ADD_TAGS&&(Y===bn&&(Y=Oe(Y)),R(Y,u.ADD_TAGS,q)),u.ADD_ATTR&&($===yn&&($=Oe($)),R($,u.ADD_ATTR,q)),u.ADD_URI_SAFE_ATTR&&R(Ft,u.ADD_URI_SAFE_ATTR,q),u.FORBID_CONTENTS&&(je===_n&&(je=Oe(je)),R(je,u.FORBID_CONTENTS,q)),zt&&(Y["#text"]=!0),Ne&&R(Y,["html","head","body"]),Y.table&&(R(Y,["tbody"]),delete qe.tbody),u.TRUSTED_TYPES_POLICY){if(typeof u.TRUSTED_TYPES_POLICY.createHTML!="function")throw tt('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof u.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw tt('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');O=u.TRUSTED_TYPES_POLICY,j=O.createHTML("")}else O===void 0&&(O=tr(p,s)),O!==null&&typeof j=="string"&&(j=O.createHTML(""));se&&se(u),We=u}},Rn=R({},[...$t,...Zt,...Gi]),Ln=R({},[...Xt,...Wi]),$s=function(u){let m=H(u);(!m||!m.tagName)&&(m={namespaceURI:Ge,tagName:"template"});const x=Dt(u.tagName),V=Dt(m.tagName);return Bt[u.namespaceURI]?u.namespaceURI===ft?m.namespaceURI===ve?x==="svg":m.namespaceURI===ht?x==="svg"&&(V==="annotation-xml"||pt[V]):!!Rn[x]:u.namespaceURI===ht?m.namespaceURI===ve?x==="math":m.namespaceURI===ft?x==="math"&&mt[V]:!!Ln[x]:u.namespaceURI===ve?m.namespaceURI===ft&&!mt[V]||m.namespaceURI===ht&&!pt[V]?!1:!Ln[x]&&(Gs[x]||!Rn[x]):!!(Ze==="application/xhtml+xml"&&Bt[u.namespaceURI]):!1},ke=function(u){Je(e.removed,{element:u});try{H(u).removeChild(u)}catch{M(u)}},gt=function(u,m){try{Je(e.removed,{attribute:m.getAttributeNode(u),from:m})}catch{Je(e.removed,{attribute:null,from:m})}if(m.removeAttribute(u),u==="is")if(Ue||ut)try{ke(m)}catch{}else try{m.setAttribute(u,"")}catch{}},Pn=function(u){let m=null,x=null;if(It)u="<remove></remove>"+u;else{const Z=es(u,/^[\r\n\t ]+/);x=Z&&Z[0]}Ze==="application/xhtml+xml"&&Ge===ve&&(u='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+u+"</body></html>");const V=O?O.createHTML(u):u;if(Ge===ve)try{m=new k().parseFromString(V,Ze)}catch{}if(!m||!m.documentElement){m=pe.createDocument(Ge,"template",null);try{m.documentElement.innerHTML=Vt?j:V}catch{}}const X=m.body||m.documentElement;return u&&x&&X.insertBefore(t.createTextNode(x),X.childNodes[0]||null),Ge===ve?Le.call(m,Ne?"html":"body")[0]:Ne?m.documentElement:X},Mn=function(u){return De.call(u.ownerDocument||u,u,r.SHOW_ELEMENT|r.SHOW_COMMENT|r.SHOW_TEXT|r.SHOW_PROCESSING_INSTRUCTION|r.SHOW_CDATA_SECTION,null)},Ht=function(u){return u instanceof g&&(typeof u.nodeName!="string"||typeof u.textContent!="string"||typeof u.removeChild!="function"||!(u.attributes instanceof c)||typeof u.removeAttribute!="function"||typeof u.setAttribute!="function"||typeof u.namespaceURI!="string"||typeof u.insertBefore!="function"||typeof u.hasChildNodes!="function")},Nn=function(u){return typeof o=="function"&&u instanceof o};function we(S,u,m){vt(S,x=>{x.call(e,u,m,We)})}const On=function(u){let m=null;if(we(_.beforeSanitizeElements,u,null),Ht(u))return ke(u),!0;const x=q(u.nodeName);if(we(_.uponSanitizeElement,u,{tagName:x,allowedTags:Y}),u.hasChildNodes()&&!Nn(u.firstElementChild)&&ee(/<[/\w!]/g,u.innerHTML)&&ee(/<[/\w!]/g,u.textContent)||u.nodeType===st.progressingInstruction||Nt&&u.nodeType===st.comment&&ee(/<[/\w]/g,u.data))return ke(u),!0;if(!Y[x]||qe[x]){if(!qe[x]&&zn(x)&&(U.tagNameCheck instanceof RegExp&&ee(U.tagNameCheck,x)||U.tagNameCheck instanceof Function&&U.tagNameCheck(x)))return!1;if(zt&&!je[x]){const V=H(u)||u.parentNode,X=D(u)||u.childNodes;if(X&&V){const Z=X.length;for(let ie=Z-1;ie>=0;--ie){const be=y(X[ie],!0);be.__removalCount=(u.__removalCount||0)+1,V.insertBefore(be,P(u))}}}return ke(u),!0}return u instanceof d&&!$s(u)||(x==="noscript"||x==="noembed"||x==="noframes")&&ee(/<\/no(script|embed|frames)/i,u.innerHTML)?(ke(u),!0):(Be&&u.nodeType===st.text&&(m=u.textContent,vt([F,Q,xe],V=>{m=et(m,V," ")}),u.textContent!==m&&(Je(e.removed,{element:u.cloneNode()}),u.textContent=m)),we(_.afterSanitizeElements,u,null),!1)},In=function(u,m,x){if(Sn&&(m==="id"||m==="name")&&(x in t||x in qs))return!1;if(!(Mt&&!Pt[m]&&ee(Ye,m))){if(!(xn&&ee(Me,m))){if(!$[m]||Pt[m]){if(!(zn(u)&&(U.tagNameCheck instanceof RegExp&&ee(U.tagNameCheck,u)||U.tagNameCheck instanceof Function&&U.tagNameCheck(u))&&(U.attributeNameCheck instanceof RegExp&&ee(U.attributeNameCheck,m)||U.attributeNameCheck instanceof Function&&U.attributeNameCheck(m))||m==="is"&&U.allowCustomizedBuiltInElements&&(U.tagNameCheck instanceof RegExp&&ee(U.tagNameCheck,x)||U.tagNameCheck instanceof Function&&U.tagNameCheck(x))))return!1}else if(!Ft[m]){if(!ee(kn,et(x,B,""))){if(!((m==="src"||m==="xlink:href"||m==="href")&&u!=="script"&&Bi(x,"data:")===0&&Dn[u])){if(!(vn&&!ee(Ae,et(x,B,"")))){if(x)return!1}}}}}}return!0},zn=function(u){return u!=="annotation-xml"&&es(u,Us)},Fn=function(u){we(_.beforeSanitizeAttributes,u,null);const{attributes:m}=u;if(!m||Ht(u))return;const x={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:$,forceKeepAttr:void 0};let V=m.length;for(;V--;){const X=m[V],{name:Z,namespaceURI:ie,value:be}=X,Xe=q(Z);let J=Z==="value"?be:Ui(be);if(x.attrName=Xe,x.attrValue=J,x.keepAttr=!0,x.forceKeepAttr=void 0,we(_.uponSanitizeAttribute,u,x),J=x.attrValue,Tn&&(Xe==="id"||Xe==="name")&&(gt(Z,u),J=Hs+J),Nt&&ee(/((--!?|])>)|<\/(style|title)/i,J)){gt(Z,u);continue}if(x.forceKeepAttr||(gt(Z,u),!x.keepAttr))continue;if(!wn&&ee(/\/>/i,J)){gt(Z,u);continue}Be&&vt([F,Q,xe],Bn=>{J=et(J,Bn," ")});const Vn=q(u.nodeName);if(In(Vn,Xe,J)){if(O&&typeof p=="object"&&typeof p.getAttributeType=="function"&&!ie)switch(p.getAttributeType(Vn,Xe)){case"TrustedHTML":{J=O.createHTML(J);break}case"TrustedScriptURL":{J=O.createScriptURL(J);break}}try{ie?u.setAttributeNS(ie,Z,J):u.setAttribute(Z,J),Ht(u)?ke(u):Jn(e.removed)}catch{}}}we(_.afterSanitizeAttributes,u,null)},Zs=function S(u){let m=null;const x=Mn(u);for(we(_.beforeSanitizeShadowDOM,u,null);m=x.nextNode();)we(_.uponSanitizeShadowNode,m,null),On(m),Fn(m),m.content instanceof i&&S(m.content);we(_.afterSanitizeShadowDOM,u,null)};return e.sanitize=function(S){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},m=null,x=null,V=null,X=null;if(Vt=!S,Vt&&(S="<!-->"),typeof S!="string"&&!Nn(S))if(typeof S.toString=="function"){if(S=S.toString(),typeof S!="string")throw tt("dirty is not a string, aborting")}else throw tt("toString is not a function");if(!e.isSupported)return S;if(Ot||Ut(u),e.removed=[],typeof S=="string"&&($e=!1),$e){if(S.nodeName){const be=q(S.nodeName);if(!Y[be]||qe[be])throw tt("root node is forbidden and cannot be sanitized in-place")}}else if(S instanceof o)m=Pn("<!---->"),x=m.ownerDocument.importNode(S,!0),x.nodeType===st.element&&x.nodeName==="BODY"||x.nodeName==="HTML"?m=x:m.appendChild(x);else{if(!Ue&&!Be&&!Ne&&S.indexOf("<")===-1)return O&&dt?O.createHTML(S):S;if(m=Pn(S),!m)return Ue?null:dt?j:""}m&&It&&ke(m.firstChild);const Z=Mn($e?S:m);for(;V=Z.nextNode();)On(V),Fn(V),V.content instanceof i&&Zs(V.content);if($e)return S;if(Ue){if(ut)for(X=ge.call(m.ownerDocument);m.firstChild;)X.appendChild(m.firstChild);else X=m;return($.shadowroot||$.shadowrootmode)&&(X=Pe.call(a,X,!0)),X}let ie=Ne?m.outerHTML:m.innerHTML;return Ne&&Y["!doctype"]&&m.ownerDocument&&m.ownerDocument.doctype&&m.ownerDocument.doctype.name&&ee(Ns,m.ownerDocument.doctype.name)&&(ie="<!DOCTYPE "+m.ownerDocument.doctype.name+`>
`+ie),Be&&vt([F,Q,xe],be=>{ie=et(ie,be," ")}),O&&dt?O.createHTML(ie):ie},e.setConfig=function(){let S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ut(S),Ot=!0},e.clearConfig=function(){We=null,Ot=!1},e.isValidAttribute=function(S,u,m){We||Ut({});const x=q(S),V=q(u);return In(x,V,m)},e.addHook=function(S,u){typeof u=="function"&&Je(_[S],u)},e.removeHook=function(S,u){if(u!==void 0){const m=Fi(_[S],u);return m===-1?void 0:Vi(_[S],m,1)[0]}return Jn(_[S])},e.removeHooks=function(S){_[S]=[]},e.removeAllHooks=function(){_=rs()},e}var nr=Os();const sr=_e({...aa({icon:"$menu",variant:"text"})},"VAppBarNavIcon"),ar=Ee()({name:"VAppBarNavIcon",props:sr(),setup(n,e){let{slots:t}=e;return Re(()=>h(E,ce(n,{class:["v-app-bar-nav-icon"]}),t)),{}}}),Is=_e({active:{type:[String,Array],default:void 0},controlHeight:[Number,String],disabled:{type:[Boolean,String,Array],default:null},nextIcon:{type:St,default:"$next"},prevIcon:{type:St,default:"$prev"},modeIcon:{type:St,default:"$subgroup"},text:String,viewMode:{type:String,default:"month"}},"VDatePickerControls"),ls=Ee()({name:"VDatePickerControls",props:Is(),emits:{"click:year":()=>!0,"click:month":()=>!0,"click:prev":()=>!0,"click:next":()=>!0,"click:text":()=>!0},setup(n,e){let{emit:t}=e;const a=W(()=>Array.isArray(n.disabled)?n.disabled.includes("text"):!!n.disabled),s=W(()=>Array.isArray(n.disabled)?n.disabled.includes("mode"):!!n.disabled),i=W(()=>Array.isArray(n.disabled)?n.disabled.includes("prev"):!!n.disabled),l=W(()=>Array.isArray(n.disabled)?n.disabled.includes("next"):!!n.disabled);function o(){t("click:prev")}function d(){t("click:next")}function r(){t("click:year")}function c(){t("click:month")}return Re(()=>h("div",{class:["v-date-picker-controls"],style:{"--v-date-picker-controls-height":rn(n.controlHeight)}},[h(E,{class:"v-date-picker-controls__month-btn","data-testid":"month-btn",disabled:a.value,text:n.text,variant:"text",rounded:!0,onClick:c},null),h(E,{class:"v-date-picker-controls__mode-btn","data-testid":"year-btn",disabled:s.value,density:"comfortable",icon:n.modeIcon,variant:"text",onClick:r},null),h(Ce,null,null),h("div",{class:"v-date-picker-controls__month"},[h(E,{"data-testid":"prev-month",disabled:i.value,density:"comfortable",icon:n.prevIcon,variant:"text",onClick:o},null),h(E,{"data-testid":"next-month",disabled:l.value,icon:n.nextIcon,density:"comfortable",variant:"text",onClick:d},null)])])),{}}}),ir=_e({appendIcon:St,color:String,header:String,transition:String,onClick:ia()},"VDatePickerHeader"),os=Ee()({name:"VDatePickerHeader",props:ir(),emits:{click:()=>!0,"click:append":()=>!0},setup(n,e){let{emit:t,slots:a}=e;const{backgroundColorClasses:s,backgroundColorStyles:i}=ms(()=>n.color);function l(){t("click")}function o(){t("click:append")}return Re(()=>{const d=!!(a.default||n.header),r=!!(a.append||n.appendIcon);return h("div",{class:["v-date-picker-header",{"v-date-picker-header--clickable":!!n.onClick},s.value],style:i.value,onClick:l},[a.prepend&&h("div",{key:"prepend",class:"v-date-picker-header__prepend"},[a.prepend()]),d&&h(gs,{key:"content",name:n.transition},{default:()=>{var c;return[h("div",{key:n.header,class:"v-date-picker-header__content"},[((c=a.default)==null?void 0:c.call(a))??n.header])]}}),r&&h("div",{class:"v-date-picker-header__append"},[a.append?h(ln,{key:"append-defaults",disabled:!n.appendIcon,defaults:{VBtn:{icon:n.appendIcon,variant:"text"}}},{default:()=>{var c;return[(c=a.append)==null?void 0:c.call(a)]}}):h(E,{key:"append-btn",icon:n.appendIcon,variant:"text",onClick:o},null)])])}),{}}}),rr=_e({allowedDates:[Array,Function],disabled:{type:Boolean,default:null},displayValue:null,modelValue:Array,month:[Number,String],max:null,min:null,showAdjacentMonths:Boolean,year:[Number,String],weekdays:{type:Array,default:()=>[0,1,2,3,4,5,6]},weeksInMonth:{type:String,default:"dynamic"},firstDayOfWeek:{type:[Number,String],default:void 0}},"calendar");function lr(n){const e=ot(),t=ze(n,"modelValue",[],p=>Tt(p).map(b=>e.date(b))),a=W(()=>n.displayValue?e.date(n.displayValue):t.value.length>0?e.date(t.value[0]):n.min?e.date(n.min):Array.isArray(n.allowedDates)?e.date(n.allowedDates[0]):e.date()),s=ze(n,"year",void 0,p=>{const b=p!=null?Number(p):e.getYear(a.value);return e.startOfYear(e.setYear(e.date(),b))},p=>e.getYear(p)),i=ze(n,"month",void 0,p=>{const b=p!=null?Number(p):e.getMonth(a.value),y=e.setYear(e.startOfMonth(e.date()),e.getYear(s.value));return e.setMonth(y,b)},p=>e.getMonth(p)),l=W(()=>{const p=e.toJsDate(e.startOfWeek(e.date(),n.firstDayOfWeek)).getDay();return[0,1,2,3,4,5,6].map(b=>(b+p)%7)}),o=W(()=>{const p=e.getWeekArray(i.value,n.firstDayOfWeek),b=p.flat(),y=6*7;if(n.weeksInMonth==="static"&&b.length<y){const M=b[b.length-1];let P=[];for(let D=1;D<=y-b.length;D++)P.push(e.addDays(M,D)),D%7===0&&(p.push(P),P=[])}return p});function d(p,b){return p.filter(y=>l.value.includes(e.toJsDate(y).getDay())).map((y,M)=>{const P=e.toISO(y),D=!e.isSameMonth(y,i.value),H=e.isSameDay(y,e.startOfMonth(i.value)),O=e.isSameDay(y,e.endOfMonth(i.value)),j=e.isSameDay(y,i.value);return{date:y,formatted:e.format(y,"keyboardDate"),isAdjacent:D,isDisabled:k(y),isEnd:O,isHidden:D&&!n.showAdjacentMonths,isSame:j,isSelected:t.value.some(pe=>e.isSameDay(y,pe)),isStart:H,isToday:e.isSameDay(y,b),isWeekEnd:M%7===6,isWeekStart:M%7===0,isoDate:P,localized:e.format(y,"dayOfMonth"),month:e.getMonth(y),year:e.getYear(y)}})}const r=W(()=>{const p=e.startOfWeek(a.value,n.firstDayOfWeek),b=[];for(let M=0;M<=6;M++)b.push(e.addDays(p,M));const y=e.date();return d(b,y)}),c=W(()=>{const p=o.value.flat(),b=e.date();return d(p,b)}),g=W(()=>o.value.map(p=>p.length?e.getWeek(p[0],n.firstDayOfWeek):null));function k(p){if(n.disabled)return!0;const b=e.date(p);return n.min&&e.isAfter(e.date(n.min),b)||n.max&&e.isAfter(b,e.date(n.max))?!0:Array.isArray(n.allowedDates)&&n.allowedDates.length>0?!n.allowedDates.some(y=>e.isSameDay(e.date(y),b)):typeof n.allowedDates=="function"?!n.allowedDates(b):!n.weekdays.includes(e.toJsDate(b).getDay())}return{displayValue:a,daysInMonth:c,daysInWeek:r,genDays:d,model:t,weeksInMonth:o,weekDays:l,weekNumbers:g}}const zs=_e({color:String,hideWeekdays:Boolean,multiple:[Boolean,Number,String],showWeek:Boolean,transition:{type:String,default:"picker-transition"},reverseTransition:{type:String,default:"picker-reverse-transition"},...lt(rr(),["displayValue"])},"VDatePickerMonth"),cs=Ee()({name:"VDatePickerMonth",props:zs(),emits:{"update:modelValue":n=>!0,"update:month":n=>!0,"update:year":n=>!0},setup(n,e){let{emit:t,slots:a}=e;const s=en(),{daysInMonth:i,model:l,weekNumbers:o}=lr(n),d=ot(),r=_t(),c=_t(),g=_t(!1),k=tn(()=>g.value?n.reverseTransition:n.transition);n.multiple==="range"&&l.value.length>0&&(r.value=l.value[0],l.value.length>1&&(c.value=l.value[l.value.length-1]));const p=W(()=>{const P=["number","string"].includes(typeof n.multiple)?Number(n.multiple):1/0;return l.value.length>=P});ks(i,(P,D)=>{D&&(g.value=d.isBefore(P[0].date,D[0].date))});function b(P){const D=d.startOfDay(P);if(l.value.length===0?r.value=void 0:l.value.length===1&&(r.value=l.value[0],c.value=void 0),!r.value)r.value=D,l.value=[r.value];else if(c.value)r.value=P,c.value=void 0,l.value=[r.value];else{if(d.isSameDay(D,r.value)){r.value=void 0,l.value=[];return}else d.isBefore(D,r.value)?(c.value=d.endOfDay(r.value),r.value=D):c.value=d.endOfDay(D);const H=d.getDiff(c.value,r.value,"days"),O=[r.value];for(let j=1;j<H;j++){const pe=d.addDays(r.value,j);O.push(pe)}O.push(c.value),l.value=O}}function y(P){const D=l.value.findIndex(H=>d.isSameDay(H,P));if(D===-1)l.value=[...l.value,P];else{const H=[...l.value];H.splice(D,1),l.value=H}}function M(P){n.multiple==="range"?b(P):n.multiple?y(P):l.value=[P]}Re(()=>h("div",{class:"v-date-picker-month"},[n.showWeek&&h("div",{key:"weeks",class:"v-date-picker-month__weeks"},[!n.hideWeekdays&&h("div",{key:"hide-week-days",class:"v-date-picker-month__day"},[v(" ")]),o.value.map(P=>h("div",{class:["v-date-picker-month__day","v-date-picker-month__day--adjacent"]},[P]))]),h(gs,{name:k.value},{default:()=>{var P;return[h("div",{ref:s,key:(P=i.value[0].date)==null?void 0:P.toString(),class:"v-date-picker-month__days"},[!n.hideWeekdays&&d.getWeekdays(n.firstDayOfWeek).map(D=>h("div",{class:["v-date-picker-month__day","v-date-picker-month__weekday"]},[D])),i.value.map((D,H)=>{var j;const O={props:{class:"v-date-picker-month__day-btn",color:D.isSelected||D.isToday?n.color:void 0,disabled:D.isDisabled,icon:!0,ripple:!1,text:D.localized,variant:D.isSelected?"flat":D.isToday?"outlined":"text",onClick:()=>M(D.date)},item:D,i:H};return p.value&&!D.isSelected&&(D.isDisabled=!0),h("div",{class:["v-date-picker-month__day",{"v-date-picker-month__day--adjacent":D.isAdjacent,"v-date-picker-month__day--hide-adjacent":D.isHidden,"v-date-picker-month__day--selected":D.isSelected,"v-date-picker-month__day--week-end":D.isWeekEnd,"v-date-picker-month__day--week-start":D.isWeekStart}],"data-v-date":D.isDisabled?void 0:D.isoDate},[(n.showAdjacentMonths||!D.isAdjacent)&&(((j=a.day)==null?void 0:j.call(a,O))??h(E,O.props,null))])})])]}})]))}}),Fs=_e({color:String,height:[String,Number],min:null,max:null,modelValue:Number,year:Number},"VDatePickerMonths"),us=Ee()({name:"VDatePickerMonths",props:Fs(),emits:{"update:modelValue":n=>!0},setup(n,e){let{emit:t,slots:a}=e;const s=ot(),i=ze(n,"modelValue"),l=W(()=>{let o=s.startOfYear(s.date());return n.year&&(o=s.setYear(o,n.year)),bs(12).map(d=>{const r=s.format(o,"monthShort"),c=!!(n.min&&s.isAfter(s.startOfMonth(s.date(n.min)),o)||n.max&&s.isAfter(o,s.startOfMonth(s.date(n.max))));return o=s.getNextMonth(o),{isDisabled:c,text:r,value:d}})});return ys(()=>{i.value=i.value??s.getMonth(s.date())}),Re(()=>h("div",{class:"v-date-picker-months",style:{height:rn(n.height)}},[h("div",{class:"v-date-picker-months__content"},[l.value.map((o,d)=>{var g;const r={active:i.value===d,color:i.value===d?n.color:void 0,disabled:o.isDisabled,rounded:!0,text:o.text,variant:i.value===o.value?"flat":"text",onClick:()=>c(d)};function c(k){if(i.value===k){t("update:modelValue",i.value);return}i.value=k}return((g=a.month)==null?void 0:g.call(a,{month:o,i:d,props:r}))??h(E,ce({key:"month"},r),null)})])])),{}}}),Vs=_e({color:String,height:[String,Number],min:null,max:null,modelValue:Number},"VDatePickerYears"),ds=Ee()({name:"VDatePickerYears",props:Vs(),emits:{"update:modelValue":n=>!0},setup(n,e){let{emit:t,slots:a}=e;const s=ot(),i=ze(n,"modelValue"),l=W(()=>{const d=s.getYear(s.date());let r=d-100,c=d+52;n.min&&(r=s.getYear(s.date(n.min))),n.max&&(c=s.getYear(s.date(n.max)));let g=s.startOfYear(s.date());return g=s.setYear(g,r),bs(c-r+1,r).map(k=>{const p=s.format(g,"year");return g=s.setYear(g,s.getYear(g)+1),{text:p,value:k}})});ys(()=>{i.value=i.value??s.getYear(s.date())});const o=ra();return la(async()=>{var d;await oa(),(d=o.el)==null||d.scrollIntoView({block:"center"})}),Re(()=>h("div",{class:"v-date-picker-years",style:{height:rn(n.height)}},[h("div",{class:"v-date-picker-years__content"},[l.value.map((d,r)=>{var g;const c={ref:i.value===d.value?o:void 0,active:i.value===d.value,color:i.value===d.value?n.color:void 0,rounded:!0,text:d.text,variant:i.value===d.value?"flat":"text",onClick:()=>{if(i.value===d.value){t("update:modelValue",i.value);return}i.value=d.value}};return((g=a.year)==null?void 0:g.call(a,{year:d,i:r,props:c}))??h(E,ce({key:"month"},c),null)})])])),{}}}),or=ma("v-picker-title"),Bs=_e({bgColor:String,divided:Boolean,landscape:Boolean,title:String,hideHeader:Boolean,...Qs()},"VPicker"),hs=Ee()({name:"VPicker",props:Bs(),setup(n,e){let{slots:t}=e;const{backgroundColorClasses:a,backgroundColorStyles:s}=ms(()=>n.color);return Re(()=>{const i=Un.filterProps(n),l=!!(n.title||t.title);return h(Un,ce(i,{color:n.bgColor,class:["v-picker",{"v-picker--divided":n.divided,"v-picker--landscape":n.landscape,"v-picker--with-actions":!!t.actions},n.class],style:n.style}),{default:()=>{var o;return[!n.hideHeader&&h("div",{key:"header",class:[a.value],style:[s.value]},[l&&h(or,{key:"picker-title"},{default:()=>{var d;return[((d=t.title)==null?void 0:d.call(t))??n.title]}}),t.header&&h("div",{class:"v-picker__header"},[t.header()])]),h("div",{class:"v-picker__body"},[(o=t.default)==null?void 0:o.call(t)]),t.actions&&h(ln,{defaults:{VBtn:{slim:!0,variant:"text"}}},{default:()=>[h("div",{class:"v-picker__actions"},[t.actions()])]})]}})}),{}}}),cr=_e({header:{type:String,default:"$vuetify.datePicker.header"},headerColor:String,...Is(),...zs({weeksInMonth:"static"}),...lt(Fs(),["modelValue"]),...lt(Vs(),["modelValue"]),...Bs({title:"$vuetify.datePicker.title"}),modelValue:null},"VDatePicker"),ur=Ee()({name:"VDatePicker",props:cr(),emits:{"update:modelValue":n=>!0,"update:month":n=>!0,"update:year":n=>!0,"update:viewMode":n=>!0},setup(n,e){let{emit:t,slots:a}=e;const s=ot(),{t:i}=ca(),{rtlClasses:l}=ua(),o=ze(n,"modelValue",void 0,_=>Tt(_).map(F=>s.date(F)),_=>n.multiple?_:_[0]),d=ze(n,"viewMode"),r=W(()=>{const _=s.date(n.min);return n.min&&s.isValid(_)?_:null}),c=W(()=>{const _=s.date(n.max);return n.max&&s.isValid(_)?_:null}),g=W(()=>{var Q;const _=s.date();let F=_;return(Q=o.value)!=null&&Q[0]?F=s.date(o.value[0]):r.value&&s.isBefore(_,r.value)?F=r.value:c.value&&s.isAfter(_,c.value)&&(F=c.value),F&&s.isValid(F)?F:_}),k=tn(()=>n.headerColor??n.color),p=en(Number(n.month??s.getMonth(s.startOfMonth(g.value)))),b=en(Number(n.year??s.getYear(s.startOfYear(s.setMonth(g.value,p.value))))),y=_t(!1),M=W(()=>n.multiple&&o.value.length>1?i("$vuetify.datePicker.itemsSelected",o.value.length):o.value[0]&&s.isValid(o.value[0])?s.format(s.date(o.value[0]),"normalDateWithWeekday"):i(n.header)),P=W(()=>{let _=s.date();return _=s.setDate(_,1),_=s.setMonth(_,p.value),_=s.setYear(_,b.value),s.format(_,"monthAndYear")}),D=tn(()=>`date-picker-header${y.value?"-reverse":""}-transition`),H=W(()=>{if(n.disabled)return!0;const _=[];if(d.value!=="month")_.push("prev","next");else{let F=s.date();if(F=s.startOfMonth(F),F=s.setMonth(F,p.value),F=s.setYear(F,b.value),r.value){const Q=s.addDays(s.startOfMonth(F),-1);s.isAfter(r.value,Q)&&_.push("prev")}if(c.value){const Q=s.addDays(s.endOfMonth(F),1);s.isAfter(Q,c.value)&&_.push("next")}}return _});function O(){p.value<11?p.value++:(b.value++,p.value=0,Pe(b.value)),Le(p.value)}function j(){p.value>0?p.value--:(b.value--,p.value=11,Pe(b.value)),Le(p.value)}function pe(){d.value="month"}function De(){d.value=d.value==="months"?"month":"months"}function ge(){d.value=d.value==="year"?"month":"year"}function Le(_){d.value==="months"&&De(),t("update:month",_)}function Pe(_){d.value==="year"&&ge(),t("update:year",_)}return ks(o,(_,F)=>{const Q=Tt(F),xe=Tt(_);if(!xe.length)return;const Ye=s.date(Q[Q.length-1]),Me=s.date(xe[xe.length-1]),Ae=s.getMonth(Me),B=s.getYear(Me);Ae!==p.value&&(p.value=Ae,Le(p.value)),B!==b.value&&(b.value=B,Pe(b.value)),y.value=s.isBefore(Ye,Me)}),Re(()=>{const _=hs.filterProps(n),F=ls.filterProps(n),Q=os.filterProps(n),xe=cs.filterProps(n),Ye=lt(us.filterProps(n),["modelValue"]),Me=lt(ds.filterProps(n),["modelValue"]),Ae={color:k.value,header:M.value,transition:D.value};return h(hs,ce(_,{color:k.value,class:["v-date-picker",`v-date-picker--${d.value}`,{"v-date-picker--show-week":n.showWeek},l.value,n.class],style:n.style}),{title:()=>{var B;return((B=a.title)==null?void 0:B.call(a))??h("div",{class:"v-date-picker__title"},[i(n.title)])},header:()=>a.header?h(ln,{defaults:{VDatePickerHeader:{...Ae}}},{default:()=>{var B;return[(B=a.header)==null?void 0:B.call(a,Ae)]}}):h(os,ce({key:"header"},Q,Ae,{onClick:d.value!=="month"?pe:void 0}),{...a,default:void 0}),default:()=>h(K,null,[h(ls,ce(F,{disabled:H.value,text:P.value,"onClick:next":O,"onClick:prev":j,"onClick:month":De,"onClick:year":ge}),null),h(ya,{hideOnLeave:!0},{default:()=>[d.value==="months"?h(us,ce({key:"date-picker-months"},Ye,{modelValue:p.value,"onUpdate:modelValue":[B=>p.value=B,Le],min:r.value,max:c.value,year:b.value}),null):d.value==="year"?h(ds,ce({key:"date-picker-years"},Me,{modelValue:b.value,"onUpdate:modelValue":[B=>b.value=B,Pe],min:r.value,max:c.value}),null):h(cs,ce({key:"date-picker-month"},xe,{modelValue:o.value,"onUpdate:modelValue":B=>o.value=B,month:p.value,"onUpdate:month":[B=>p.value=B,Le],year:b.value,"onUpdate:year":[B=>b.value=B,Pe],min:r.value,max:c.value}),null)]})]),actions:a.actions})}),{}}}),dr={name:"Classworks 作业板",components:{MessageLog:ea,RandomPicker:Xa,HomeworkTag:Js},data(){return{dataKey:"",provider:"",useDisplay:Yn,isDragOver:!1,state:{classNumber:"",studentList:[],boardData:{homework:{},attendance:{absent:[],late:[],exclude:[]}},dialogVisible:!1,dialogTitle:"",textarea:"",dateString:"",synced:!1,attendDialogVisible:!1,contentStyle:{"font-size":`${A("font.size")}px`},uploadLoading:!1,downloadLoading:!1,snackbar:!1,snackbarText:"",fontSize:A("font.size"),datePickerDialog:!1,selectedDate:new Date().toISOString().split("T")[0],selectedDateObj:new Date(this.selectedDate),refreshInterval:null,subjectOrder:["语文","数学","英语","物理","化学","生物","政治","历史","地理","其他"],showNoDataMessage:!1,noDataMessage:"",isToday:!1,attendanceDialog:!1,isFullscreen:!1},loading:{download:!1,upload:!1,students:!1},debouncedUpload:null,throttledReflow:null,sortedItemsCache:{key:"",value:[]},confirmDialog:{show:!1,resolve:null,reject:null},attendanceSearch:"",attendanceFilter:[],urlConfigDialog:{show:!1,config:null,changes:[],validSettings:{},confirmHandler:null,cancelHandler:null,icons:{}}}},computed:{...ha(jn,["subjects"]),availableSubjects(){const n=Array.isArray(this.subjects)?this.subjects:[];console.log("[index.vue] Store subjects in computed:",n);const e=n.map(t=>({key:t,name:t}));return console.log("[index.vue] Computed availableSubjects:",e),e},tagsEnabled(){return A("tags.enabled")||!1},availableTags(){return A("tags.list")||[]},isMobile(){return Yn().mobile.value},titleText(){const n=this.getToday(),e=new Date(n);e.setDate(e.getDate()-1);const t=this.state.dateString,a=this.formatDate(n),s=this.formatDate(e);return t===a?"今天的作业":t===s?"昨天的作业":`${t}的作业`},sortedItems(){const n=`${JSON.stringify(this.state.boardData.homework)}_${this.state.subjectOrder.join()}_${this.dynamicSort}`;if(this.sortedItemsCache.key===n)return this.sortedItemsCache.value;const e=Object.entries(this.state.boardData.homework).filter(([,a])=>{var s;return(s=a.content)==null?void 0:s.trim()}).map(([a,s])=>{var i;return{key:a,name:((i=this.availableSubjects.find(l=>l.key===a))==null?void 0:i.name)||a,content:s.content,order:this.state.subjectOrder.indexOf(a),rowSpan:Math.ceil((s.content.split(`
`).filter(l=>l.trim()).length+1)*.8)}});console.log("[index.vue] Calculating sortedItems. Homework data:",this.state.boardData.homework),console.log("[index.vue] Calculating sortedItems. Available subjects:",this.availableSubjects);const t=this.dynamicSort?this.optimizeGridLayout(e):e.sort((a,s)=>a.order-s.order);return this.updateSortedItemsCache(n,t),console.log("[index.vue] Computed sortedItems:",t),t},unusedSubjects(){const n=Object.keys(this.state.boardData.homework).filter(t=>{var a;return(a=this.state.boardData.homework[t].content)==null?void 0:a.trim()});console.log("[index.vue] Calculating unusedSubjects. Used keys:",n),console.log("[index.vue] Calculating unusedSubjects. Available subjects:",this.availableSubjects);const e=this.availableSubjects.filter(t=>!n.includes(t.key));return console.log("[index.vue] Computed unusedSubjects:",e),e},emptySubjects(){return this.emptySubjectDisplay!=="button"?[]:this.unusedSubjects},autoSave(){return A("edit.autoSave")},blockNonTodayAutoSave(){return A("edit.blockNonTodayAutoSave")},isToday(){const n=new Date().toISOString().split("T")[0];return this.state.dateString===n},canAutoSave(){return this.autoSave&&(!this.blockNonTodayAutoSave||this.isToday)},needConfirmSave(){return!this.isToday&&this.confirmNonTodaySave},shouldShowBlockedMessage(){return!this.isToday&&this.autoSave&&this.blockNonTodayAutoSave},refreshBeforeEdit(){return A("edit.refreshBeforeEdit")},emptySubjectDisplay(){return A("display.emptySubjectDisplay")},dynamicSort(){return A("display.dynamicSort")},isEditingDisabled(){return this.state.uploadLoading||this.state.downloadLoading},unreadCount(){var n;return((n=this.$refs.messageLog)==null?void 0:n.unreadCount)||0},showRandomPickerButton(){return A("randomPicker.enabled")},confirmNonTodaySave(){return A("edit.confirmNonTodaySave")},shouldShowSaveConfirm(){return!this.isToday&&this.confirmNonTodaySave},shouldBlockAutoSave(){return!this.isToday&&this.autoSave&&this.blockNonTodayAutoSave},showFullscreenButton(){return A("display.showFullscreenButton")},showAntiScreenBurnCard(){return A("display.showAntiScreenBurnCard")},filteredStudents(){let n=[...this.state.studentList];if(this.attendanceSearch){const e=this.attendanceSearch.toLowerCase();n=n.filter(t=>t.toLowerCase().includes(e))}return this.attendanceFilter&&this.attendanceFilter.length>0&&(n=n.filter(e=>{const t=this.state.studentList.indexOf(e);return!!(this.attendanceFilter.includes("present")&&this.isPresent(t)||this.attendanceFilter.includes("absent")&&this.isAbsent(t)||this.attendanceFilter.includes("late")&&this.isLate(t)||this.attendanceFilter.includes("exclude")&&this.isExclude(t))})),n},extractedSurnames(){if(!this.state.studentList||this.state.studentList.length===0)return[];const n=new Map;return this.state.studentList.forEach(e=>{if(e&&e.length>0){const t=e.charAt(0);n.has(t)?n.set(t,n.get(t)+1):n.set(t,1)}}),Array.from(n.entries()).map(([e,t])=>({name:e,count:t})).sort((e,t)=>{const a=Hn(e.name,{toneType:"none",mode:"surname"}),s=Hn(t.name,{toneType:"none",mode:"surname"});return a.localeCompare(s)})}},watch:{homeworkData:{handler(){this.$nextTick(()=>{this.$refs.waterfall&&this.$refs.waterfall.reflow()})},deep:!0},"$vuetify.display.width":{handler(){this.throttledReflow()},deep:!0}},created(){this.debouncedUpload=Ka(this.uploadData,2e3),this.throttledReflow=Qa(()=>{this.$refs.gridContainer&&this.optimizeGridLayout(this.sortedItems)},200)},async mounted(){try{const n=A("subjects");console.log("[index.vue mounted] Subjects from settings:",n);const e=Array.isArray(n)?n:[];if(n==null){console.log("[index.vue mounted] No subjects setting found or it is null/undefined, adding default subjects");const t=["语文","数学","英语","物理","化学","生物","政治","历史","地理","其他"];kt("subjects",t),this.setSubjects(t)}else{const t=Array.isArray(n)?n:[];this.setSubjects(t),console.log("[index.vue mounted] Updated Pinia store with subjects from settings:",t)}this.updateBackendUrl(),await this.initializeData(),this.setupAutoRefresh(),this.unwatchSettings=pa(()=>{this.updateSettings()}),document.addEventListener("fullscreenchange",this.fullscreenChangeHandler),document.addEventListener("webkitfullscreenchange",this.fullscreenChangeHandler),document.addEventListener("mozfullscreenchange",this.fullscreenChangeHandler),document.addEventListener("MSFullscreenChange",this.fullscreenChangeHandler),this.checkHashForRandomPicker(),window.addEventListener("hashchange",this.checkHashForRandomPicker)}catch(n){console.error("初始化失败:",n),this.showError("初始化失败，请刷新页面重试")}},beforeUnmount(){this.unwatchSettings&&this.unwatchSettings(),this.state.refreshInterval&&clearInterval(this.state.refreshInterval),document.removeEventListener("fullscreenchange",this.fullscreenChangeHandler),document.removeEventListener("webkitfullscreenchange",this.fullscreenChangeHandler),document.removeEventListener("mozfullscreenchange",this.fullscreenChangeHandler),document.removeEventListener("MSFullscreenChange",this.fullscreenChangeHandler),window.removeEventListener("hashchange",this.checkHashForRandomPicker)},methods:{parsedContent(n){if(!n)return"";let e=I.parse(n);return nr.sanitize(e)},...da(jn,["setSubjects"]),ensureDate(n){if(n instanceof Date)return n;if(typeof n=="string"){const e=new Date(n);if(!isNaN(e.getTime()))return e}return new Date},formatDate(n){const e=this.ensureDate(n),t=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0");return`${t}-${a}-${s}`},getToday(){return new Date},async initializeData(){if(!await this.parseUrlConfig()){this.provider=A("server.provider");const i=A("server.domain"),l=A("server.classNumber");this.dataKey=this.provider==="server"?`${i}/${l}`:l,this.state.classNumber=l}const t=new URLSearchParams(window.location.search).get("date"),a=this.getToday(),s=t?new Date(t):a;this.state.dateString=this.formatDate(s),this.state.selectedDate=this.state.dateString,this.state.isToday=this.formatDate(s)===this.formatDate(a),await Promise.all([this.downloadData(),this.loadConfig()])},async downloadData(){var n,e,t;if(!this.loading.download)try{this.loading.download=!0;const a=await jt.loadData(this.provider,this.dataKey,this.state.dateString);if(a.success)this.state.boardData={homework:a.data.homework||{},attendance:{absent:((n=a.data.attendance)==null?void 0:n.absent)||[],late:((e=a.data.attendance)==null?void 0:e.late)||[],exclude:((t=a.data.attendance)==null?void 0:t.exclude)||[]}},this.state.synced=!0,this.state.showNoDataMessage=!1,this.$message.success("下载成功","数据已更新");else if(a.error.code==="NOT_FOUND")this.state.showNoDataMessage=!0,this.state.noDataMessage=a.error.message,this.state.boardData={homework:{},attendance:{absent:[],late:[],exclude:[]}};else throw new Error(a.error.message)}catch(a){this.state.boardData={homework:{},attendance:{absent:[],late:[],exclude:[]}},this.$message.error("下载失败",a.message)}finally{this.loading.download=!1}},async trySave(n=!1){if(n&&!this.canAutoSave)return this.shouldShowBlockedMessage&&this.showMessage("需要手动保存","已禁止自动保存非当天数据","warning"),!1;if(!n&&this.needConfirmSave)try{await this.showConfirmDialog()}catch{return!1}try{return await this.uploadData(),!0}catch(e){return this.$message.error("保存失败",e.message||"请重试"),!1}},handleContentEditableInput(){},async handleClose(){var s,i;if(!this.currentEditSubject)return;const n=((s=this.$refs.inputRef)==null?void 0:s.innerHTML)||"",e=document.createElement("div");e.innerHTML=n;let t="";e.childNodes.forEach(l=>{var o;if(l.nodeType===Node.TEXT_NODE)t+=l.textContent;else if(l.nodeType===Node.ELEMENT_NODE&&l.classList.contains("homework-tag-inline"))t+=` [${l.textContent}] `;else if(l.nodeType===Node.ELEMENT_NODE&&l.tagName==="BR")t+=`
`;else if(l.nodeType===Node.ELEMENT_NODE){const d=((o=l.querySelector(".v-chip__content"))==null?void 0:o.textContent)||l.textContent;l.classList.contains("v-chip")?t+=` [${d.trim()}] `:t+=l.textContent}}),t=t.replace(/\s+/g," ").trim();const a=((i=this.state.boardData.homework[this.currentEditSubject])==null?void 0:i.content)||"";t!==a.trim()&&(this.state.boardData.homework[this.currentEditSubject]={content:t},this.state.synced=!1,this.autoSave&&await this.trySave(!0)),this.state.dialogVisible=!1},handleDragOver(n){n.preventDefault(),this.isDragOver=!0},handleDragLeave(n){n.preventDefault(),this.isDragOver=!1},handleTagDrop(n){n.preventDefault(),this.isDragOver=!1;try{const e=JSON.parse(n.dataTransfer.getData("text/plain"));if(e.type==="homework-tag"){const t=this.$refs.inputRef;t.focus();const a=window.getSelection();if(a.rangeCount>0){const o=a.getRangeAt(0).startContainer;let d=o,r=o,c=o;for(;c&&c!==t;){if(c.nodeName==="BR"){d=c.nextSibling;break}if(!c.previousSibling)if(c.parentNode===t){d=c;break}else{c=c.parentNode;continue}c=c.previousSibling}for((!d||d===o&&c===t)&&(d=t.firstChild),d||(d=t.firstChild),c=o;c&&c!==t;){if(c.nodeName==="BR"){r=c.previousSibling;break}if(!c.nextSibling)if(c.parentNode===t){r=c;break}else{c=c.parentNode;continue}c=c.nextSibling}(!r||r===o&&c===t)&&(r=t.lastChild),r||(r=t.lastChild);let g="",k=d;const p=`[${e.text}]`;let b=!1;for(;k;){if(k.nodeType===Node.TEXT_NODE)g+=k.textContent;else if(k.nodeType===Node.ELEMENT_NODE&&k.classList.contains("homework-tag-inline")){const y=k.querySelector(".v-chip__content");if(y){const M=`[${y.textContent}]`;if(g+=` ${M} `,M.trim()===p.trim()){b=!0;break}}}if(k===r)break;k=k.nextSibling,!k&&r.parentNode!==t&&(k=r.parentNode.nextSibling)}if(b){this.$message.warning("重复标签",`这一行已经有 "${e.text}" 标签了。`);return}}const s=document.createElement("span");s.className="homework-tag-inline v-chip v-chip--size-small theme--light v-chip--outlined",s.style.borderColor=e.color,s.style.color=e.color,s.style.margin="0 2px",s.style.padding="2px 6px",s.style.borderRadius="12px",s.style.display="inline-block",s.style.cursor="default",s.style.verticalAlign="middle",s.contentEditable=!1;const i=document.createElement("span");if(i.className="v-chip__content",i.textContent=e.text,s.appendChild(i),a.rangeCount>0){const l=a.getRangeAt(0);l.deleteContents();const o=document.createTextNode(" ");l.insertNode(o),l.insertNode(s),l.setStartAfter(o),l.collapse(!0),a.removeAllRanges(),a.addRange(l)}else t.appendChild(s),t.appendChild(document.createTextNode(" "));this.handleContentEditableInput()}}catch(e){console.error("标签拖放处理错误:",e),this.$message.error("操作失败","处理标签拖放时出错")}},async uploadData(){if(!this.loading.upload)try{this.loading.upload=!0;const n=await jt.saveData(this.provider,this.dataKey,this.state.boardData,this.state.dateString);if(!n.success)throw new Error(n.error.message);this.state.synced=!0,this.$message.success(n.message||"保存成功")}finally{this.loading.upload=!1}},async loadConfig(){try{const n=await jt.loadConfig(this.provider,this.dataKey);if(!n.success)throw new Error(n.error.message);this.state.studentList=n.data.studentList||[]}catch(n){console.error("加载配置失败:",n),this.$message.error("加载配置失败",n.message)}},showSyncMessage(){this.$message.success("数据已同步","数据已完成与服务器同步")},async openDialog(n){var a;if(this.refreshBeforeEdit)try{await this.downloadData()}catch(s){console.error("刷新数据失败:",s),this.$message.error("刷新数据失败，可能显示的不是最新数据")}this.currentEditSubject=n,this.state.boardData.homework[n]||(this.state.boardData.homework[n]={content:""}),this.state.dialogTitle=((a=this.availableSubjects.find(s=>s.key===n))==null?void 0:a.name)||n;let e=this.state.boardData.homework[n].content||"";const t=/\s*\[([^\]]+)\]\s*/g;e=e.replace(t,(s,i)=>{const l=this.availableTags.find(o=>o.text===i.trim());return l?`<span class="homework-tag-inline v-chip v-chip--size-small theme--light v-chip--outlined" style="border-color: ${l.color}; color: ${l.color}; margin: 0 2px; padding: 2px 6px; border-radius: 12px; display: inline-block; cursor: default; vertical-align: middle;" contenteditable="false"><span class="v-chip__content">${l.text}</span></span> `:s}),this.state.textarea=e,this.state.dialogVisible=!0,this.$nextTick(()=>{if(this.$refs.inputRef){this.$refs.inputRef.innerHTML=this.state.textarea,this.$refs.inputRef.focus();const s=document.createRange(),i=window.getSelection();s.selectNodeContents(this.$refs.inputRef),s.collapse(!1),i.removeAllRanges(),i.addRange(s)}})},splitPoint(n){return n.split(`
`).filter(e=>e.trim())},setAttendanceArea(){this.state.attendanceDialog=!0},toggleStudentStatus(n){const e=this.state.studentList[n];this.state.boardData.attendance.absent.includes(e)?(this.state.boardData.attendance.absent=this.state.boardData.attendance.absent.filter(t=>t!==e),this.state.boardData.attendance.late.push(e)):this.state.boardData.attendance.late.includes(e)?(this.state.boardData.attendance.late=this.state.boardData.attendance.late.filter(t=>t!==e),this.state.boardData.attendance.exclude.push(e)):this.state.boardData.attendance.exclude.includes(e)?this.state.boardData.attendance.exclude=this.state.boardData.attendance.exclude.filter(t=>t!==e):this.state.boardData.attendance.absent.push(e),this.state.synced=!1,this.canAutoSave&&this.uploadData()},cleanstudentslist(){this.state.boardData.attendance.absent=[],this.state.boardData.attendance.late=[],this.state.boardData.attendance.exclude=[],this.state.synced=!1,this.canAutoSave&&this.uploadData()},zoom(n){n==="up"&&this.state.fontSize<100?this.state.fontSize+=2:n==="out"&&this.state.fontSize>16&&(this.state.fontSize-=2),this.state.contentStyle={"font-size":`${this.state.fontSize}px`},kt("font.size",this.state.fontSize)},updateBackendUrl(){const n=A("server.provider"),e=A("server.domain"),t=A("server.classNumber");this.provider=n,this.dataKey=n==="server"?`${e}/${t}`:t,this.state.classNumber=t},setupAutoRefresh(){const n=A("refresh.auto"),e=A("refresh.interval");this.state.refreshInterval&&clearInterval(this.state.refreshInterval),n&&(this.state.refreshInterval=setInterval(()=>{this.shouldSkipRefresh()||this.downloadData()},e*1e3))},shouldSkipRefresh(){return!!(this.state.dialogVisible||this.state.attendanceDialog||this.confirmDialog.show||this.state.datePickerDialog||this.loading.upload||this.loading.download||!this.state.synced)},updateSettings(){this.state.fontSize=A("font.size"),this.state.contentStyle={"font-size":`${this.state.fontSize}px`},this.setupAutoRefresh(),this.updateBackendUrl()},handleDateSelect(n){if(n)try{const e=this.ensureDate(n),t=this.formatDate(e);this.state.dateString!==t&&(this.state.dateString=t,this.state.selectedDate=t,this.state.isToday=t===this.formatDate(this.getToday()),this.$router.replace({query:{date:t}}).catch(()=>{}),this.downloadData())}catch(e){console.error("Date processing error:",e),this.$message.error("日期处理错误","请重新选择日期")}},optimizeGridLayout(n){const e=Math.min(3,Math.floor(window.innerWidth/300));if(e<=1)return n;const t=Array.from({length:e},()=>({height:0,items:[]}));return n.forEach(a=>{const s=t.reduce((i,l,o)=>l.height<t[i].height?o:i,0);t[s].items.push(a),t[s].height+=a.rowSpan}),t.flatMap(a=>a.items).map((a,s)=>({...a,order:s}))},fixedGridLayout(n){const e=[["语文","数学","英语"],["物理","化学","生物"],["政治","历史","地理","其他"]];return n.sort((t,a)=>{const s=c=>{for(let g=0;g<e.length;g++)if(e[g].includes(c))return g;return e.length},i=c=>{for(const g of e){const k=g.indexOf(c);if(k!==-1)return k}return 999},l=s(t.key),o=s(a.key);if(l!==o)return l-o;const d=i(t.key),r=i(a.key);return d-r}).map((t,a)=>({...t,order:a,rowSpan:t.content?2:1}))},setAllPresent(){this.state.boardData.attendance={absent:[],late:[],exclude:[]},this.state.synced=!1},setAllAbsent(){this.state.boardData.attendance.absent=[...this.state.studentList],this.state.boardData.attendance.late=[],this.state.boardData.attendance.exclude=[],this.state.synced=!1},setAllLate(){this.state.boardData.attendance.absent=[],this.state.boardData.attendance.late=[...this.state.studentList],this.state.boardData.attendance.exclude=[],this.state.synced=!1},setAllExclude(){this.state.boardData.attendance.absent=[],this.state.boardData.attendance.late=[],this.state.boardData.attendance.exclude=[...this.state.studentList],this.state.synced=!1},isPresent(n){const e=this.state.studentList[n],{absent:t,late:a,exclude:s}=this.state.boardData.attendance;return!t.includes(e)&&!a.includes(e)&&!s.includes(e)},isAbsent(n){return this.state.boardData.attendance.absent.includes(this.state.studentList[n])},isLate(n){return this.state.boardData.attendance.late.includes(this.state.studentList[n])},isExclude(n){return this.state.boardData.attendance.exclude.includes(this.state.studentList[n])},setPresent(n){const e=this.state.studentList[n];this.state.boardData.attendance.absent=this.state.boardData.attendance.absent.filter(t=>t!==e),this.state.boardData.attendance.late=this.state.boardData.attendance.late.filter(t=>t!==e),this.state.boardData.attendance.exclude=this.state.boardData.attendance.exclude.filter(t=>t!==e),this.state.synced=!1},setAbsent(n){const e=this.state.studentList[n];this.setPresent(n),this.state.boardData.attendance.absent.push(e),this.state.synced=!1},setLate(n){const e=this.state.studentList[n];this.setPresent(n),this.state.boardData.attendance.late.push(e),this.state.synced=!1},setExclude(n){const e=this.state.studentList[n];this.setPresent(n),this.state.boardData.attendance.exclude.push(e),this.state.synced=!1},async saveAttendance(){try{await this.trySave(!0),this.state.attendanceDialog=!1}catch(n){console.error("保存出勤状态失败:",n),this.$message.error("保存失败","请重试")}},showMessage(n,e="",t="success"){this.$message[t](n,e)},updateSortedItemsCache(n,e){this._sortedItemsCache={key:n,value:e}},handleMouseMove(n){const e=n.currentTarget,t=e.getBoundingClientRect(),a=(n.clientX-t.left)/t.width*100,s=(n.clientY-t.top)/t.height*100;e.style.setProperty("--x",`${a}%`),e.style.setProperty("--y",`${s}%`)},handleTouchMove(n){if(n.touches.length===1){const e=n.touches[0],t=n.currentTarget,a=t.getBoundingClientRect(),s=(e.clientX-a.left)/a.width*100,i=(e.clientY-a.top)/a.height*100;t.style.setProperty("--x",`${s}%`),t.style.setProperty("--y",`${i}%`)}},showConfirmDialog(){return new Promise((n,e)=>{this.confirmDialog={show:!0,resolve:()=>{this.confirmDialog.show=!1,n()},reject:()=>{this.confirmDialog.show=!1,e(new Error("用户取消保存"))}}})},confirmSave(){this.confirmDialog.show=!1,this.confirmDialog.resolve&&this.confirmDialog.resolve(!0)},cancelSave(){this.confirmDialog.show=!1,this.confirmDialog.reject&&this.confirmDialog.reject(new Error("用户取消保存"))},async manualUpload(){return this.trySave(!1)},async handleAttendanceDialogClose(n){!n&&!this.state.synced&&await this.trySave(!0)},toggleFullscreen(){this.state.isFullscreen?this.exitFullscreen():this.enterFullscreen()},enterFullscreen(){const n=document.documentElement;n.requestFullscreen?n.requestFullscreen():n.webkitRequestFullScreen?n.webkitRequestFullScreen():n.mozRequestFullScreen?n.mozRequestFullScreen():n.msRequestFullscreen&&n.msRequestFullscreen()},exitFullscreen(){document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen()},fullscreenChangeHandler(){this.state.isFullscreen=!!(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement)},getStudentStatusColor(n){const e=this.state.studentList[n];return this.state.boardData.attendance.absent.includes(e)?"error":this.state.boardData.attendance.late.includes(e)?"warning":this.state.boardData.attendance.exclude.includes(e)?"grey":"success"},getStudentStatusVariant(n){const e=this.state.studentList[n];return this.state.boardData.attendance.absent.includes(e)||this.state.boardData.attendance.late.includes(e)||this.state.boardData.attendance.exclude.includes(e)?"tonal":"outlined"},getStudentStatusIcon(n){const e=this.state.studentList[n];return this.state.boardData.attendance.absent.includes(e)?"mdi-account-off":this.state.boardData.attendance.late.includes(e)?"mdi-clock-alert":this.state.boardData.attendance.exclude.includes(e)?"mdi-account-cancel":"mdi-account-check"},getStudentStatusText(n){const e=this.state.studentList[n];return this.state.boardData.attendance.absent.includes(e)?"请假":this.state.boardData.attendance.late.includes(e)?"迟到":this.state.boardData.attendance.exclude.includes(e)?"不参与":"到课"},toggleFilter(n){const e=this.attendanceFilter.indexOf(n);e===-1?this.attendanceFilter.push(n):this.attendanceFilter.splice(e,1)},openRandomPicker(){this.$refs.randomPicker&&this.$refs.randomPicker.open()},checkHashForRandomPicker(){window.location.hash==="#random-picker"&&this.$nextTick(()=>{console.log("打开随机点名"),window.location.hash="",this.openRandomPicker()})},parseUrlConfig(){try{const e=new URLSearchParams(window.location.search).get("config");if(!e)return!1;try{const t=this.safeBase64Decode(e),a=JSON.parse(t);console.log("从URL读取配置:",a);const s=[],i={},l={};return this.processSpecialSettings(a,s,i),this.processStandardSettings(a,s,i,l),Object.keys(i).length===0?(console.log("URL配置与当前配置相同，无需应用"),!1):new Promise(o=>{this.urlConfigDialog={show:!0,config:a,changes:s,validSettings:i,icons:l,confirmHandler:()=>{this.urlConfigDialog.show=!1,this.applyUrlConfig(i),o(!0)},cancelHandler:()=>{this.urlConfigDialog.show=!1,o(!1)}}})}catch(t){return console.error("解析URL配置错误:",t),this.$message.error("URL配置错误","无法解析配置数据"),!1}}catch(n){return console.error("处理URL配置错误:",n),!1}},processSpecialSettings(n,e,t){var a,s;if(n.classNumber!==void 0){const i=A("server.classNumber");n.classNumber!==i&&(e.push({key:"server.classNumber",name:"班级",oldValue:i,newValue:n.classNumber,description:((a=Ie["server.classNumber"])==null?void 0:a.description)||"班级编号",icon:((s=Ie["server.classNumber"])==null?void 0:s.icon)||"mdi-account-group"}),t["server.classNumber"]=n.classNumber)}n.date!==void 0&&n.date!==this.state.dateString&&(e.push({key:"date",name:"日期",oldValue:this.state.dateString,newValue:n.date,description:"查看的日期",icon:"mdi-calendar"}),t.date=n.date),n.subjects&&Array.isArray(n.subjects)&&(e.push({key:"subjects",name:"科目列表",oldValue:`${this.state.availableSubjects.length}个科目`,newValue:`${n.subjects.length}个科目`,description:"可用科目列表",icon:"mdi-notebook"}),t.subjects=n.subjects)},processStandardSettings(n,e,t,a){Object.entries(n).forEach(([s,i])=>{if(["classNumber","date","subjects"].includes(s))return;let l=s,o=Ie[s];if(!o&&!s.includes(".")){const d=["server.","display.","theme.","edit.","refresh.","font.","randomPicker."];for(const r of d){const c=`${r}${s}`;if(Ie[c]){l=c,o=Ie[c];break}}}if(o){let d=this.convertValueToCorrectType(i,o.type);if(o.validate&&!o.validate(d)){console.warn(`URL配置项 ${l} 的值无效: ${i}`);return}const r=A(l);d!==r&&(e.push({key:l,name:this.getSettingDisplayName(l),oldValue:this.formatSettingValue(r),newValue:this.formatSettingValue(d),description:o.description||l,icon:o.icon||"mdi-cog"}),t[l]=d,a[l]=o.icon||"mdi-cog")}else e.push({key:s,name:this.getSettingDisplayName(s),oldValue:"未知",newValue:this.formatSettingValue(i),description:"自定义配置项",icon:"mdi-cog-outline"}),t[s]=i,a[s]="mdi-cog-outline"})},convertValueToCorrectType(n,e){return e==="boolean"?!!n:e==="number"?Number(n):String(n)},formatSettingValue(n){return typeof n=="boolean"?n?"开启":"关闭":n===""||n===null||n===void 0?"空":n.toString()},getSettingDisplayName(n){const e=n.split("."),t=e[e.length-1];return{provider:"数据提供方",domain:"服务器域名",classNumber:"班级编号",emptySubjectDisplay:"空科目显示方式",dynamicSort:"动态排序",showRandomButton:"随机按钮",showFullscreenButton:"全屏按钮",cardHoverEffect:"卡片悬浮效果",enhancedTouchMode:"增强触摸模式",showAntiScreenBurnCard:"防烧屏卡片",mode:"主题模式",size:"字体大小",autoSave:"自动保存",blockNonTodayAutoSave:"禁止自动保存非当日",refreshBeforeEdit:"编辑前刷新",confirmNonTodaySave:"非当日保存确认",auto:"自动刷新",interval:"刷新间隔"}[t]||t},safeBase64Decode(n){try{const e=n.replace(/-/g,"+").replace(/_/g,"/"),t=e.padEnd(e.length+(4-(e.length%4||4))%4,"="),a=atob(t),s=new Uint8Array(a.length);for(let l=0;l<a.length;l++)s[l]=a.charCodeAt(l);return new TextDecoder("utf-8").decode(s)}catch(e){throw console.error("Base64解码错误:",e),new Error("无法解码配置数据")}},applyUrlConfig(n){for(const[e,t]of Object.entries(n)){if(e==="date"){this.handleDateSelect(t);continue}if(e==="subjects"){Array.isArray(t)?(this.setSubjects(t),kt("subjects",t),console.log("[index.vue] Updated subjects via URL config and persisted:",t)):console.warn("[index.vue] Invalid subjects format in URL config:",t);continue}kt(e,t),e==="server.classNumber"&&(this.state.classNumber=t)}return this.updateBackendUrl(),this.$message.success("URL配置已应用","已从URL加载配置"),!0}}},hr={class:"d-flex"},fr={ref:"gridContainer",class:"grid-masonry"},pr=["innerHTML"],mr={class:"empty-subjects mt-4"},gr={key:1,class:"empty-subjects-grid"},kr={style:{"white-space":"nowrap"}},br={style:{"white-space":"nowrap"}},yr={style:{"white-space":"nowrap"}},xr={key:0},vr={style:{"white-space":"nowrap"}},wr={style:{"white-space":"nowrap"}},Sr={key:0},Tr={style:{"white-space":"nowrap"}},_r={style:{"white-space":"nowrap"}},Dr={key:0},Ar={style:{"white-space":"nowrap"}},Cr=["innerHTML"],Er={key:0,class:"mt-3"},Rr={class:"d-flex align-center mb-2"},Lr={class:"tags-container"},Pr={key:0,class:"text-caption text-grey pa-2"},Mr={class:"d-flex flex-wrap mt-2 gap-1"},Nr={class:"d-flex flex-wrap mb-4 gap-2"},Or={class:"flex-grow-1"},Ir={class:"d-flex align-center"},zr={class:"text-subtitle-1"},Fr={class:"attendance-actions"},Vr={class:"text-subtitle-1"},Br={class:"text-grey-darken-1"},Ur={class:"text-primary font-weight-medium"};function Hr(n,e,t,a,s,i){const l=Gt("homework-tag"),o=Gt("message-log"),d=Gt("random-picker");return T(),L(K,null,[h(na,{class:"no-select"},{prepend:f(()=>[h(ar,{icon:"mdi-home"})]),append:f(()=>[h(E,{icon:"mdi-format-font-size-decrease",variant:"text",onClick:e[0]||(e[0]=r=>i.zoom("out"))}),h(E,{icon:"mdi-format-font-size-increase",variant:"text",onClick:e[1]||(e[1]=r=>i.zoom("up"))}),h(_a,{modelValue:s.state.datePickerDialog,"onUpdate:modelValue":e[3]||(e[3]=r=>s.state.datePickerDialog=r),"close-on-content-click":!1},{activator:f(({props:r})=>[h(E,ce({icon:"mdi-calendar",variant:"text"},r),null,16)]),default:f(()=>[h(le,{border:""},{default:f(()=>[h(ur,{modelValue:s.state.selectedDateObj,"onUpdate:modelValue":[e[2]||(e[2]=r=>s.state.selectedDateObj=r),i.handleDateSelect],"model-value":s.state.selectedDateObj,color:"primary"},null,8,["modelValue","model-value","onUpdate:modelValue"])]),_:1})]),_:1},8,["modelValue"]),h(E,{icon:"mdi-refresh",variant:"text",loading:s.loading.download,onClick:i.downloadData},null,8,["loading","onClick"]),h(E,{icon:"mdi-bell",variant:"text",badge:i.unreadCount||void 0,"badge-color":i.unreadCount?"error":void 0,onClick:e[4]||(e[4]=r=>n.$refs.messageLog.drawer=!0)},null,8,["badge","badge-color"]),h(E,{icon:"mdi-cog",variant:"text",onClick:e[5]||(e[5]=r=>n.$router.push("/settings"))})]),default:f(()=>[h(ta,null,{default:f(()=>[v(C(s.state.classNumber)+" - "+C(i.titleText),1)]),_:1}),h(Ce)]),_:1}),w("div",hr,[h(ga,{class:"main-window flex-grow-1 no-select",fluid:""},{default:f(()=>[w("div",fr,[h(Jt,{name:"grid"},{default:f(()=>[(T(!0),L(K,null,re(i.sortedItems,r=>(T(),L("div",{key:r.key,class:"grid-item",style:Gn({"grid-row-end":`span ${r.rowSpan}`,order:r.order})},[h(le,{border:"",height:"100%",class:"glow-track",onClick:c=>!i.isEditingDisabled&&i.openDialog(r.key),onMousemove:i.handleMouseMove,onTouchmove:i.handleTouchMove},{default:f(()=>[h(Se,null,{default:f(()=>[v(C(r.name),1)]),_:2},1024),h(oe,{style:Gn(s.state.contentStyle)},{default:f(()=>[w("div",{innerHTML:i.parsedContent(r.content),class:"markdown-content"},null,8,pr)]),_:2},1032,["style"])]),_:2},1032,["onClick","onMousemove","onTouchmove"])],4))),128))]),_:1})],512),w("div",mr,[i.emptySubjectDisplay==="button"?(T(),G(Wt,{key:0,divided:"",variant:"outlined"},{default:f(()=>[(T(!0),L(K,null,re(i.unusedSubjects,r=>(T(),G(E,{key:r.key,disabled:i.isEditingDisabled,onClick:c=>i.openDialog(r.key)},{default:f(()=>[h(ue,{start:""},{default:f(()=>e[21]||(e[21]=[v(" mdi-plus ")])),_:1}),v(" "+C(r.name),1)]),_:2},1032,["disabled","onClick"]))),128))]),_:1})):(T(),L("div",gr,[h(Jt,{name:"v-list"},{default:f(()=>[(T(!0),L(K,null,re(i.unusedSubjects,r=>(T(),G(le,{key:r.key,border:"",class:"empty-subject-card",disabled:i.isEditingDisabled,onClick:c=>i.openDialog(r.key)},{default:f(()=>[h(Se,{class:"text-subtitle-1"},{default:f(()=>[v(C(r.name),1)]),_:2},1024),h(oe,{class:"text-center"},{default:f(()=>[h(ue,{size:"small",color:"grey"},{default:f(()=>e[22]||(e[22]=[v(" mdi-plus ")])),_:1}),e[23]||(e[23]=w("div",{class:"text-caption text-grey"},"点击添加作业",-1))]),_:1})]),_:2},1032,["disabled","onClick"]))),128))]),_:1})]))]),s.state.synced?(T(),G(E,{key:1,color:"success",size:"large",onClick:i.showSyncMessage},{default:f(()=>e[25]||(e[25]=[v(" 同步完成 ")])),_:1},8,["onClick"])):(T(),G(E,{key:0,color:"error",size:"large",loading:s.loading.upload,class:"ml-2",onClick:i.manualUpload},{default:f(()=>e[24]||(e[24]=[v(" 上传 ")])),_:1},8,["loading","onClick"])),i.showRandomPickerButton?(T(),G(E,{key:2,color:"amber","prepend-icon":"mdi-account-question","append-icon":"mdi-dice-multiple",size:"large",class:"ml-2",onClick:i.openRandomPicker},{default:f(()=>e[26]||(e[26]=[v(" 随机点名 ")])),_:1},8,["onClick"])):te("",!0),i.showFullscreenButton?(T(),G(E,{key:3,color:s.state.isFullscreen?"blue-grey":"blue","prepend-icon":s.state.isFullscreen?"mdi-fullscreen-exit":"mdi-fullscreen",size:"large",class:"ml-2",onClick:i.toggleFullscreen},{default:f(()=>[v(C(s.state.isFullscreen?"退出全屏":"全屏显示"),1)]),_:1},8,["color","prepend-icon","onClick"])):te("",!0),i.showAntiScreenBurnCard?(T(),G(le,{key:4,border:"",class:"mt-4 anti-burn-card",color:"primary",variant:"tonal"},{default:f(()=>[h(Se,{class:"text-subtitle-1"},{default:f(()=>[h(ue,{start:"",icon:"mdi-shield-check",size:"small"}),e[27]||(e[27]=v(" 屏幕保护技术已启用 "))]),_:1}),h(oe,{class:"text-body-2"},{default:f(()=>e[28]||(e[28]=[w("p",null," 本应用采用独立自研的动态像素偏移技术(DPO™)，有效防止LCD屏幕烧屏现象。 ",-1),w("p",{class:"text-caption text-grey"},[v(" *研究显示动态像素偏移技术可以修复屏幕坏点，起到保护屏幕的作用，数据来自实验室。"),w("a",{href:"https://patentscope.wipo.int/search/zh/detail.jsf?docId=CN232281523&_cid=P20-M8L0YX-67061-1",target:"_blank"},"Patent CN108648692 ")],-1),w("p",{class:"text-caption text-grey"}," *技术已自动适配您的设备，无需手动调整 ",-1)])),_:1})]),_:1})):te("",!0)]),_:1}),s.state.studentList&&s.state.studentList.length?(T(),G(bt,{key:0,class:"attendance-area no-select",cols:"1",onClick:e[6]||(e[6]=r=>i.setAttendanceArea())},{default:f(()=>[e[39]||(e[39]=w("h1",null,"出勤",-1)),w("h2",null,[e[29]||(e[29]=w("span",{style:{"white-space":"nowrap"}}," 应到 ",-1)),e[30]||(e[30]=v(": ")),w("span",kr,C(s.state.studentList.length-s.state.boardData.attendance.exclude.length)+"人 ",1)]),w("h2",null,[e[31]||(e[31]=w("span",{style:{"white-space":"nowrap"}}," 实到 ",-1)),e[32]||(e[32]=v(": ")),w("span",br,C(s.state.studentList.length-s.state.boardData.attendance.absent.length-s.state.boardData.attendance.late.length-s.state.boardData.attendance.exclude.length)+"人 ",1)]),w("h2",null,[e[33]||(e[33]=w("span",{style:{"white-space":"nowrap"}}," 请假 ",-1)),e[34]||(e[34]=v(": ")),w("span",yr,C(s.state.boardData.attendance.absent.length)+"人 ",1)]),(T(!0),L(K,null,re(s.state.boardData.attendance.absent,(r,c)=>(T(),L("h3",{class:"gray-text",key:"absent-"+c},[s.useDisplay().lgAndUp.value?(T(),L("span",xr,C(`${c+1}. `),1)):te("",!0),w("span",vr,C(r),1)]))),128)),w("h2",null,[e[35]||(e[35]=w("span",{style:{"white-space":"nowrap"}},"迟到",-1)),e[36]||(e[36]=v(": ")),w("span",wr,C(s.state.boardData.attendance.late.length)+"人 ",1)]),(T(!0),L(K,null,re(s.state.boardData.attendance.late,(r,c)=>(T(),L("h3",{class:"gray-text",key:"late-"+c},[s.useDisplay().lgAndUp.value?(T(),L("span",Sr,C(`${c+1}. `),1)):te("",!0),w("span",Tr,C(r),1)]))),128)),w("h2",null,[e[37]||(e[37]=w("span",{style:{"white-space":"nowrap"}},"不参与",-1)),e[38]||(e[38]=v(": ")),w("span",_r,C(s.state.boardData.attendance.exclude.length)+"人 ",1)]),(T(!0),L(K,null,re(s.state.boardData.attendance.exclude,(r,c)=>(T(),L("h3",{class:"gray-text",key:"exclude-"+c},[s.useDisplay().lgAndUp.value?(T(),L("span",Dr,C(`${c+1}. `),1)):te("",!0),w("span",Ar,C(r),1)]))),128))]),_:1})):te("",!0)]),h(at,{modelValue:s.state.dialogVisible,"onUpdate:modelValue":e[11]||(e[11]=r=>s.state.dialogVisible=r),width:"500","onClick:outside":i.handleClose},{default:f(()=>[h(le,{border:""},{default:f(()=>[h(Se,null,{default:f(()=>[v(C(s.state.dialogTitle),1)]),_:1}),h(ka,null,{default:f(()=>[v(C(i.autoSave?"喵？喵呜！":"写完后点击上传谢谢喵"),1)]),_:1}),h(oe,null,{default:f(()=>[w("div",{ref:"inputRef",contenteditable:"true",class:ps(["homework-textarea pa-2 elevation-1 rounded",{"drag-over":s.isDragOver}]),style:{"min-height":"120px",border:"1px solid rgba(0,0,0,0.12)",outline:"none"},onInput:e[7]||(e[7]=(...r)=>i.handleContentEditableInput&&i.handleContentEditableInput(...r)),onDragover:e[8]||(e[8]=Wn((...r)=>i.handleDragOver&&i.handleDragOver(...r),["prevent"])),onDragleave:e[9]||(e[9]=Wn((...r)=>i.handleDragLeave&&i.handleDragLeave(...r),["prevent"])),onDrop:e[10]||(e[10]=(...r)=>i.handleTagDrop&&i.handleTagDrop(...r)),innerHTML:s.state.textarea},null,42,Cr),i.tagsEnabled?(T(),L("div",Er,[w("div",Rr,[h(ue,{icon:"mdi-tag-multiple",size:"small",class:"mr-2"}),e[40]||(e[40]=w("span",{class:"text-subtitle-2"},"可用标签",-1)),h(Qt,{location:"top",text:"拖拽标签到文本中"},{activator:f(({props:r})=>[h(ue,ce({icon:"mdi-help-circle-outline",size:"x-small",class:"ml-2"},r),null,16)]),_:1})]),w("div",Lr,[(T(!0),L(K,null,re(i.availableTags,r=>(T(),G(l,{key:r.id,id:r.id,text:r.text,color:r.color},null,8,["id","text","color"]))),128)),i.availableTags.length===0?(T(),L("div",Pr," 在设置中添加标签 ")):te("",!0)])])):te("",!0)]),_:1}),h(yt,null,{default:f(()=>[h(Ce),h(E,{color:"primary",onClick:i.handleClose,loading:s.loading.upload},{default:f(()=>e[41]||(e[41]=[v(" 保存 ")])),_:1},8,["onClick","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue","onClick:outside"]),h(fa,{modelValue:s.state.snackbar,"onUpdate:modelValue":e[12]||(e[12]=r=>s.state.snackbar=r),timeout:2e3},{default:f(()=>[v(C(s.state.snackbarText),1)]),_:1},8,["modelValue"]),h(at,{modelValue:s.state.attendanceDialog,"onUpdate:modelValue":[e[18]||(e[18]=r=>s.state.attendanceDialog=r),i.handleAttendanceDialogClose],"max-width":"900","fullscreen-breakpoint":"sm"},{default:f(()=>[h(le,null,{default:f(()=>[h(Se,{class:"d-flex align-center"},{default:f(()=>[h(ue,{icon:"mdi-account-group",class:"mr-2"}),e[42]||(e[42]=v(" 出勤状态管理 ")),h(Ce),h(Te,{color:"primary",size:"small",class:"ml-2"},{default:f(()=>[v(C(s.state.dateString),1)]),_:1})]),_:1}),h(oe,null,{default:f(()=>[h(Yt,{class:"mb-4"},{default:f(()=>[h(bt,{cols:"12",md:"12"},{default:f(()=>[h(Da,{modelValue:s.attendanceSearch,"onUpdate:modelValue":[e[13]||(e[13]=r=>s.attendanceSearch=r),n.handleSearchChange],"prepend-inner-icon":"mdi-magnify",label:"搜索学生",hint:"支持筛选姓氏，如输入'孙'可筛选所有姓孙的学生",variant:"outlined",clearable:""},null,8,["modelValue","onUpdate:modelValue"]),w("div",Mr,[(T(!0),L(K,null,re(i.extractedSurnames,r=>(T(),G(E,{key:r.name,variant:s.attendanceSearch===r.name?"elevated":"text",color:s.attendanceSearch===r.name?"primary":"",onClick:c=>s.attendanceSearch=s.attendanceSearch===r.name?"":r.name},{default:f(()=>[v(C(r.name)+" ("+C(r.count)+") ",1)]),_:2},1032,["variant","color","onClick"]))),128))])]),_:1})]),_:1}),w("div",Nr,[w("div",null,[h(Te,{value:"present",color:s.attendanceFilter.includes("present")?"success":"",variant:s.attendanceFilter.includes("present")?"elevated":"tonal",class:"px-2 filter-chip",onClick:e[14]||(e[14]=r=>i.toggleFilter("present")),"prepend-icon":"mdi-account-check","append-icon":s.attendanceFilter.includes("present")?"mdi-check":""},{default:f(()=>e[43]||(e[43]=[v(" 到课 ")])),_:1},8,["color","variant","append-icon"]),h(Te,{value:"absent",color:s.attendanceFilter.includes("absent")?"error":"",variant:s.attendanceFilter.includes("absent")?"elevated":"tonal",class:"px-2 filter-chip",onClick:e[15]||(e[15]=r=>i.toggleFilter("absent")),"prepend-icon":"mdi-account-off","append-icon":s.attendanceFilter.includes("absent")?"mdi-check":""},{default:f(()=>e[44]||(e[44]=[v(" 请假 ")])),_:1},8,["color","variant","append-icon"]),h(Te,{value:"late",color:s.attendanceFilter.includes("late")?"warning":"",variant:s.attendanceFilter.includes("late")?"elevated":"tonal",class:"px-2 filter-chip",onClick:e[16]||(e[16]=r=>i.toggleFilter("late")),"prepend-icon":"mdi-clock-alert","append-icon":s.attendanceFilter.includes("late")?"mdi-check":""},{default:f(()=>e[45]||(e[45]=[v(" 迟到 ")])),_:1},8,["color","variant","append-icon"]),h(Te,{value:"exclude",color:s.attendanceFilter.includes("exclude")?"grey":"",variant:s.attendanceFilter.includes("exclude")?"elevated":"tonal",class:"px-2 filter-chip",onClick:e[17]||(e[17]=r=>i.toggleFilter("exclude")),"prepend-icon":"mdi-account-cancel","append-icon":s.attendanceFilter.includes("exclude")?"mdi-check":""},{default:f(()=>e[46]||(e[46]=[v(" 不参与 ")])),_:1},8,["color","variant","append-icon"])])]),h(Yt,null,{default:f(()=>[(T(!0),L(K,null,re(i.filteredStudents,r=>(T(),G(bt,{key:r,cols:"12",sm:"6",md:"6",lg:"4"},{default:f(()=>[h(le,{class:"student-card",border:""},{default:f(()=>[h(oe,{class:"d-flex align-center pa-2"},{default:f(()=>[w("div",Or,[w("div",Ir,[h(ba,{color:i.getStudentStatusColor(s.state.studentList.indexOf(r)),size:"24",class:"mr-2"},{default:f(()=>[h(ue,{size:"small"},{default:f(()=>[v(C(i.getStudentStatusIcon(s.state.studentList.indexOf(r))),1)]),_:2},1024)]),_:2},1032,["color"]),w("div",zr,C(r),1)])]),w("div",Fr,[h(E,{color:i.isPresent(s.state.studentList.indexOf(r))?"success":"",icon:"mdi-account-check",size:"small",variant:"text",onClick:c=>i.setPresent(s.state.studentList.indexOf(r)),title:"设为到课"},null,8,["color","onClick"]),h(E,{color:i.isAbsent(s.state.studentList.indexOf(r))?"error":"",icon:"mdi-account-off",size:"small",variant:"text",onClick:c=>i.setAbsent(s.state.studentList.indexOf(r)),title:"设为请假"},null,8,["color","onClick"]),h(E,{color:i.isLate(s.state.studentList.indexOf(r))?"warning":"",icon:"mdi-clock-alert",size:"small",variant:"text",onClick:c=>i.setLate(s.state.studentList.indexOf(r)),title:"设为迟到"},null,8,["color","onClick"]),h(E,{color:i.isExclude(s.state.studentList.indexOf(r))?"grey":"",icon:"mdi-account-cancel",size:"small",variant:"text",onClick:c=>i.setExclude(s.state.studentList.indexOf(r)),title:"设为不参与"},null,8,["color","onClick"])])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1}),h(Yt,null,{default:f(()=>[h(bt,{cols:"12",md:"12"},{default:f(()=>[h(le,{variant:"tonal",color:"primary",class:"mb-4"},{default:f(()=>[h(oe,null,{default:f(()=>[e[51]||(e[51]=w("div",{class:"text-subtitle-2 mb-2"},"批量操作",-1)),h(Wt,null,{default:f(()=>[h(E,{color:"success","prepend-icon":"mdi-account-check",onClick:i.setAllPresent},{default:f(()=>e[47]||(e[47]=[v(" 全部到齐 ")])),_:1},8,["onClick"]),h(E,{color:"error","prepend-icon":"mdi-account-off",onClick:i.setAllAbsent},{default:f(()=>e[48]||(e[48]=[v(" 全部请假 ")])),_:1},8,["onClick"])]),_:1}),h(Wt,null,{default:f(()=>[h(E,{color:"warning","prepend-icon":"mdi-clock-alert",onClick:i.setAllLate},{default:f(()=>e[49]||(e[49]=[v(" 全部迟到 ")])),_:1},8,["onClick"]),h(E,{color:"grey","prepend-icon":"mdi-account-cancel",onClick:i.setAllExclude},{default:f(()=>e[50]||(e[50]=[v(" 全部不参与 ")])),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),h(xa),h(yt,null,{default:f(()=>[h(Ce),h(E,{color:"primary",onClick:i.saveAttendance},{default:f(()=>[h(ue,{start:""},{default:f(()=>e[52]||(e[52]=[v("mdi-content-save")])),_:1}),e[53]||(e[53]=v(" 保存 "))]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue","onUpdate:modelValue"]),h(o,{ref:"messageLog"},null,512),h(at,{modelValue:s.confirmDialog.show,"onUpdate:modelValue":e[19]||(e[19]=r=>s.confirmDialog.show=r),"max-width":"400"},{default:f(()=>[h(le,null,{default:f(()=>[h(Se,{class:"text-h6"},{default:f(()=>e[54]||(e[54]=[v(" 确认保存 ")])),_:1}),h(oe,null,{default:f(()=>[v(" 您正在修改 "+C(s.state.dateString)+" 的数据，确定要保存吗？ ",1)]),_:1}),h(yt,null,{default:f(()=>[h(Ce),h(E,{color:"grey",variant:"text",onClick:s.confirmDialog.reject},{default:f(()=>e[55]||(e[55]=[v(" 取消 ")])),_:1},8,["onClick"]),h(E,{color:"primary",onClick:s.confirmDialog.resolve},{default:f(()=>e[56]||(e[56]=[v(" 确认保存 ")])),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),h(d,{ref:"randomPicker","student-list":s.state.studentList,attendance:s.state.boardData.attendance},null,8,["student-list","attendance"]),h(at,{modelValue:s.urlConfigDialog.show,"onUpdate:modelValue":e[20]||(e[20]=r=>s.urlConfigDialog.show=r),"max-width":"500"},{default:f(()=>[h(le,null,{default:f(()=>[h(Se,{class:"text-h6"},{default:f(()=>e[57]||(e[57]=[v(" 确认应用URL配置 ")])),_:1}),h(oe,null,{default:f(()=>[e[58]||(e[58]=w("p",null,"以下配置将应用于当前班级：",-1)),h(va,{density:"compact"},{default:f(()=>[(T(!0),L(K,null,re(s.urlConfigDialog.changes,r=>(T(),G(wa,{key:r.key},{prepend:f(()=>[h(ue,{icon:r.icon,size:"small",class:"mr-2"},null,8,["icon"])]),default:f(()=>[h(Sa,{class:"d-flex align-center"},{default:f(()=>[w("span",Vr,C(r.name),1),h(Qt,{activator:"parent",location:"top"},{default:f(()=>[v(C(r.description||r.key),1)]),_:2},1024)]),_:2},1024),h(Ta,null,{default:f(()=>[w("span",Br,C(r.oldValue),1),h(ue,{icon:"mdi-arrow-right",size:"small",class:"mx-1"}),w("span",Ur,C(r.newValue),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}),h(yt,null,{default:f(()=>[h(Ce),h(E,{color:"grey",variant:"text",onClick:s.urlConfigDialog.cancelHandler},{default:f(()=>e[59]||(e[59]=[v(" 取消 ")])),_:1},8,["onClick"]),h(E,{color:"primary",onClick:s.urlConfigDialog.confirmHandler},{default:f(()=>e[60]||(e[60]=[v(" 确认应用 ")])),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}const Xr=fs(dr,[["render",Hr]]);export{Xr as default};
