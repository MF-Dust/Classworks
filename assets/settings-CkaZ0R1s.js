import{_ as K,f as C,o as w,w as s,c as n,q as H,i as d,v as E,j as L,aB as qe,aC as ct,aD as ht,h as v,a5 as pe,aE as Bt,n as U,l as D,k as x,x as Ce,a4 as wt,F as le,g as pt,p as ft,L as Le,b as Ft,ag as $t,e as zt,r as V,aF as Ht,t as Kt,y as fe,aG as Qt,aH as Wt,a1 as Je,aI as qt,J as Jt,aJ as Gt,aK as Yt,aL as Ae,z as Ge,W as Xt,aM as _e,a6 as gt,s as Ue,a7 as Zt}from"./index-Co3nJdql.js";import{l as Pe,a as ce,b as Z,g as Re,V as se,h as de,e as O,i as mt,k as bt,f as en,d as tn}from"./VRow-l3sFO9V_.js";import{f as P,g as X,d as ie,e as j,c as R,V as Be,i as Fe,a as xe}from"./VSpacer-Dk5eErFK.js";import{b as Ve,d as vt,a as yt,c as nn}from"./VTextarea-K6D8XG4p.js";import{a as ue,V as xt,f as sn,g as an}from"./VTextField-CYXbqfUk.js";import{f as on,a as St,H as rn,b as un,V as ln,p as Ye,g as dn,h as cn,u as hn,M as wn,c as pn,d as fn,e as Xe}from"./VSheet-C1lpgMpg.js";import{V as gn}from"./VAlert-D77jKsDK.js";import{V as mn,a as bn,b as vn,c as yn}from"./VExpansionPanels-BUC9Pv3j.js";import"./ssrBoot-gyfxiZHJ.js";const xn={name:"SettingsCard",props:{title:{type:String,required:!0},icon:{type:String,required:!0},loading:{type:Boolean,default:!1}}};function Sn(t,e,a,l,i,r){return w(),C(se,{elevation:"2",class:"settings-card rounded-lg"},{default:s(()=>[n(Pe,null,{prepend:s(()=>[n(L,{icon:a.icon,size:"large",class:"mr-2"},null,8,["icon"])]),default:s(()=>[n(ce,{class:"text-h6"},{default:s(()=>[d(E(a.title),1)]),_:1})]),_:1}),n(Z,null,{default:s(()=>[a.loading?(w(),C(ct,{key:0,indeterminate:"",color:"primary",class:"mb-4"})):H("",!0),qe(t.$slots,"default",{},void 0,!0)]),_:3}),t.$slots.actions?(w(),C(Re,{key:0,class:"pa-4"},{default:s(()=>[qe(t.$slots,"actions",{},void 0,!0)]),_:3})):H("",!0)]),_:3})}const he=K(xn,[["render",Sn],["__scopeId","data-v-3e8918ff"]]);var ye=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function kt(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function kn(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var _t=kn,_n=typeof ye=="object"&&ye&&ye.Object===Object&&ye,Cn=_n,Vn=Cn,Tn=typeof self=="object"&&self&&self.Object===Object&&self,Dn=Vn||Tn||Function("return this")(),Ct=Dn,En=Ct,In=function(){return En.Date.now()},jn=In,Nn=/\s/;function Mn(t){for(var e=t.length;e--&&Nn.test(t.charAt(e)););return e}var On=Mn,Ln=On,An=/^\s+/;function Un(t){return t&&t.slice(0,Ln(t)+1).replace(An,"")}var Pn=Un,Rn=Ct,Bn=Rn.Symbol,Vt=Bn,Ze=Vt,Tt=Object.prototype,Fn=Tt.hasOwnProperty,$n=Tt.toString,ve=Ze?Ze.toStringTag:void 0;function zn(t){var e=Fn.call(t,ve),a=t[ve];try{t[ve]=void 0;var l=!0}catch{}var i=$n.call(t);return l&&(e?t[ve]=a:delete t[ve]),i}var Hn=zn,Kn=Object.prototype,Qn=Kn.toString;function Wn(t){return Qn.call(t)}var qn=Wn,et=Vt,Jn=Hn,Gn=qn,Yn="[object Null]",Xn="[object Undefined]",tt=et?et.toStringTag:void 0;function Zn(t){return t==null?t===void 0?Xn:Yn:tt&&tt in Object(t)?Jn(t):Gn(t)}var es=Zn;function ts(t){return t!=null&&typeof t=="object"}var ns=ts,ss=es,is=ns,as="[object Symbol]";function os(t){return typeof t=="symbol"||is(t)&&ss(t)==as}var rs=os,us=Pn,nt=_t,ls=rs,st=NaN,ds=/^[-+]0x[0-9a-f]+$/i,cs=/^0b[01]+$/i,hs=/^0o[0-7]+$/i,ws=parseInt;function ps(t){if(typeof t=="number")return t;if(ls(t))return st;if(nt(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=nt(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=us(t);var a=cs.test(t);return a||hs.test(t)?ws(t.slice(2),a?2:8):ds.test(t)?st:+t}var fs=ps,gs=_t,Me=jn,it=fs,ms="Expected a function",bs=Math.max,vs=Math.min;function ys(t,e,a){var l,i,r,o,c,h,g=0,m=!1,S=!1,A=!0;if(typeof t!="function")throw new TypeError(ms);e=it(e)||0,gs(a)&&(m=!!a.leading,S="maxWait"in a,r=S?bs(it(a.maxWait)||0,e):r,A="trailing"in a?!!a.trailing:A);function T(y){var J=l,G=i;return l=i=void 0,g=y,o=t.apply(G,J),o}function B(y){return g=y,c=setTimeout(Y,e),m?T(y):o}function ee(y){var J=y-h,G=y-g,te=e-J;return S?vs(te,r-G):te}function ae(y){var J=y-h,G=y-g;return h===void 0||J>=e||J<0||S&&G>=r}function Y(){var y=Me();if(ae(y))return q(y);c=setTimeout(Y,ee(y))}function q(y){return c=void 0,A&&l?T(y):(l=i=void 0,o)}function re(){c!==void 0&&clearTimeout(c),g=0,l=h=i=c=void 0}function F(){return c===void 0?o:q(Me())}function $(){var y=Me(),J=ae(y);if(l=arguments,i=this,h=y,J){if(c===void 0)return B(h);if(S)return clearTimeout(c),c=setTimeout(Y,e),T(h)}return c===void 0&&(c=setTimeout(Y,e)),o}return $.cancel=re,$.flush=F,$}var xs=ys;const Ss=kt(xs),ks={name:"SettingItem",props:{settingKey:{type:String,required:!0},icon:{type:String,default:null},disabled:{type:Boolean,default:!1},title:{type:String,default:null},description:{type:String,default:null}},data(){return{localValue:null,inputValue:null,debouncedUpdateSetting:null,definition:null,type:null,selectOptions:[],hasOptions:!1,minValue:0,maxValue:100,stepValue:1,showSnackbar:!1,snackbarText:"",fontFamilies:[{title:"Arial",value:"Arial, sans-serif"},{title:"Calibri",value:"Calibri, sans-serif"},{title:"Cambria",value:"Cambria, serif"},{title:"Consolas",value:"Consolas, monospace"},{title:"Courier New",value:"Courier New, monospace"},{title:"Georgia",value:"Georgia, serif"},{title:"Helvetica",value:"Helvetica, sans-serif"},{title:"Segoe UI",value:"Segoe UI, sans-serif"},{title:"Times New Roman",value:"Times New Roman, serif"},{title:"Trebuchet MS",value:"Trebuchet MS, sans-serif"},{title:"Verdana",value:"Verdana, sans-serif"},{title:"Monospace",value:"monospace"},{title:"Sans-serif",value:"sans-serif"},{title:"Serif",value:"serif"}],displayValueMappings:{"display.emptySubjectDisplay":{card:"卡片",button:"按钮"},"theme.mode":{light:"浅色",dark:"深色"},"server.provider":{server:"远程服务器",indexedDB:"本地存储"}},defaultIcons:{boolean:"mdi-toggle-switch-outline",number:"mdi-numeric",string:"mdi-form-textbox"}}},computed:{displayTitle(){if(this.title)return this.title;if(this.definition&&this.definition.description)return this.definition.description;const t=this.settingKey.split(".");return t[t.length-1]},displayDescription(){return this.description?this.description:this.settingKey},isFontFamily(){return this.settingKey.toLowerCase().includes("fontfamily")||this.settingKey.toLowerCase().includes("font.family")},isDefaultValue(){return this.definition?typeof this.localValue=="object"&&this.localValue!==null?JSON.stringify(this.localValue)===JSON.stringify(this.definition.default):this.localValue===this.definition.default:!0},settingIcon(){return this.icon?this.icon:this.definition&&this.definition.icon?this.definition.icon:this.defaultIcons[this.type]||"mdi-cog-outline"}},created(){this.debouncedUpdateSetting=Ss(this.performUpdateSetting,300),this.loadSetting()},methods:{loadSetting(){if(this.definition=Bt(this.settingKey),!this.definition){console.error(`未找到设置项定义: ${this.settingKey}`);return}if(this.type=this.definition.type,this.localValue=v(this.settingKey),this.inputValue=this.localValue,this.type==="string"){if(this.isFontFamily)this.selectOptions=this.fontFamilies,this.hasOptions=!0;else if(this.settingKey in this.displayValueMappings){const t=this.displayValueMappings[this.settingKey];this.selectOptions=Object.entries(t).map(([e,a])=>({title:a,value:e})),this.hasOptions=!0}else if(this.definition.validate){const e=this.definition.validate.toString().match(/\[(.*?)\]/);if(e){const l=e[1].split(",").map(i=>{const r=i.trim().replace(/['"]/g,"");return{title:this.getDisplayValue(r)||r,value:r}});l.length>0&&(this.selectOptions=l,this.hasOptions=!0)}}}if(this.type==="number"&&this.definition.validate){const t=this.definition.validate.toString(),e=t.match(/value\s*>=\s*(\d+)/);e&&(this.minValue=Number(e[1]));const a=t.match(/value\s*<=\s*(\d+)/);a&&(this.maxValue=Number(a[1]));const l=this.maxValue-this.minValue;l>100?this.stepValue=10:l>20?this.stepValue=5:l>10?this.stepValue=2:this.stepValue=1}},getDisplayValue(t){return this.settingKey in this.displayValueMappings&&this.displayValueMappings[this.settingKey][t]||t},performUpdateSetting(t){console.log(`[SettingItem Debug] Debounced performUpdateSetting triggered for ${this.settingKey}. Input Value:`,t,`(Type: ${typeof t}), Current Confirmed Value (localValue): ${this.localValue} (Type: ${typeof this.localValue})`);let e,a=!0;switch(this.type){case"boolean":e=!!t;break;case"number":let i=Number(t);if(isNaN(i))console.warn(`[SettingItem Debug] Invalid number input for ${this.settingKey}:`,t,". Will revert."),a=!1;else{let r=this.minValue,o=this.maxValue;if(this.definition&&this.definition.validate){const c=this.definition.validate.toString(),h=c.match(/value\s*>=\s*(\d+(\.\d+)?)/),g=c.match(/value\s*<=\s*(\d+(\.\d+)?)/);h&&(r=Number(h[1])),g&&(o=Number(g[1]))}e=Math.max(r,Math.min(o,i)),console.log(`[SettingItem Debug] Clamped number for ${this.settingKey}: ${e}`)}break;case"string":e=String(t);break;default:e=t}if(!a){console.warn(`[SettingItem Debug] Input (${t}) is invalid for ${this.settingKey}. Reverting input field.`),this.$nextTick(()=>{this.inputValue!==this.localValue&&(console.log(`[SettingItem Debug] Forcing inputValue revert from ${this.inputValue} to confirmed value ${this.localValue} in nextTick due to invalid input.`),this.inputValue=this.localValue)});return}let l=!1;typeof this.localValue=="object"&&this.localValue!==null?l=JSON.stringify(e)!==JSON.stringify(this.localValue):l=e!==this.localValue,l?(console.log(`[SettingItem Debug] Value changed from ${this.localValue} to ${e}. Attempting to save ${this.settingKey}.`),pe(this.settingKey,e)?(console.log(`[SettingItem Debug] Setting ${this.settingKey} saved successfully.`),this.localValue=e,this.$nextTick(()=>{this.inputValue!==this.localValue&&(console.log(`[SettingItem Debug] Syncing inputValue (${this.inputValue}) to newly saved localValue (${this.localValue}) in nextTick after successful save.`),this.inputValue=this.localValue)}),this.$emit("update",this.settingKey,this.localValue)):(console.warn(`[SettingItem Debug] Setting ${this.settingKey} failed to save. Reverting input field.`),this.$emit("error",this.settingKey),this.$nextTick(()=>{this.inputValue!==this.localValue&&(console.log(`[SettingItem Debug] Forcing inputValue (${this.inputValue}) revert to confirmed localValue (${this.localValue}) in nextTick after failed save.`),this.inputValue=this.localValue)}))):(console.log(`[SettingItem Debug] Processed value (${e}) is same as confirmed value (${this.localValue}). No save needed.`),this.$nextTick(()=>{this.inputValue!==this.localValue&&(console.log(`[SettingItem Debug] Processed value same, but raw input might differ. Syncing inputValue (${this.inputValue}) to confirmed localValue (${this.localValue}) in nextTick.`),this.inputValue=this.localValue)}))},adjustValue(t){if(this.type!=="number")return;const e=Number(this.localValue)+t,a=Math.max(this.minValue,Math.min(this.maxValue,e));this.inputValue!==a&&(this.inputValue=a),this.debouncedUpdateSetting(a)},copySettingId(){navigator.clipboard.writeText(this.settingKey).then(()=>{this.showSnackbarMessage("设置ID已复制到剪贴板")}).catch(t=>{console.error("复制失败:",t)})},copySettingValue(){let t="";typeof this.localValue=="object"&&this.localValue!==null?t=JSON.stringify(this.localValue):t=String(this.localValue),navigator.clipboard.writeText(t).then(()=>{this.showSnackbarMessage("设置值已复制到剪贴板")}).catch(e=>{console.error("复制失败:",e)})},resetToDefault(){this.definition&&(ht(this.settingKey),this.localValue=v(this.settingKey),this.inputValue=this.localValue,this.showSnackbarMessage("已重置为默认值"),this.$emit("update",this.settingKey,this.localValue))},showSnackbarMessage(t){this.snackbarText=t,this.showSnackbar=!0}}},_s={class:"text-caption text-grey-darken-1"},Cs={class:"d-flex flex-column flex-sm-row align-center"},Vs={class:"me-2"},Ts={key:2,class:"d-flex align-center"};function Ds(t,e,a,l,i,r){return w(),U(le,null,[n(j,{class:"setting-item",disabled:a.disabled},{prepend:s(()=>[n(L,{icon:r.settingIcon},null,8,["icon"])]),append:s(()=>[D("div",Cs,[D("div",Vs,[i.type==="boolean"?(w(),C(Ve,{key:0,modelValue:i.inputValue,"onUpdate:modelValue":[e[0]||(e[0]=o=>i.inputValue=o),i.debouncedUpdateSetting],density:"comfortable","hide-details":"",disabled:a.disabled},null,8,["modelValue","disabled","onUpdate:modelValue"])):i.type==="string"&&i.hasOptions?(w(),C(vt,{key:1,modelValue:i.inputValue,"onUpdate:modelValue":[e[1]||(e[1]=o=>i.inputValue=o),i.debouncedUpdateSetting],items:i.selectOptions,density:"compact","hide-details":"",disabled:a.disabled,class:"setting-select",variant:"outlined","bg-color":"surface","item-title":"title","item-value":"value"},null,8,["modelValue","items","disabled","onUpdate:modelValue"])):i.type==="number"?(w(),U("div",Ts,[n(x,{icon:"mdi-minus",size:"small",variant:"text",disabled:a.disabled||i.localValue<=i.minValue,onClick:e[2]||(e[2]=o=>r.adjustValue(-i.stepValue))},null,8,["disabled"]),n(ue,{modelValue:i.inputValue,"onUpdate:modelValue":[e[3]||(e[3]=o=>i.inputValue=o),i.debouncedUpdateSetting],modelModifiers:{number:!0},type:"number",density:"compact","hide-details":"",min:i.minValue,max:i.maxValue,step:i.stepValue,disabled:a.disabled,class:"mx-2 setting-number-field",style:{width:"80px"},variant:"outlined","bg-color":"surface"},null,8,["modelValue","min","max","step","disabled","onUpdate:modelValue"]),n(x,{icon:"mdi-plus",size:"small",variant:"text",disabled:a.disabled||i.localValue>=i.maxValue,onClick:e[4]||(e[4]=o=>r.adjustValue(i.stepValue))},null,8,["disabled"])])):i.type==="string"&&!i.hasOptions?(w(),C(ue,{key:3,modelValue:i.inputValue,"onUpdate:modelValue":[e[5]||(e[5]=o=>i.inputValue=o),i.debouncedUpdateSetting],density:"compact","hide-details":"",disabled:a.disabled,class:"setting-text-field",variant:"outlined","bg-color":"surface"},null,8,["modelValue","disabled","onUpdate:modelValue"])):H("",!0)]),n(xt,{location:"bottom"},{activator:s(({props:o})=>[n(x,Ce({icon:"mdi-dots-vertical",size:"small",variant:"text"},o,{class:"ml-2",disabled:a.disabled}),null,16,["disabled"])]),default:s(()=>[n(ie,{density:"compact"},{default:s(()=>[n(j,{onClick:r.copySettingId},{prepend:s(()=>[n(L,{icon:"mdi-key",size:"small"})]),default:s(()=>[n(P,null,{default:s(()=>e[7]||(e[7]=[d("复制设置ID")])),_:1})]),_:1},8,["onClick"]),n(j,{onClick:r.copySettingValue},{prepend:s(()=>[n(L,{icon:"mdi-content-copy",size:"small"})]),default:s(()=>[n(P,null,{default:s(()=>e[8]||(e[8]=[d("复制设置值")])),_:1})]),_:1},8,["onClick"]),n(R),n(j,{onClick:r.resetToDefault,disabled:r.isDefaultValue},{prepend:s(()=>[n(L,{icon:"mdi-restore",size:"small"})]),default:s(()=>[n(P,null,{default:s(()=>e[9]||(e[9]=[d("重置为默认值")])),_:1})]),_:1},8,["onClick","disabled"])]),_:1})]),_:1})])]),default:s(()=>[n(P,{class:"text-wrap"},{default:s(()=>[d(E(r.displayTitle),1)]),_:1}),n(X,{class:"d-flex align-center text-wrap"},{default:s(()=>[D("span",_s,E(a.settingKey),1)]),_:1})]),_:1},8,["disabled"]),n(wt,{modelValue:i.showSnackbar,"onUpdate:modelValue":e[6]||(e[6]=o=>i.showSnackbar=o),timeout:2e3,color:"success",location:"top"},{default:s(()=>[d(E(i.snackbarText),1)]),_:1},8,["modelValue"])],64)}const Te=K(ks,[["render",Ds],["__scopeId","data-v-e60ecea2"]]),Es=ft({...zt(),...an()},"VForm"),Dt=pt()({name:"VForm",props:Es(),emits:{"update:modelValue":t=>!0,submit:t=>!0},setup(t,e){let{slots:a,emit:l}=e;const i=sn(t),r=Le();function o(h){h.preventDefault(),i.reset()}function c(h){const g=h,m=i.validate();g.then=m.then.bind(m),g.catch=m.catch.bind(m),g.finally=m.finally.bind(m),l("submit",g),g.defaultPrevented||m.then(S=>{var T;let{valid:A}=S;A&&((T=r.value)==null||T.submit())}),g.preventDefault()}return Ft(()=>{var h;return n("form",{ref:r,class:["v-form",t.class],style:t.style,novalidate:!0,onReset:o,onSubmit:c},[(h=a.default)==null?void 0:h.call(a,i)])}),$t(i,r)}}),Is={name:"ServerSettingsCard",components:{SettingsCard:he,SettingItem:Te},props:{loading:Boolean}};function js(t,e,a,l,i,r){const o=V("setting-item"),c=V("settings-card");return w(),C(c,{title:"数据源设置",icon:"mdi-database",loading:a.loading},{default:s(()=>[n(Dt,null,{default:s(()=>[n(o,{"setting-key":"server.provider",title:"数据提供者"}),n(R,{class:"my-2"}),n(o,{"setting-key":"server.domain",title:"服务器域名"}),e[0]||(e[0]=d()),n(R,{class:"my-2"}),n(o,{"setting-key":"server.classNumber",title:"班号"})]),_:1})]),_:1},8,["loading"])}const Ns=K(Is,[["render",js]]),Ms={};function Os(t,e,a,l,i,r){const o=V("setting-item"),c=V("settings-card");return w(),C(c,{title:"编辑设置",icon:"mdi-cog"},{default:s(()=>[n(ie,null,{default:s(()=>[n(o,{"setting-key":"edit.autoSave"}),n(R,{class:"my-2"}),n(o,{"setting-key":"edit.blockNonTodayAutoSave"}),n(R,{class:"my-2"}),n(o,{"setting-key":"edit.confirmNonTodaySave"}),n(R,{class:"my-2"}),n(o,{"setting-key":"edit.refreshBeforeEdit"})]),_:1})]),_:1})}const Ls=K(Ms,[["render",Os]]),As={name:"RefreshSettingsCard",components:{SettingsCard:he,SettingItem:Te},data(){return{}}};function Us(t,e,a,l,i,r){const o=V("setting-item"),c=V("settings-card");return w(),C(c,{title:"刷新设置",icon:"mdi-refresh-circle"},{default:s(()=>[n(Dt,null,{default:s(()=>[n(ie,null,{default:s(()=>[n(o,{"setting-key":"refresh.auto",title:"自动刷新"}),e[0]||(e[0]=d()),n(R,{class:"my-2"}),n(o,{"setting-key":"refresh.interval",title:"刷新间隔"})]),_:1})]),_:1})]),_:1})}const Ps=K(As,[["render",Us]]),Rs={name:"DisplaySettingsCard",components:{SettingsCard:he,SettingItem:Te},data(){return{}}};function Bs(t,e,a,l,i,r){const o=V("setting-item"),c=V("settings-card");return w(),C(c,{title:"显示设置",icon:"mdi-monitor",border:""},{default:s(()=>[n(ie,null,{default:s(()=>[n(o,{"setting-key":"display.emptySubjectDisplay"}),n(R,{class:"my-2"}),n(o,{"setting-key":"display.dynamicSort"}),n(R,{class:"my-2"}),n(o,{"setting-key":"display.showRandomButton"}),n(R,{class:"my-2"}),n(o,{"setting-key":"display.showFullscreenButton"}),n(R,{class:"my-2"}),n(o,{"setting-key":"display.cardHoverEffect"}),n(R,{class:"my-2"}),n(o,{"setting-key":"display.enhancedTouchMode"}),n(R,{class:"my-2"}),n(o,{"setting-key":"display.showAntiScreenBurnCard"})]),_:1})]),_:1})}const Fs=K(Rs,[["render",Bs]]),$s={name:"DataProviderSettingsCard",components:{SettingsCard:he},data(){return{loading:!1,serverchecktime:{},confirmDialog:!1,confirmTitle:"",confirmMessage:"",confirmAction:null}},computed:{currentProvider(){return v("server.provider")}},methods:{async checkServerConnection(){this.loading=!0,this.serverchecktime=new Date;try{const t=v("server.domain");if((await on.get(`${t}/api/test`,{method:"GET",headers:{Accept:"application/json"}})).data.status==="success")this.$message.success("连接成功","服务器连接正常 延迟"+(new Date-this.serverchecktime)+"ms");else throw new Error("服务器响应异常")}catch(t){this.$message.error("连接失败",t.message||"无法连接到服务器")}finally{this.loading=!1}},confirmClearLocalStorage(){this.confirmTitle="确认清除",this.confirmMessage="此操作将清除所有本地存储的数据，确定要继续吗？",this.confirmAction=this.clearLocalStorage,this.confirmDialog=!0},clearLocalStorage(){try{localStorage.clear(),this.$message.success("清除成功","本地存储数据已清除"),this.confirmDialog=!1}catch(t){this.$message.error("清除失败",t.message)}},confirmClearIndexedDB(){this.confirmTitle="确认清除",this.confirmMessage="此操作将清除所有IndexedDB中的数据，确定要继续吗？",this.confirmAction=this.clearIndexedDB,this.confirmDialog=!0},async clearIndexedDB(){try{await window.indexedDB.deleteDatabase("ClassworksDB"),this.$message.success("清除成功","数据库缓存已清除"),this.confirmDialog=!1}catch(t){this.$message.error("清除失败",t.message)}},async exportData(){try{const t="ClassworksDB",e={indexedDB:{}},a=await new Promise((h,g)=>{const m=window.indexedDB.open(t);m.onerror=()=>g(m.error),m.onsuccess=()=>h(m.result)}),l=Array.from(a.objectStoreNames);for(const h of l){const m=a.transaction(h,"readonly").objectStore(h),S=await new Promise((A,T)=>{const B=m.getAll();B.onerror=()=>T(B.error),B.onsuccess=()=>A(B.result)});e.indexedDB[h]=S}const i=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),r=URL.createObjectURL(i),o=document.createElement("a"),c=new Date().toISOString().split("T")[0];o.href=r,o.download=`homework-indexeddb-${c}.json`,o.click(),URL.revokeObjectURL(r),this.$message.success("导出成功","IndexedDB数据已导出")}catch(t){console.error("导出失败:",t),this.$message.error("导出失败",t.message||"无法导出数据库数据")}},handleConfirm(){this.confirmAction&&this.confirmAction()}}};function zs(t,e,a,l,i,r){const o=V("settings-card");return w(),C(o,{title:"数据源设置",icon:"mdi-database-cog"},{default:s(()=>[n(ie,null,{default:s(()=>[r.currentProvider==="server"?(w(),C(j,{key:0},{prepend:s(()=>[n(L,{icon:"mdi-lan-connect",class:"mr-3"})]),append:s(()=>[n(x,{loading:i.loading,variant:"tonal",onClick:r.checkServerConnection},{default:s(()=>e[3]||(e[3]=[d(" 测试连接 ")])),_:1},8,["loading","onClick"])]),default:s(()=>[n(P,null,{default:s(()=>e[2]||(e[2]=[d("检查服务器连接")])),_:1})]),_:1})):H("",!0),r.currentProvider==="indexedDB"?(w(),U(le,{key:1},[n(j,null,{prepend:s(()=>[n(L,{icon:"mdi-database",class:"mr-3"})]),append:s(()=>[n(x,{color:"error",variant:"tonal",onClick:r.confirmClearIndexedDB},{default:s(()=>e[6]||(e[6]=[d(" 清除 ")])),_:1},8,["onClick"])]),default:s(()=>[n(P,null,{default:s(()=>e[4]||(e[4]=[d("清除数据库缓存")])),_:1}),n(X,null,{default:s(()=>e[5]||(e[5]=[d("这将清除所有IndexedDB中的数据")])),_:1})]),_:1}),n(j,null,{prepend:s(()=>[n(L,{icon:"mdi-database-export",class:"mr-3"})]),append:s(()=>[n(x,{variant:"tonal",onClick:r.exportData},{default:s(()=>e[8]||(e[8]=[d(" 导出 ")])),_:1},8,["onClick"])]),default:s(()=>[n(P,null,{default:s(()=>e[7]||(e[7]=[d("导出数据库")])),_:1})]),_:1})],64)):H("",!0),n(j,null,{prepend:s(()=>[n(L,{icon:"mdi-lan-connect",class:"mr-3"})]),append:s(()=>[n(x,{variant:"tonal",to:"/cachemanagement"},{default:s(()=>e[10]||(e[10]=[d(" 查看 ")])),_:1})]),default:s(()=>[n(P,null,{default:s(()=>e[9]||(e[9]=[d("查看本地缓存")])),_:1})]),_:1}),e[13]||(e[13]=d()),n(j,null,{prepend:s(()=>[n(L,{icon:"mdi-lan-connect",class:"mr-3"})]),append:s(()=>[n(x,{variant:"tonal",to:"/cses2wakeup"},{default:s(()=>e[12]||(e[12]=[d(" 查看 ")])),_:1})]),default:s(()=>[n(P,null,{default:s(()=>e[11]||(e[11]=[d("CSES转WakeUP工具")])),_:1})]),_:1})]),_:1}),n(St,{modelValue:i.confirmDialog,"onUpdate:modelValue":e[1]||(e[1]=c=>i.confirmDialog=c),"max-width":"400"},{default:s(()=>[n(se,null,{default:s(()=>[n(ce,null,{default:s(()=>[d(E(i.confirmTitle),1)]),_:1}),n(Z,null,{default:s(()=>[d(E(i.confirmMessage),1)]),_:1}),n(Re,null,{default:s(()=>[n(Be),n(x,{color:"grey",variant:"text",onClick:e[0]||(e[0]=c=>i.confirmDialog=!1)},{default:s(()=>e[14]||(e[14]=[d("取消")])),_:1}),n(x,{color:"error",variant:"tonal",onClick:r.handleConfirm},{default:s(()=>e[15]||(e[15]=[d("确认")])),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}const Hs=K($s,[["render",zs]]),Ks={name:"ThemeSettingsCard",components:{SettingsCard:he},data(){return{localTheme:v("theme.mode")}},watch:{localTheme(t){pe("theme.mode",t),this.updateTheme(t)}},setup(){return{theme:Ht()}},methods:{updateTheme(t){this.theme.global.name.value=t}}};function Qs(t,e,a,l,i,r){const o=V("settings-card");return w(),C(o,{title:"主题设置",icon:"mdi-palette"},{default:s(()=>[n(ie,null,{default:s(()=>[n(j,null,{prepend:s(()=>[n(L,{icon:"mdi-theme-light-dark",class:"mr-3"})]),append:s(()=>[n(Kt,{modelValue:i.localTheme,"onUpdate:modelValue":e[0]||(e[0]=c=>i.localTheme=c),density:"comfortable",color:"primary"},{default:s(()=>[n(x,{value:"light"},{default:s(()=>[n(L,{icon:"mdi-white-balance-sunny",class:"mr-2"}),e[3]||(e[3]=d(" 明亮 "))]),_:1}),n(x,{value:"dark"},{default:s(()=>[n(L,{icon:"mdi-moon-waning-crescent",class:"mr-2"}),e[4]||(e[4]=d(" 暗黑 "))]),_:1})]),_:1},8,["modelValue"])]),default:s(()=>[n(P,null,{default:s(()=>e[1]||(e[1]=[d("主题模式")])),_:1}),n(X,null,{default:s(()=>e[2]||(e[2]=[d("选择明亮或暗黑主题")])),_:1})]),_:1})]),_:1})]),_:1})}const Ws=K(Ks,[["render",Qs]]),z=[];for(let t=0;t<256;++t)z.push((t+256).toString(16).slice(1));function qs(t,e=0){return(z[t[e+0]]+z[t[e+1]]+z[t[e+2]]+z[t[e+3]]+"-"+z[t[e+4]]+z[t[e+5]]+"-"+z[t[e+6]]+z[t[e+7]]+"-"+z[t[e+8]]+z[t[e+9]]+"-"+z[t[e+10]]+z[t[e+11]]+z[t[e+12]]+z[t[e+13]]+z[t[e+14]]+z[t[e+15]]).toLowerCase()}let Oe;const Js=new Uint8Array(16);function Gs(){if(!Oe){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Oe=crypto.getRandomValues.bind(crypto)}return Oe(Js)}const Ys=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),at={randomUUID:Ys};function Xs(t,e,a){var i;if(at.randomUUID&&!t)return at.randomUUID();t=t||{};const l=t.random??((i=t.rng)==null?void 0:i.call(t))??Gs();if(l.length<16)throw new Error("Random bytes length must be >= 16");return l[6]=l[6]&15|64,l[8]=l[8]&63|128,qs(l)}const Zs={name:"TagManagementCard",components:{SettingsCard:he,HomeworkTag:rn},data(){return{settings:{tags:{enabled:v("tags.enabled")||!1,list:v("tags.list")||[]}},newTag:{text:"",color:"primary"},isEditing:!1,editingTagId:null,colorOptions:[{title:"主色调",value:"primary"},{title:"成功",value:"success"},{title:"信息",value:"info"},{title:"警告",value:"warning"},{title:"错误",value:"error"},{title:"紫色",value:"purple"},{title:"深蓝",value:"indigo"},{title:"橙色",value:"orange"},{title:"粉色",value:"pink"}]}},methods:{saveSettings(){pe("tags.enabled",this.settings.tags.enabled),pe("tags.list",this.settings.tags.list),this.$emit("saved")},addTag(){if(this.newTag.text){if(this.isEditing&&this.editingTagId){const t=this.settings.tags.list.findIndex(e=>e.id===this.editingTagId);t!==-1&&(this.settings.tags.list[t].text=this.newTag.text,this.settings.tags.list[t].color=this.newTag.color,this.saveSettings()),this.isEditing=!1,this.editingTagId=null}else{const t={id:Xs(),text:this.newTag.text,color:this.newTag.color};this.settings.tags.list.push(t),this.saveSettings()}this.newTag.text="",this.newTag.color="primary"}},removeTag(t){this.settings.tags.list=this.settings.tags.list.filter(e=>e.id!==t),this.saveSettings(),this.editingTagId===t&&(this.isEditing=!1,this.editingTagId=null,this.newTag.text="",this.newTag.color="primary")},editTag(t){this.isEditing=!0,this.editingTagId=t.id,this.newTag.text=t.text,this.newTag.color=t.color},cancelEdit(){this.isEditing=!1,this.editingTagId=null,this.newTag.text="",this.newTag.color="primary"}}},ei={key:0},ti={class:"d-flex flex-wrap gap-2 mb-3"},ni={key:0,class:"text-caption text-grey pa-2"},si={class:"d-flex align-center"};function ii(t,e,a,l,i,r){const o=V("homework-tag"),c=V("settings-card");return w(),C(c,{title:"作业标签管理",icon:"mdi-tag-multiple"},{default:s(()=>[n(ie,null,{default:s(()=>[n(j,null,{prepend:s(()=>[n(L,{icon:"mdi-tag-plus",class:"mr-3"})]),append:s(()=>[n(Ve,{modelValue:i.settings.tags.enabled,"onUpdate:modelValue":e[0]||(e[0]=h=>i.settings.tags.enabled=h),density:"comfortable","hide-details":"",onChange:r.saveSettings},null,8,["modelValue","onChange"])]),default:s(()=>[n(P,null,{default:s(()=>e[3]||(e[3]=[d("启用作业标签")])),_:1}),n(X,null,{default:s(()=>e[4]||(e[4]=[d("启用后可以为作业添加标签")])),_:1})]),_:1}),n(Fe,null,{default:s(()=>[i.settings.tags.enabled?(w(),U("div",ei,[n(R,{class:"my-2"}),n(j,null,{default:s(()=>[n(P,null,{default:s(()=>e[5]||(e[5]=[d("标签管理")])),_:1}),n(X,null,{default:s(()=>e[6]||(e[6]=[d("添加、编辑或删除作业标签")])),_:1})]),_:1}),n(j,null,{default:s(()=>[n(de,null,{default:s(()=>[n(O,{cols:"12"},{default:s(()=>[n(un,{class:"pa-4 mb-3",rounded:"",border:""},{default:s(()=>[D("div",ti,[(w(!0),U(le,null,fe(i.settings.tags.list,h=>(w(),U("div",{key:h.id,class:"d-flex align-center"},[n(o,{id:h.id,text:h.text,color:h.color,"show-remove":!0,onRemove:g=>r.removeTag(h.id),onClick:g=>r.editTag(h)},null,8,["id","text","color","onRemove","onClick"]),n(ln,{location:"top",text:"点击标签进行编辑"},{activator:s(({props:g})=>[n(L,Ce({icon:"mdi-pencil-outline",size:"x-small",class:"ml-1",ref_for:!0},g,{onClick:m=>r.editTag(h)}),null,16,["onClick"])]),_:2},1024)]))),128)),i.settings.tags.list.length===0?(w(),U("div",ni," 暂无标签，请添加新标签 ")):H("",!0)])]),_:1})]),_:1})]),_:1})]),_:1}),n(j,null,{default:s(()=>[n(de,null,{default:s(()=>[n(O,{cols:"12",md:"6"},{default:s(()=>[n(ue,{modelValue:i.newTag.text,"onUpdate:modelValue":e[1]||(e[1]=h=>i.newTag.text=h),label:"标签文本",placeholder:"输入标签文本",variant:"outlined",density:"comfortable","hide-details":""},null,8,["modelValue"])]),_:1}),n(O,{cols:"12",md:"6"},{default:s(()=>[n(vt,{modelValue:i.newTag.color,"onUpdate:modelValue":e[2]||(e[2]=h=>i.newTag.color=h),label:"标签颜色",items:i.colorOptions,variant:"outlined",density:"comfortable","hide-details":""},{selection:s(({item:h})=>[D("div",si,[D("div",{class:"mr-2",style:Je([{width:"16px",height:"16px","border-radius":"4px"},{backgroundColor:`rgb(var(--v-theme-${h.value}))`}])},null,4),d(" "+E(h.title),1)])]),item:s(({item:h,props:g})=>[n(j,Qt(Wt(g)),{prepend:s(()=>[D("div",{style:Je([{width:"16px",height:"16px","border-radius":"4px"},{backgroundColor:`rgb(var(--v-theme-${h.value}))`}])},null,4)]),default:s(()=>[n(P,null,{default:s(()=>[d(E(h.title),1)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","items"])]),_:1}),n(O,{cols:"12",class:"d-flex justify-end gap-2"},{default:s(()=>[i.isEditing?(w(),C(x,{key:0,color:"secondary","prepend-icon":"mdi-close",onClick:r.cancelEdit},{default:s(()=>e[7]||(e[7]=[d(" 取消编辑 ")])),_:1},8,["onClick"])):H("",!0),n(x,{color:"primary","prepend-icon":i.isEditing?"mdi-content-save":"mdi-plus",onClick:r.addTag,disabled:!i.newTag.text},{default:s(()=>[d(E(i.isEditing?"保存修改":"添加标签"),1)]),_:1},8,["prepend-icon","onClick","disabled"])]),_:1})]),_:1})]),_:1})])):H("",!0)]),_:1})]),_:1})]),_:1})}const ai=K(Zs,[["render",ii],["__scopeId","data-v-fbe6a721"]]);var Et={exports:{}};(function(t,e){(function(a,l){t.exports=l()})(typeof self<"u"?self:ye,()=>(()=>{var a={3146:(o,c,h)=>{for(var g=h(3491),m=typeof window>"u"?h.g:window,S=["moz","webkit"],A="AnimationFrame",T=m["request"+A],B=m["cancel"+A]||m["cancelRequest"+A],ee=0;!T&&ee<S.length;ee++)T=m[S[ee]+"Request"+A],B=m[S[ee]+"Cancel"+A]||m[S[ee]+"CancelRequest"+A];if(!T||!B){var ae=0,Y=0,q=[],re=1e3/60;T=function(F){if(q.length===0){var $=g(),y=Math.max(0,re-($-ae));ae=y+$,setTimeout(function(){var J=q.slice(0);q.length=0;for(var G=0;G<J.length;G++)if(!J[G].cancelled)try{J[G].callback(ae)}catch(te){setTimeout(function(){throw te},0)}},Math.round(y))}return q.push({handle:++Y,callback:F,cancelled:!1}),Y},B=function(F){for(var $=0;$<q.length;$++)q[$].handle===F&&(q[$].cancelled=!0)}}o.exports=function(F){return T.call(m,F)},o.exports.cancel=function(){B.apply(m,arguments)},o.exports.polyfill=function(F){F||(F=m),F.requestAnimationFrame=T,F.cancelAnimationFrame=B}},3491:function(o){(function(){var c,h,g,m,S,A;typeof performance<"u"&&performance!==null&&performance.now?o.exports=function(){return performance.now()}:typeof process<"u"&&process!==null&&process.hrtime?(o.exports=function(){return(c()-S)/1e6},h=process.hrtime,m=(c=function(){var T;return 1e9*(T=h())[0]+T[1]})(),A=1e9*process.uptime(),S=m-A):Date.now?(o.exports=function(){return Date.now()-g},g=Date.now()):(o.exports=function(){return new Date().getTime()-g},g=new Date().getTime())}).call(this)}},l={};function i(o){var c=l[o];if(c!==void 0)return c.exports;var h=l[o]={exports:{}};return a[o].call(h.exports,h,h.exports,i),h.exports}i.n=o=>{var c=o&&o.__esModule?()=>o.default:()=>o;return i.d(c,{a:c}),c},i.d=(o,c)=>{for(var h in c)i.o(c,h)&&!i.o(o,h)&&Object.defineProperty(o,h,{enumerable:!0,get:c[h]})},i.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),i.o=(o,c)=>Object.prototype.hasOwnProperty.call(o,c);var r={};return(()=>{i.d(r,{default:()=>jt});var o=i(3146),c=i.n(o);const h=function(k){return new RegExp(/<[a-z][\s\S]*>/i).test(k)},g=function(k,p){return Math.floor(Math.random()*(p-k+1))+k};var m="TYPE_CHARACTER",S="REMOVE_CHARACTER",A="REMOVE_ALL",T="REMOVE_LAST_VISIBLE_NODE",B="PAUSE_FOR",ee="CALL_FUNCTION",ae="ADD_HTML_TAG_ELEMENT",Y="CHANGE_DELETE_SPEED",q="CHANGE_DELAY",re="CHANGE_CURSOR",F="PASTE_STRING",$="HTML_TAG";function y(k){return y=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(p){return typeof p}:function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":typeof p},y(k)}function J(k,p){var _=Object.keys(k);if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(k);p&&(b=b.filter(function(oe){return Object.getOwnPropertyDescriptor(k,oe).enumerable})),_.push.apply(_,b)}return _}function G(k){for(var p=1;p<arguments.length;p++){var _=arguments[p]!=null?arguments[p]:{};p%2?J(Object(_),!0).forEach(function(b){N(k,b,_[b])}):Object.getOwnPropertyDescriptors?Object.defineProperties(k,Object.getOwnPropertyDescriptors(_)):J(Object(_)).forEach(function(b){Object.defineProperty(k,b,Object.getOwnPropertyDescriptor(_,b))})}return k}function te(k){return function(p){if(Array.isArray(p))return De(p)}(k)||function(p){if(typeof Symbol<"u"&&p[Symbol.iterator]!=null||p["@@iterator"]!=null)return Array.from(p)}(k)||function(p,_){if(p){if(typeof p=="string")return De(p,_);var b={}.toString.call(p).slice(8,-1);return b==="Object"&&p.constructor&&(b=p.constructor.name),b==="Map"||b==="Set"?Array.from(p):b==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(b)?De(p,_):void 0}}(k)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function De(k,p){(p==null||p>k.length)&&(p=k.length);for(var _=0,b=Array(p);_<p;_++)b[_]=k[_];return b}function It(k,p){for(var _=0;_<p.length;_++){var b=p[_];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(k,$e(b.key),b)}}function N(k,p,_){return(p=$e(p))in k?Object.defineProperty(k,p,{value:_,enumerable:!0,configurable:!0,writable:!0}):k[p]=_,k}function $e(k){var p=function(_){if(y(_)!="object"||!_)return _;var b=_[Symbol.toPrimitive];if(b!==void 0){var oe=b.call(_,"string");if(y(oe)!="object")return oe;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(_)}(k);return y(p)=="symbol"?p:p+""}const jt=function(){function k(b,oe){var u=this;if(function(f,I){if(!(f instanceof I))throw new TypeError("Cannot call a class as a function")}(this,k),N(this,"state",{cursorAnimation:null,lastFrameTime:null,pauseUntil:null,eventQueue:[],eventLoop:null,eventLoopPaused:!1,reverseCalledEvents:[],calledEvents:[],visibleNodes:[],initialOptions:null,elements:{container:null,wrapper:document.createElement("span"),cursor:document.createElement("span")}}),N(this,"options",{strings:null,cursor:"|",delay:"natural",pauseFor:1500,deleteSpeed:"natural",loop:!1,autoStart:!1,devMode:!1,skipAddStyles:!1,wrapperClassName:"Typewriter__wrapper",cursorClassName:"Typewriter__cursor",stringSplitter:null,onCreateTextNode:null,onRemoveNode:null}),N(this,"setupWrapperElement",function(){u.state.elements.container&&(u.state.elements.wrapper.className=u.options.wrapperClassName,u.state.elements.cursor.className=u.options.cursorClassName,u.state.elements.cursor.innerHTML=u.options.cursor,u.state.elements.container.innerHTML="",u.state.elements.container.appendChild(u.state.elements.wrapper),u.state.elements.container.appendChild(u.state.elements.cursor))}),N(this,"start",function(){return u.state.eventLoopPaused=!1,u.runEventLoop(),u}),N(this,"pause",function(){return u.state.eventLoopPaused=!0,u}),N(this,"stop",function(){return u.state.eventLoop&&((0,o.cancel)(u.state.eventLoop),u.state.eventLoop=null),u}),N(this,"pauseFor",function(f){return u.addEventToQueue(B,{ms:f}),u}),N(this,"typeOutAllStrings",function(){return typeof u.options.strings=="string"?(u.typeString(u.options.strings).pauseFor(u.options.pauseFor),u):(u.options.strings.forEach(function(f){u.typeString(f).pauseFor(u.options.pauseFor).deleteAll(u.options.deleteSpeed)}),u)}),N(this,"typeString",function(f){var I=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(h(f))return u.typeOutHTMLString(f,I);if(f){var Q=(u.options||{}).stringSplitter,W=typeof Q=="function"?Q(f):f.split("");u.typeCharacters(W,I)}return u}),N(this,"pasteString",function(f){var I=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return h(f)?u.typeOutHTMLString(f,I,!0):(f&&u.addEventToQueue(F,{character:f,node:I}),u)}),N(this,"typeOutHTMLString",function(f){var I=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,Q=arguments.length>2?arguments[2]:void 0,W=function(ge){var me=document.createElement("div");return me.innerHTML=ge,me.childNodes}(f);if(W.length>0)for(var M=0;M<W.length;M++){var ne=W[M],we=ne.innerHTML;ne&&ne.nodeType!==3?(ne.innerHTML="",u.addEventToQueue(ae,{node:ne,parentNode:I}),Q?u.pasteString(we,ne):u.typeString(we,ne)):ne.textContent&&(Q?u.pasteString(ne.textContent,I):u.typeString(ne.textContent,I))}return u}),N(this,"deleteAll",function(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"natural";return u.addEventToQueue(A,{speed:f}),u}),N(this,"changeDeleteSpeed",function(f){if(!f)throw new Error("Must provide new delete speed");return u.addEventToQueue(Y,{speed:f}),u}),N(this,"changeDelay",function(f){if(!f)throw new Error("Must provide new delay");return u.addEventToQueue(q,{delay:f}),u}),N(this,"changeCursor",function(f){if(!f)throw new Error("Must provide new cursor");return u.addEventToQueue(re,{cursor:f}),u}),N(this,"deleteChars",function(f){if(!f)throw new Error("Must provide amount of characters to delete");for(var I=0;I<f;I++)u.addEventToQueue(S);return u}),N(this,"callFunction",function(f,I){if(!f||typeof f!="function")throw new Error("Callback must be a function");return u.addEventToQueue(ee,{cb:f,thisArg:I}),u}),N(this,"typeCharacters",function(f){var I=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!f||!Array.isArray(f))throw new Error("Characters must be an array");return f.forEach(function(Q){u.addEventToQueue(m,{character:Q,node:I})}),u}),N(this,"removeCharacters",function(f){if(!f||!Array.isArray(f))throw new Error("Characters must be an array");return f.forEach(function(){u.addEventToQueue(S)}),u}),N(this,"addEventToQueue",function(f,I){var Q=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return u.addEventToStateProperty(f,I,Q,"eventQueue")}),N(this,"addReverseCalledEvent",function(f,I){var Q=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return u.options.loop?u.addEventToStateProperty(f,I,Q,"reverseCalledEvents"):u}),N(this,"addEventToStateProperty",function(f,I){var Q=arguments.length>2&&arguments[2]!==void 0&&arguments[2],W=arguments.length>3?arguments[3]:void 0,M={eventName:f,eventArgs:I||{}};return u.state[W]=Q?[M].concat(te(u.state[W])):[].concat(te(u.state[W]),[M]),u}),N(this,"runEventLoop",function(){u.state.lastFrameTime||(u.state.lastFrameTime=Date.now());var f=Date.now(),I=f-u.state.lastFrameTime;if(!u.state.eventQueue.length){if(!u.options.loop)return;u.state.eventQueue=te(u.state.calledEvents),u.state.calledEvents=[],u.options=G({},u.state.initialOptions)}if(u.state.eventLoop=c()(u.runEventLoop),!u.state.eventLoopPaused){if(u.state.pauseUntil){if(f<u.state.pauseUntil)return;u.state.pauseUntil=null}var Q,W=te(u.state.eventQueue),M=W.shift();if(!(I<=(Q=M.eventName===T||M.eventName===S?u.options.deleteSpeed==="natural"?g(40,80):u.options.deleteSpeed:u.options.delay==="natural"?g(120,160):u.options.delay))){var ne=M.eventName,we=M.eventArgs;switch(u.logInDevMode({currentEvent:M,state:u.state,delay:Q}),ne){case F:case m:var ge=we.character,me=we.node,He=document.createTextNode(ge),be=He;u.options.onCreateTextNode&&typeof u.options.onCreateTextNode=="function"&&(be=u.options.onCreateTextNode(ge,He)),be&&(me?me.appendChild(be):u.state.elements.wrapper.appendChild(be)),u.state.visibleNodes=[].concat(te(u.state.visibleNodes),[{type:"TEXT_NODE",character:ge,node:be}]);break;case S:W.unshift({eventName:T,eventArgs:{removingCharacterNode:!0}});break;case B:var Nt=M.eventArgs.ms;u.state.pauseUntil=Date.now()+parseInt(Nt);break;case ee:var Ke=M.eventArgs,Mt=Ke.cb,Ot=Ke.thisArg;Mt.call(Ot,{elements:u.state.elements});break;case ae:var Qe=M.eventArgs,Ee=Qe.node,Ie=Qe.parentNode;Ie?Ie.appendChild(Ee):u.state.elements.wrapper.appendChild(Ee),u.state.visibleNodes=[].concat(te(u.state.visibleNodes),[{type:$,node:Ee,parentNode:Ie||u.state.elements.wrapper}]);break;case A:var Lt=u.state.visibleNodes,je=we.speed,Se=[];je&&Se.push({eventName:Y,eventArgs:{speed:je,temp:!0}});for(var We=0,At=Lt.length;We<At;We++)Se.push({eventName:T,eventArgs:{removingCharacterNode:!1}});je&&Se.push({eventName:Y,eventArgs:{speed:u.options.deleteSpeed,temp:!0}}),W.unshift.apply(W,Se);break;case T:var Ut=M.eventArgs.removingCharacterNode;if(u.state.visibleNodes.length){var Ne=u.state.visibleNodes.pop(),Pt=Ne.type,ke=Ne.node,Rt=Ne.character;u.options.onRemoveNode&&typeof u.options.onRemoveNode=="function"&&u.options.onRemoveNode({node:ke,character:Rt}),ke&&ke.parentNode.removeChild(ke),Pt===$&&Ut&&W.unshift({eventName:T,eventArgs:{}})}break;case Y:u.options.deleteSpeed=M.eventArgs.speed;break;case q:u.options.delay=M.eventArgs.delay;break;case re:u.options.cursor=M.eventArgs.cursor,u.state.elements.cursor.innerHTML=M.eventArgs.cursor}u.options.loop&&(M.eventName===T||M.eventArgs&&M.eventArgs.temp||(u.state.calledEvents=[].concat(te(u.state.calledEvents),[M]))),u.state.eventQueue=W,u.state.lastFrameTime=f}}}),b)if(typeof b=="string"){var ze=document.querySelector(b);if(!ze)throw new Error("Could not find container element");this.state.elements.container=ze}else this.state.elements.container=b;oe&&(this.options=G(G({},this.options),oe)),this.state.initialOptions=G({},this.options),this.init()}var p,_;return p=k,(_=[{key:"init",value:function(){var b,oe;this.setupWrapperElement(),this.addEventToQueue(re,{cursor:this.options.cursor},!0),this.addEventToQueue(A,null,!0),!window||window.___TYPEWRITER_JS_STYLES_ADDED___||this.options.skipAddStyles||(b=".Typewriter__cursor{-webkit-animation:Typewriter-cursor 1s infinite;animation:Typewriter-cursor 1s infinite;margin-left:1px}@-webkit-keyframes Typewriter-cursor{0%{opacity:0}50%{opacity:1}100%{opacity:0}}@keyframes Typewriter-cursor{0%{opacity:0}50%{opacity:1}100%{opacity:0}}",(oe=document.createElement("style")).appendChild(document.createTextNode(b)),document.head.appendChild(oe),window.___TYPEWRITER_JS_STYLES_ADDED___=!0),this.options.autoStart===!0&&this.options.strings&&this.typeOutAllStrings().start()}},{key:"logInDevMode",value:function(b){this.options.devMode&&console.log(b)}}])&&It(p.prototype,_),Object.defineProperty(p,"prototype",{writable:!1}),k}()})(),r.default})())})(Et);var oi=Et.exports;const ot=kt(oi),ri=[{text:"帝高阳之苗裔兮，朕皇考曰伯庸。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"摄提贞于孟陬兮，惟庚寅吾以降。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"皇览揆余初度兮，肇锡余以嘉名。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"名余曰正则兮，字余曰灵均。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"纷吾既有此内美兮，又重之以修能。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"扈江离与辟芷兮，纫秋兰以为佩。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"汩余若将不及兮，恐年岁之不吾与。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"朝搴阰之木兰兮，夕揽洲之宿莽。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"日月忽其不淹兮，春与秋其代序。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"惟草木之零落兮，恐美人之迟暮。(惟 通：唯)",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"不抚壮而弃秽兮，何不改此度？(改此度 一作：改乎此度)",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"乘骐骥以驰骋兮，来吾道夫先路！",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"昔三后之纯粹兮，固众芳之所在。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"杂申椒与菌桂兮，岂惟纫夫蕙茝！",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"彼尧舜之耿介兮，既遵道而得路。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"何桀纣之猖披兮，夫唯捷径以窘步。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"惟夫党人之偷乐兮，路幽昧以险隘。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"岂余身之惮殃兮，恐皇舆之败绩！",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"忽奔走以先后兮，及前王之踵武。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"荃不查余之中情兮，反信谗而齌怒。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"余固知謇謇之为患兮，忍而不能舍也。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"指九天以为正兮，夫唯灵修之故也。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"曰黄昏以为期兮，羌中道而改路！",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"初既与余成言兮，后悔遁而有他。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"余既不难夫离别兮，伤灵修之数化。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"余既滋兰之九畹兮，又树蕙之百亩。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"畦留夷与揭车兮，杂杜衡与芳芷。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"冀枝叶之峻茂兮，愿俟时乎吾将刈。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"虽萎绝其亦何伤兮，哀众芳之芜秽。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"众皆竞进以贪婪兮，凭不厌乎求索。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"羌内恕己以量人兮，各兴心而嫉妒。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"忽驰骛以追逐兮，非余心之所急。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"老冉冉其将至兮，恐修名之不立。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"朝饮木兰之坠露兮，夕餐秋菊之落英。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"苟余情其信姱以练要兮，长顑颔亦何伤。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"掔木根以结茝兮，贯薜荔之落蕊。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"矫菌桂以纫蕙兮，索胡绳之纚纚。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"謇吾法夫前修兮，非世俗之所服。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"虽不周于今之人兮，愿依彭咸之遗则。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"长太息以掩涕兮，哀民生之多艰。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"余虽好修姱以鞿羁兮，謇朝谇而夕替。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"既替余以蕙纕兮，又申之以揽茝。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"亦余心之所善兮，虽九死其犹未悔。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"怨灵修之浩荡兮，终不察夫民心。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"众女嫉余之蛾眉兮，谣诼谓余以善淫。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"固时俗之工巧兮，偭规矩而改错。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"背绳墨以追曲兮，竞周容以为度。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"忳郁邑余侘傺兮，吾独穷困乎此时也。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"宁溘死以流亡兮，余不忍为此态也。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"鸷鸟之不群兮，自前世而固然。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"何方圜之能周兮，夫孰异道而相安？",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"屈心而抑志兮，忍尤而攘诟。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"伏清白以死直兮，固前圣之所厚。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"悔相道之不察兮，延伫乎吾将反。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"回朕车以复路兮，及行迷之未远。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"步余马于兰皋兮，驰椒丘且焉止息。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"进不入以离尤兮，退将复修吾初服。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"制芰荷以为衣兮，集芙蓉以为裳。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"不吾知其亦已兮，苟余情其信芳。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"高余冠之岌岌兮，长余佩之陆离。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"芳与泽其杂糅兮，唯昭质其犹未亏。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"忽反顾以游目兮，将往观乎四荒。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"佩缤纷其繁饰兮，芳菲菲其弥章。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"民生各有所乐兮，余独好修以为常。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"虽体解吾犹未变兮，岂余心之可惩。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"女媭之婵媛兮，申申其詈予，曰：",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"鲧婞直以亡身兮，终然夭乎羽之野。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"汝何博謇而好修兮，纷独有此姱节？",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"薋菉葹以盈室兮，判独离而不服。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"众不可户说兮，孰云察余之中情？",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"世并举而好朋兮，夫何茕独而不予听？",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"依前圣以节中兮，喟凭心而历兹。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"济沅湘以南征兮，就重华而陈词：",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"启《九辩》与《九歌》兮，夏康娱以自纵。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"不顾难以图后兮，五子用失乎家衖。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"羿淫游以佚畋兮，又好射夫封狐。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"固乱流其鲜终兮，浞又贪夫厥家。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"浇身被服强圉兮，纵欲而不忍。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"日康娱而自忘兮，厥首用夫颠陨。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"夏桀之常违兮，乃遂焉而逢殃。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"后辛之菹醢兮，殷宗用而不长。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"汤禹俨而祗敬兮，周论道而莫差。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"举贤才而授能兮，循绳墨而不颇。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"皇天无私阿兮，览民德焉错辅。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"夫维圣哲以茂行兮，苟得用此下土。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"瞻前而顾后兮，相观民之计极。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"夫孰非义而可用兮？孰非善而可服？",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"阽余身而危死兮，览余初其犹未悔。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"不量凿而正枘兮，固前修以菹醢。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"曾歔欷余郁邑兮，哀朕时之不当。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"揽茹蕙以掩涕兮，沾余襟之浪浪。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"跪敷衽以陈辞兮，耿吾既得此中正。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"驷玉虬以椉鹥兮，溘埃风余上征。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"朝发轫于苍梧兮，夕余至乎县圃。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"欲少留此灵琐兮，日忽忽其将暮。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"吾令羲和弭节兮，望崦嵫而勿迫。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"路曼曼其修远兮，吾将上下而求索。(曼曼 一作：漫漫)",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"饮余马于咸池兮，总余辔乎扶桑。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"折若木以拂日兮，聊逍遥以相羊。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"前望舒使先驱兮，后飞廉使奔属。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"鸾皇为余先戒兮，雷师告余以未具。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"吾令凤鸟飞腾兮，继之以日夜。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"飘风屯其相离兮，帅云霓而来御。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"纷总总其离合兮，斑陆离其上下。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"吾令帝阍开关兮，倚阊阖而望予。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"时暧暧其将罢兮，结幽兰而延伫。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"世溷浊而不分兮，好蔽美而嫉妒。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"朝吾将济于白水兮，登阆风而绁马。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"忽反顾以流涕兮，哀高丘之无女。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"溘吾游此春宫兮，折琼枝以继佩。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"及荣华之未落兮，相下女之可诒。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"吾令丰隆乘云兮，求宓妃之所在。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"解佩纕以结言兮，吾令謇修以为理。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"纷总总其离合兮，忽纬繣其难迁。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"夕归次于穷石兮，朝濯发乎洧盘。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"保厥美以骄傲兮，日康娱以淫游。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"虽信美而无礼兮，来违弃而改求。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"览相观于四极兮，周流乎天余乃下。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"望瑶台之偃蹇兮，见有娀之佚女。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"吾令鸩为媒兮，鸩告余以不好。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"雄鸠之鸣逝兮，余犹恶其佻巧。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"心犹豫而狐疑兮，欲自适而不可。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"凤皇既受诒兮，恐高辛之先我。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"欲远集而无所止兮，聊浮游以逍遥。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"及少康之未家兮，留有虞之二姚。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"理弱而媒拙兮，恐导言之不固。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"世溷浊而嫉贤兮，好蔽美而称恶。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"闺中既以邃远兮，哲王又不寤。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"怀朕情而不发兮，余焉能忍而与此终古？",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"索琼茅以筳篿兮，命灵氛为余占之。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"曰：两美其必合兮，孰信修而慕之？",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"思九州之博大兮，岂惟是其有女？",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"曰：勉远逝而无狐疑兮，孰求美而释女？",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"何所独无芳草兮，尔何怀乎故宇？",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"世幽昧以昡曜兮，孰云察余之善恶？",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"民好恶其不同兮，惟此党人其独异！",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"户服艾以盈要兮，谓幽兰其不可佩。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"览察草木其犹未得兮，岂珵美之能当？",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"苏粪壤以充帏兮，谓申椒其不芳。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"欲从灵氛之吉占兮，心犹豫而狐疑。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"巫咸将夕降兮，怀椒糈而要之。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"百神翳其备降兮，九疑缤其并迎。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"皇剡剡其扬灵兮，告余以吉故。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"曰：勉升降以上下兮，求矩矱之所同。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"汤禹俨而求合兮，挚咎繇而能调。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"苟中情其好修兮，又何必用夫行媒？",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"说操筑于傅岩兮，武丁用而不疑。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"吕望之鼓刀兮，遭周文而得举。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"宁戚之讴歌兮，齐桓闻以该辅。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"及年岁之未晏兮，时亦犹其未央。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"恐鹈鴂之先鸣兮，使夫百草为之不芳。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"何琼佩之偃蹇兮，众薆然而蔽之。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"惟此党人之不谅兮，恐嫉妒而折之。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"时缤纷其变易兮，又何可以淹留？",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"兰芷变而不芳兮，荃蕙化而为茅。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"何昔日之芳草兮，今直为此萧艾也？",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"岂其有他故兮，莫好修之害也！",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"余以兰为可恃兮，羌无实而容长。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"委厥美以从俗兮，苟得列乎众芳。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"椒专佞以慢慆兮，樧又欲充夫佩帏。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"既干进而务入兮，又何芳之能祗？",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"固时俗之流从兮，又孰能无变化？",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"览椒兰其若兹兮，又况揭车与江离？",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"惟兹佩之可贵兮，委厥美而历兹。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"芳菲菲而难亏兮，芬至今犹未沬。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"和调度以自娱兮，聊浮游而求女。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"及余饰之方壮兮，周流观乎上下。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"灵氛既告余以吉占兮，历吉日乎吾将行。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"折琼枝以为羞兮，精琼爢以为粻。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"为余驾飞龙兮，杂瑶象以为车。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"何离心之可同兮？吾将远逝以自疏。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"邅吾道夫昆仑兮，路修远以周流。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"扬云霓之晻蔼兮，鸣玉鸾之啾啾。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"朝发轫于天津兮，夕余至乎西极。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"凤皇翼其承旗兮，高翱翔之翼翼。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"忽吾行此流沙兮，遵赤水而容与。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"麾蛟龙使梁津兮，诏西皇使涉予。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"路修远以多艰兮，腾众车使径待。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"路不周以左转兮，指西海以为期。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"屯余车其千乘兮，齐玉轪而并驰。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"驾八龙之婉婉兮，载云旗之委蛇。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"抑志而弭节兮，神高驰之邈邈。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"奏《九歌》而舞《韶》兮，聊假日以媮乐。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"陟升皇之赫戏兮，忽临睨夫旧乡。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"仆夫悲余马怀兮，蜷局顾而不行。",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"乱曰：已矣哉！",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"国无人莫我知兮，又何怀乎故都！",author:"屈原",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"},{text:"既莫足与为美政兮，吾将从彭咸之所居！",author:"离骚",contributor:"Sunwuyuan",link:"https://www.gushiwen.cn/shiwenv.aspx?id=f5714bcd33e3"}],rt={quotes:ri},ut={text:"点击此处可以查看 Classworks 用户群里沙雕群友们的发言",author:"点击后会复制当前句子到剪贴板中"},lt={main:{delay:50,deleteSpeed:100},source:{delay:10,deleteSpeed:10,cursor:""}},ui={name:"EchoChamberCard",components:{SettingsCard:he},data:()=>({typewriter:null,sourceWriter:null,currentQuote:ut,hasClicked:!1}),mounted(){this.initTypewriters()},methods:{initTypewriters(){this.typewriter=new ot(this.$refs.typewriter,lt.main),this.sourceWriter=new ot(this.$refs.sourceWriter,lt.source),this.typeQuote(ut)},typeQuote(t){this.typewriter.deleteAll(30).typeString(t.text).start(),t.author&&this.sourceWriter.deleteAll(20).typeString(t.author).start()},async handleClick(){this.hasClicked||(this.hasClicked=!0),await this.copyToClipboard(),this.currentQuote=this.getRandomQuote(),this.typeQuote(this.currentQuote)},getRandomQuote(){return rt.quotes[Math.floor(Math.random()*rt.quotes.length)]},async copyToClipboard(){if(!this.currentQuote)return;const{text:t,author:e,contributor:a,link:l}=this.currentQuote,i=[t,e&&`作者：${e}`,a&&`贡献者：${a}`,(l||a)&&`来源：${l||`https://github.com/${a}`}`].filter(Boolean);try{await navigator.clipboard.writeText(i.join(`
`))}catch(r){console.error("复制失败:",r)}}},beforeUnmount(){[this.typewriter,this.sourceWriter].forEach(t=>t==null?void 0:t.stop())}},li={ref:"typewriter",class:"typewriter-text"},di={ref:"sourceWriter",class:"source-text"};function ci(t,e,a,l,i,r){const o=V("settings-card");return w(),C(o,{border:"",title:"回声洞",icon:"mdi-thought-bubble",onClick:r.handleClick},{default:s(()=>[n(Z,null,{default:s(()=>[D("div",li,null,512),D("div",di,null,512)]),_:1}),n(qt,{name:"fade"},{default:s(()=>{var c;return[(c=t.currentQuote)!=null&&c.contributor?(w(),C(xe,{key:0,class:"contributor"},{default:s(()=>[n(mt,{start:""},{default:s(()=>[n(bt,{src:`https://github.com/${t.currentQuote.contributor}.png`},null,8,["src"])]),_:1}),d(" "+E(t.currentQuote.contributor),1)]),_:1})):H("",!0)]}),_:1})]),_:1},8,["onClick"])}const hi=K(ui,[["render",ci],["__scopeId","data-v-5c15976c"]]),wi={name:"UnsavedWarning",props:{show:Boolean,message:{type:String,default:"未保存"}}},pi={class:"warning-container"};function fi(t,e,a,l,i,r){return w(),U("div",pi,[a.show?(w(),C(xe,{key:0,color:"warning",size:"small",class:"warning-chip"},{default:s(()=>[d(E(a.message),1)]),_:1})):H("",!0)])}const gi=K(wi,[["render",fi],["__scopeId","data-v-0668f179"]]),mi=ft({disabled:Boolean,modelValue:{type:Boolean,default:null},...Yt()},"VHover"),bi=pt()({name:"VHover",props:mi(),emits:{"update:modelValue":t=>!0},setup(t,e){let{slots:a}=e;const l=Jt(t,"modelValue"),{runOpenDelay:i,runCloseDelay:r}=Gt(t,o=>!t.disabled&&(l.value=o));return()=>{var o;return(o=a.default)==null?void 0:o.call(a,{isHovering:l.value,props:{onMouseenter:i,onMouseleave:r}})}}}),vi={name:"StudentListCard",components:{UnsavedWarning:gi},props:{modelValue:{type:Object,required:!0,default:()=>({list:[],text:"",advanced:!1})},loading:Boolean,error:String,isMobile:Boolean,unsavedChanges:Boolean},data(){return{newStudentName:"",editState:{index:-1,name:""}}},emits:["update:modelValue","save","reload"],computed:{text:{get(){return this.modelValue.text},set(t){this.handleTextInput(t)}}},methods:{toggleAdvanced(){const t=!this.modelValue.advanced;this.updateModelValue({advanced:t,text:t?this.modelValue.list.join(`
`):this.modelValue.text,list:this.modelValue.list})},updateModelValue(t){this.$emit("update:modelValue",{...this.modelValue,...t})},addStudent(){const t=this.newStudentName.trim();if(!t||this.modelValue.list.includes(t))return;const e=[...this.modelValue.list,t];this.updateModelValue({list:e,text:e.join(`
`)}),this.newStudentName=""},removeStudent(t){const e=this.modelValue.list.filter((a,l)=>l!==t);this.updateModelValue({list:e,text:e.join(`
`)})},moveStudent(t,e){const a=[...this.modelValue.list];let l;if(e==="top"?l=0:e==="up"?l=t-1:l=t+1,l>=0&&l<a.length){const[i]=a.splice(t,1);a.splice(l,0,i),this.updateModelValue({list:a,text:a.join(`
`)})}},startEdit(t,e){this.editState={index:t,name:e}},saveEdit(){const{index:t,name:e}=this.editState;if(t===-1||!e.trim())return;const a=[...this.modelValue.list];a[t]=e.trim(),this.updateModelValue({list:a,text:a.join(`
`)}),this.editState={index:-1,name:""}},handleClick(t,e){this.isMobile&&this.startEdit(t,e)},handleTextInput(t){const e=t.split(`
`).map(a=>a.trim()).filter(a=>a);this.updateModelValue({text:t,list:e})},sortStudentsByPinyin(){const t=[...this.modelValue.list].sort((e,a)=>{const l=Ye(e,{toneType:"none",mode:"surname"}),i=Ye(a,{toneType:"none",mode:"surname"});return l.localeCompare(i)});this.updateModelValue({list:t,text:t.join(`
`)})}}},yi={key:0},xi=["onClick"],Si={key:1,class:"pt-2"};function ki(t,e,a,l,i,r){const o=V("unsaved-warning");return w(),C(se,{border:"",color:a.unsavedChanges?"warning-subtle":void 0,class:Ge({"unsaved-changes":a.unsavedChanges})},{default:s(()=>[n(Pe,null,{prepend:s(()=>[n(L,{icon:"mdi-account-group",size:"large",class:"mr-2"})]),append:s(()=>[n(o,{show:a.unsavedChanges,message:"有未保存的更改"},null,8,["show"]),n(x,{"prepend-icon":"mdi-sort-alphabetical-variant",variant:"text",class:"mr-2",onClick:r.sortStudentsByPinyin,disabled:a.modelValue.list.length===0},{default:s(()=>e[6]||(e[6]=[d(" 按姓名首字母排序 ")])),_:1},8,["onClick","disabled"]),n(x,{color:a.modelValue.advanced?"primary":void 0,variant:"text","prepend-icon":"mdi-code-braces",onClick:r.toggleAdvanced},{default:s(()=>[d(E(a.modelValue.advanced?"返回基础编辑":"高级编辑"),1)]),_:1},8,["color","onClick"])]),default:s(()=>[n(ce,{class:"text-h6"},{default:s(()=>e[5]||(e[5]=[d("学生列表")])),_:1})]),_:1}),n(Z,null,{default:s(()=>[a.loading?(w(),C(ct,{key:0,indeterminate:"",color:"primary",class:"mb-4"})):H("",!0),a.error?(w(),C(gn,{key:1,type:"error",variant:"tonal",closable:"",class:"mb-4"},{default:s(()=>[d(E(a.error),1)]),_:1})):H("",!0),n(Fe,null,{default:s(()=>[a.modelValue.advanced?(w(),U("div",Si,[n(yt,{modelValue:r.text,"onUpdate:modelValue":e[2]||(e[2]=c=>r.text=c),label:"批量编辑学生列表",placeholder:"每行输入一个学生姓名",hint:"使用文本编辑模式批量编辑学生名单，保存时会自动去除空行","persistent-hint":"",variant:"outlined",rows:"10",onInput:r.handleTextInput},null,8,["modelValue","onInput"])])):(w(),U("div",yi,[n(de,{class:"mb-6"},{default:s(()=>[n(O,{cols:"12",sm:"6",md:"4"},{default:s(()=>[n(ue,{modelValue:i.newStudentName,"onUpdate:modelValue":e[0]||(e[0]=c=>i.newStudentName=c),label:"添加学生",placeholder:"输入学生姓名后回车添加","prepend-inner-icon":"mdi-account-plus",variant:"outlined","hide-details":"",class:"mb-4",onKeyup:Ae(r.addStudent,["enter"])},{append:s(()=>[n(x,{icon:"mdi-plus",variant:"text",color:"primary",disabled:!i.newStudentName.trim(),onClick:r.addStudent},null,8,["disabled","onClick"])]),_:1},8,["modelValue","onKeyup"])]),_:1})]),_:1}),n(de,null,{default:s(()=>[(w(!0),U(le,null,fe(a.modelValue.list,(c,h)=>(w(),C(O,{key:h,cols:"12",sm:"6",md:"4",lg:"3"},{default:s(()=>[n(bi,null,{default:s(({isHovering:g,props:m})=>[n(se,Ce({ref_for:!0},m,{elevation:a.isMobile?1:g?4:1,class:"student-card",border:""}),{default:s(()=>[n(Z,{class:"d-flex align-center pa-3"},{default:s(()=>[n(xt,{location:"bottom","open-on-hover":!a.isMobile},{activator:s(({props:S})=>[n(x,Ce({variant:"tonal",size:"small",class:"mr-3 font-weight-medium",ref_for:!0},S),{default:s(()=>[d(E(h+1),1)]),_:2},1040)]),default:s(()=>[n(ie,{density:"compact",nav:""},{default:s(()=>[n(j,{"prepend-icon":"mdi-arrow-up-bold",disabled:h===0,onClick:S=>r.moveStudent(h,"top")},{default:s(()=>e[7]||(e[7]=[d(" 置顶 ")])),_:2},1032,["disabled","onClick"]),n(R),n(j,{"prepend-icon":"mdi-arrow-up",disabled:h===0,onClick:S=>r.moveStudent(h,"up")},{default:s(()=>e[8]||(e[8]=[d(" 上移 ")])),_:2},1032,["disabled","onClick"]),n(j,{"prepend-icon":"mdi-arrow-down",disabled:h===a.modelValue.list.length-1,onClick:S=>r.moveStudent(h,"down")},{default:s(()=>e[9]||(e[9]=[d(" 下移 ")])),_:2},1032,["disabled","onClick"])]),_:2},1024)]),_:2},1032,["open-on-hover"]),i.editState.index===h?(w(),C(ue,{key:0,modelValue:i.editState.name,"onUpdate:modelValue":e[1]||(e[1]=S=>i.editState.name=S),density:"compact",variant:"underlined","hide-details":"",class:"flex-grow-1",autofocus:"",onKeyup:Ae(r.saveEdit,["enter"]),onBlur:r.saveEdit},null,8,["modelValue","onKeyup","onBlur"])):(w(),U("span",{key:1,class:"text-body-1 flex-grow-1",onClick:S=>r.handleClick(h,c)},E(c),9,xi)),D("div",{class:Ge(["d-flex gap-1 action-buttons",{"opacity-100":g||a.isMobile}])},[n(x,{icon:"mdi-pencil",variant:"text",color:"primary",size:"small",onClick:S=>r.startEdit(h,c)},null,8,["onClick"]),n(x,{icon:"mdi-delete",variant:"text",color:"error",size:"small",onClick:S=>r.removeStudent(h)},null,8,["onClick"])],2)]),_:2},1024)]),_:2},1040,["elevation"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]))]),_:1}),n(de,{class:"mt-6"},{default:s(()=>[n(O,{cols:"12",class:"d-flex gap-2"},{default:s(()=>[n(x,{color:"primary","prepend-icon":"mdi-content-save",size:"large",loading:a.loading,disabled:a.loading,onClick:e[3]||(e[3]=c=>t.$emit("save"))},{default:s(()=>e[10]||(e[10]=[d(" 保存名单 ")])),_:1},8,["loading","disabled"]),n(x,{color:"error",variant:"outlined","prepend-icon":"mdi-refresh",size:"large",loading:a.loading,disabled:a.loading,onClick:e[4]||(e[4]=c=>t.$emit("reload"))},{default:s(()=>e[11]||(e[11]=[d(" 重载名单 ")])),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1})]),_:1},8,["color","class"])}const _i=K(vi,[["render",ki],["__scopeId","data-v-9de1f8ce"]]),Ci="Classworks",Vi="module",Ti="0.0.0",Di="pnpm@9.6.0",Ei={dev:"vite --host",build:"vite build",preview:"vite preview",lint:"eslint . --fix","vercel-build":"pnpm run build"},Ii={"@mdi/font":"7.4.47",axios:"^1.8.4",dompurify:"^3.2.5",idb:"^8.0.2",lodash:"^4.17.21",marked:"^15.0.11","pinyin-pro":"^3.26.0","roboto-fontface":"*","typewriter-effect":"^2.21.0",uuid:"^11.1.0",vite:"^5.4.17",vue:"^3.4.31",vuetify:"^3.8.0"},ji={"@eslint/js":"^9.14.0","@types/uuid":"^10.0.0","@vite-pwa/assets-generator":"^1.0.0","@vitejs/plugin-vue":"^5.2.3",eslint:"^9.14.0","eslint-plugin-import":"^2.29.1","eslint-plugin-n":"^16.6.2","eslint-plugin-node":"^11.1.0","eslint-plugin-promise":"^6.4.0","eslint-plugin-vue":"^9.30.0",pinia:"^3.0.1",sass:"1.86.3","sass-embedded":"^1.86.3","unplugin-auto-import":"^19.1.2","unplugin-fonts":"^1.3.1","unplugin-vue-components":"^28.4.1","unplugin-vue-router":"^0.12.0","vite-plugin-pwa":"^1.0.0","vite-plugin-vue-layouts":"^0.11.0","vite-plugin-vuetify":"^2.1.1","vue-router":"^4.5.0"},dt={name:Ci,private:!0,type:Vi,version:Ti,packageManager:Di,scripts:Ei,dependencies:Ii,devDependencies:ji},Ni={name:"AboutCard",setup(){const t=Le([]),e=Le(!1),a=()=>{try{const i={...dt.dependencies||{},...dt.devDependencies||{}},r=Object.entries(i).map(([o,c])=>({name:o,version:c.replace(/[\^~]/g,""),description:l(o)}));t.value=r}catch(i){console.error("加载依赖信息失败:",i),t.value=[]}},l=i=>({vue:"渐进式 JavaScript 框架",vuetify:"材料设计组件框架",axios:"Promise 基础的 HTTP 客户端",pinia:"Vue 状态管理库","vue-router":"Vue.js 官方路由管理器","@vitejs/plugin-vue":"Vite 的 Vue 插件"})[i]||"";return Xt(()=>{a()}),{Dependencies:t,showDeps:e}}},Mi={class:"d-flex flex-column align-start"},Oi={class:"d-flex gap-2 flex-wrap mb-6"},Li={class:"text-caption text-medium-emphasis"};function Ai(t,e,a,l,i,r){return w(),C(se,{border:""},{default:s(()=>[n(Pe,null,{prepend:s(()=>[n(L,{icon:"mdi-information",size:"large",class:"mr-2"})]),default:s(()=>[n(ce,{class:"text-h6"},{default:s(()=>e[3]||(e[3]=[d("关于")])),_:1})]),_:1}),n(Z,null,{default:s(()=>[n(de,null,{default:s(()=>[n(O,{cols:"12",md:"8",class:"mx-auto"},{default:s(()=>[D("div",Mi,[n(mt,{size:"120",class:"mb-4"},{default:s(()=>[n(bt,{src:"https://github.com/SunWuyuan.png",alt:"Sunwuyuan"})]),_:1}),e[20]||(e[20]=D("h2",{class:"text-h5 mb-2"},"Classworks",-1)),e[21]||(e[21]=D("p",{class:"text-body-1 mb-4"},"适用于班级大屏的作业板小工具",-1)),D("div",Oi,[n(x,{color:"red",variant:"tonal",href:"https://github.com/ClassworksDev/Classworks/issues",target:"_blank","prepend-icon":"mdi-bug"},{default:s(()=>e[4]||(e[4]=[d(" 报告问题 ")])),_:1}),n(x,{color:"primary",variant:"tonal",href:"https://qm.qq.com/q/qNBX4ZZVeg",target:"_blank","prepend-icon":"mdi-qqchat"},{default:s(()=>e[5]||(e[5]=[d(" QQ 群 ")])),_:1}),n(x,{variant:"text",href:"https://github.com/ClassworksDev/Classworks",target:"_blank","prepend-icon":"mdi-github"},{default:s(()=>e[6]||(e[6]=[d(" 前端 ")])),_:1}),n(x,{variant:"text",href:"https://github.com/ClassworksDev/ClassworksServer",target:"_blank","prepend-icon":"mdi-github"},{default:s(()=>e[7]||(e[7]=[d(" 后端 ")])),_:1})]),n(R,{class:"mb-4 w-100"}),e[22]||(e[22]=D("h3",{class:"text-h6 mb-2"},"备注与致谢",-1)),n(ie,{class:"mb-4 bg-transparent"},{default:s(()=>[n(j,{href:"https://github.com/EnderWolf006/HomeworkBoard",target:"_blank","append-icon":"mdi-link"},{default:s(()=>[n(P,null,{default:s(()=>e[8]||(e[8]=[d(" 本项目受到 HomeworkBoard 的启发而开发 ")])),_:1}),n(X,null,{default:s(()=>e[9]||(e[9]=[d(" 感谢 EnderWolf006 (@EnderWolf) fhzit(@Hellofhz) KeyFac 等人的贡献 ")])),_:1})]),_:1}),n(j,{href:"https://hlyun.org",target:"_blank","append-icon":"mdi-link"},{default:s(()=>[n(P,null,{default:s(()=>e[10]||(e[10]=[d(" Classworks 由"),D("strong",null,"厚浪云",-1),d("提供 ")])),_:1}),n(X,null,{default:s(()=>e[11]||(e[11]=[d(" 长江后浪推前浪 浮事新人换旧人 ")])),_:1})]),_:1}),n(j,{href:"https://zerocat.houlangs.com",target:"_blank","append-icon":"mdi-link"},{default:s(()=>[n(P,null,{default:s(()=>e[12]||(e[12]=[d(" 感谢 ZeroCat 社区的开发者们 ")])),_:1}),n(X,null,{default:s(()=>e[13]||(e[13]=[d(" 新一代，开源，编程社区 ")])),_:1})]),_:1}),n(R,{class:"ma-1"}),n(j,{href:"https://github.com/HUSX100/IslandCaller",target:"_blank","append-icon":"mdi-link"},{default:s(()=>[n(P,null,{default:s(()=>e[14]||(e[14]=[d(" 本项目与 IslandCaller 没有从属关系 ")])),_:1}),n(X,null,{default:s(()=>e[15]||(e[15]=[d(" IslandCaller 是由 HUSX100 开发的基于 ClassIsland 提醒服务的轻量级点名器 ")])),_:1})]),_:1}),n(j,{href:"https://classisland.tech",target:"_blank","append-icon":"mdi-link"},{default:s(()=>[n(P,null,{default:s(()=>e[16]||(e[16]=[d(" 本项目与 ClassIsland 没有从属关系 ")])),_:1}),n(X,null,{default:s(()=>e[17]||(e[17]=[d(" ClassIsland 是由 HelloWRC 开发的适用于班级大屏的课表信息显示工具 ")])),_:1})]),_:1})]),_:1}),n(x,{variant:"text",class:"mb-4","prepend-icon":"mdi-package-variant",onClick:e[0]||(e[0]=o=>l.showDeps=!0)},{default:s(()=>e[18]||(e[18]=[d(" 查看使用的第三方库 ")])),_:1}),n(St,{modelValue:l.showDeps,"onUpdate:modelValue":e[2]||(e[2]=o=>l.showDeps=o),transition:"dialog-bottom-transition",fullscreen:""},{default:s(()=>[n(se,null,{default:s(()=>[n(dn,null,{default:s(()=>[n(x,{icon:"mdi-close",onClick:e[1]||(e[1]=o=>l.showDeps=!1)}),n(cn,null,{default:s(()=>e[19]||(e[19]=[d("使用的第三方库")])),_:1}),n(Be)]),_:1}),n(Z,null,{default:s(()=>[n(ie,null,{default:s(()=>[(w(!0),U(le,null,fe(l.Dependencies,o=>(w(),C(j,{key:o.name,href:"https://www.npmjs.com/package/"+o.name,target:"_blank","append-icon":"mdi-link"},{default:s(()=>[n(P,null,{default:s(()=>[d(E(o.name),1)]),_:2},1024),n(X,null,{default:s(()=>[d(" v"+E(o.version),1)]),_:2},1024)]),_:2},1032,["href"]))),128))]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),D("p",Li," Copyright © "+E(new Date().getFullYear())+" Sunwuyuan ",1)])]),_:1})]),_:1})]),_:1})]),_:1})}const Ui=K(Ni,[["render",Ai]]),Pi={name:"SubjectManagementCard",data(){return{localSubjects:[],newSubject:"",showSnackbar:!1,snackbarText:"",snackbarColor:"success"}},created(){this.loadSubjects()},methods:{loadSubjects(){const t=v("subjects");this.localSubjects=Array.isArray(t)?[...t]:[],console.log("Loaded subjects:",this.localSubjects)},addSubject(){const t=this.newSubject.trim();t&&!this.localSubjects.includes(t)?(this.localSubjects=[...this.localSubjects,t],this.saveSubjects(),this.newSubject="",this.showSnackbarMessage("科目添加成功","success")):this.localSubjects.includes(t)?this.showSnackbarMessage("科目已存在","warning"):this.showSnackbarMessage("请输入科目名称","warning")},removeSubject(t){const e=this.localSubjects[t];this.localSubjects=this.localSubjects.filter((a,l)=>l!==t),this.saveSubjects(),this.showSnackbarMessage(`科目 "${e}" 已删除`,"info")},saveSubjects(){console.log("Saving subjects:",this.localSubjects),pe("subjects",this.localSubjects)?(hn().setSubjects(this.localSubjects),console.log("Subjects saved successfully and store updated.")):(console.error("Failed to save subjects."),this.showSnackbarMessage("保存科目失败","error"),this.loadSubjects())},showSnackbarMessage(t,e="success"){this.snackbarText=t,this.snackbarColor=e,this.showSnackbar=!0}}},Ri={class:"text-body-1 font-weight-medium"};function Bi(t,e,a,l,i,r){return w(),C(se,{class:"settings-card hover-card glow-card rounded-lg"},{default:s(()=>[n(ce,{class:"d-flex align-center pb-2"},{default:s(()=>[n(L,{class:"me-2",color:"primary"},{default:s(()=>e[2]||(e[2]=[d("mdi-book-open-page-variant-outline")])),_:1}),e[3]||(e[3]=D("span",{class:"text-h6"},"科目管理",-1))]),_:1}),n(Z,null,{default:s(()=>[n(de,{dense:""},{default:s(()=>[i.localSubjects.length===0?(w(),C(O,{key:0,cols:"12"},{default:s(()=>[n(se,{variant:"tonal",color:"info",class:"text-center my-2 py-4"},{default:s(()=>[n(Z,{class:"text-body-1"},{default:s(()=>e[4]||(e[4]=[d("暂无科目，请添加科目")])),_:1})]),_:1})]),_:1})):H("",!0),(w(!0),U(le,null,fe(i.localSubjects,(o,c)=>(w(),C(O,{key:c,cols:"12",sm:"6",md:"4",lg:"3"},{default:s(()=>[n(se,{variant:"outlined",class:"subject-card hover-card rounded-lg mb-2",elevation:"1"},{default:s(()=>[n(Z,{class:"d-flex justify-space-between align-center pa-3"},{default:s(()=>[D("span",Ri,E(o),1),n(x,{icon:"mdi-delete",size:"small",variant:"text",color:"error",onClick:h=>r.removeSubject(c),class:"ms-2"},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1}),n(R,{class:"my-4"}),n(ue,{modelValue:i.newSubject,"onUpdate:modelValue":e[0]||(e[0]=o=>i.newSubject=o),label:"添加新科目",variant:"outlined",density:"compact","hide-details":"auto","append-inner-icon":"mdi-plus-circle","onClick:appendInner":r.addSubject,onKeyup:Ae(r.addSubject,["enter"]),class:"mb-2 rounded-lg",color:"primary"},null,8,["modelValue","onClick:appendInner","onKeyup"])]),_:1}),n(wt,{modelValue:i.showSnackbar,"onUpdate:modelValue":e[1]||(e[1]=o=>i.showSnackbar=o),timeout:2e3,color:i.snackbarColor,location:"top"},{default:s(()=>[d(E(i.snackbarText),1)]),_:1},8,["modelValue","color"])]),_:1})}const Fi=K(Pi,[["render",Bi],["__scopeId","data-v-b5020f27"]]),$i={name:"SettingsExplorer",components:{SettingItem:Te},data(){return{searchQuery:"",currentSettings:{},unwatchFunction:null}},computed:{isDeveloperMode(){return v("developer.enabled")},allSettings(){var e;const t=[];for(const[a,l]of Object.entries(Ue))this.searchQuery&&!a.toLowerCase().includes(this.searchQuery.toLowerCase())&&!((e=l.description)!=null&&e.toLowerCase().includes(this.searchQuery.toLowerCase()))||t.push({key:a,...l});return t},formattedSettings(){return JSON.stringify(this.currentSettings,null,2)}},created(){this.updateCurrentSettings(),this.unwatchFunction=gt(()=>{this.updateCurrentSettings()})},beforeUnmount(){this.unwatchFunction&&this.unwatchFunction()},methods:{updateCurrentSettings(){this.currentSettings=_e()},onSettingUpdate(t,e){this.$emit("update",t,e),this.updateCurrentSettings()},onSettingError(t){this.$emit("error",t)},copySettingsToClipboard(){navigator.clipboard.writeText(JSON.stringify(this.currentSettings)).then(()=>{this.$emit("message",{type:"success",text:"设置已复制到剪贴板"})}).catch(t=>{console.error("复制到剪贴板失败:",t),this.$emit("message",{type:"error",text:"复制到剪贴板失败"})})}}},zi={class:"settings-explorer"},Hi={class:"settings-json"};function Ki(t,e,a,l,i,r){const o=V("setting-item");return w(),U("div",zi,[D("div",null,[n(ue,{modelValue:i.searchQuery,"onUpdate:modelValue":e[0]||(e[0]=c=>i.searchQuery=c),label:"搜索设置","prepend-inner-icon":"mdi-magnify",clearable:"",variant:"outlined",density:"comfortable",class:"mb-4"},null,8,["modelValue"]),n(ie,null,{default:s(()=>[(w(!0),U(le,null,fe(r.allSettings,c=>(w(),U("div",{key:c.key},[(w(),C(o,{key:c.key,"setting-key":c.key,disabled:c.requireDeveloper&&!r.isDeveloperMode,onUpdate:r.onSettingUpdate,onError:r.onSettingError},null,8,["setting-key","disabled","onUpdate","onError"])),n(R,{class:"my-2"})]))),128))]),_:1}),n(se,{border:""},{default:s(()=>[n(ce,{class:"text-subtitle-1"},{default:s(()=>e[1]||(e[1]=[d("当前配置")])),_:1}),n(Z,null,{default:s(()=>[D("pre",Hi,E(r.formattedSettings),1)]),_:1}),n(Re,null,{default:s(()=>[n(Be),n(x,{onClick:r.copySettingsToClipboard},{default:s(()=>[e[3]||(e[3]=d(" 复制到剪贴板 ")),n(L,{right:""},{default:s(()=>e[2]||(e[2]=[d("mdi-content-copy")])),_:1})]),_:1},8,["onClick"])]),_:1})]),_:1})])])}const Qi=K($i,[["render",Ki],["__scopeId","data-v-da09fd0e"]]),Wi={name:"SettingsLinkGenerator",data(){return{selectedItems:[],generatedLink:"",linkCopied:!1,search:"",headers:[{title:"",key:"data-table-select"},{title:"设置项",key:"description",sortable:!0},{title:"当前值",key:"value",sortable:!0},{title:"键名",key:"key",class:"d-none d-sm-table-cell",sortable:!0},{title:"状态",key:"isChanged",sortable:!0}]}},computed:{settingItems(){const t=_e(),e=[];for(const[a,l]of Object.entries(Ue)){if(l.requireDeveloper&&!t["developer.enabled"])continue;const i=t[a]!==l.default;e.push({key:a,description:l.description||a,value:t[a],icon:l.icon||"mdi-cog",isChanged:i,defaultValue:l.default})}return e.sort((a,l)=>a.key.localeCompare(l.key))},filteredItems(){if(!this.search)return this.settingItems;const t=this.search.toLowerCase();return t==="已修改"?this.settingItems.filter(e=>e.isChanged):t==="是"||t==="否"?this.settingItems.filter(e=>typeof e.value=="boolean"&&(t==="是"?e.value:!e.value)):this.settingItems.filter(e=>{const a=e.description.toLowerCase(),l=e.key.toLowerCase(),i=String(e.value).toLowerCase(),r=e.isChanged?"已修改":"默认";return a.includes(t)||l.includes(t)||i.includes(t)||r.includes(t)})},hasDisplaySettings(){return this.selectedItems.some(t=>t.startsWith("display."))},hasEditSettings(){return this.selectedItems.some(t=>t.startsWith("edit."))},hasServerSettings(){return this.selectedItems.some(t=>t.startsWith("server."))},hasChangedSettings(){const t=_e();return this.selectedItems.some(e=>{const a=Ue[e];return a&&t[e]!==a.default})}},methods:{handleSelectionChange(t){this.selectedItems=t.map(e=>e.key),this.generateLink()},generateLink(){const t=`${window.location.protocol}//${window.location.host}/`,e=_e(),a={};for(const l of this.selectedItems)a[l]=e[l];if(Object.keys(a).length===0){this.generatedLink=t;return}try{const l=JSON.stringify(a),r=new TextEncoder().encode(l),c={config:btoa(Array.from(r).map(S=>String.fromCharCode(S)).join(""))},g=new URLSearchParams(window.location.search).get("date");g&&(c.date=g);const m=new URLSearchParams(c).toString();this.generatedLink=`${t}?${m}`}catch(l){console.error("生成链接失败:",l),this.generatedLink="链接生成失败，请重试"}this.linkCopied=!1},async copyLink(){this.generatedLink||this.generateLink();try{await navigator.clipboard.writeText(this.generatedLink),this.linkCopied=!0,setTimeout(()=>{this.linkCopied=!1},3e3)}catch(t){console.error("复制链接失败:",t)}},resetSelection(){this.selectedItems=[],this.generatedLink="",this.linkCopied=!1},selectAll(){this.selectedItems=this.settingItems.map(t=>t.key),this.generateLink()},selectDataSourceSettings(){const t=this.settingItems.filter(e=>e.key.startsWith("server.")).map(e=>e.key);this.selectedItems=t,this.generateLink()},selectChangedSettings(){const t=this.settingItems.filter(e=>e.isChanged).map(e=>e.key);this.selectedItems=t,this.generateLink()},selectByPrefix(t){const e=this.settingItems.filter(a=>a.key.startsWith(`${t}.`)).map(a=>a.key);this.selectedItems=e},autoGenerateLink(){this.selectedItems.length>0?this.generateLink():this.generatedLink=""},getSettingDescription(t){const e=this.settingItems.find(a=>a.key===t);return e?e.description:t}},watch:{selectedItems:{handler(){this.autoGenerateLink()},deep:!0}}},qi={class:"d-flex mb-3 gap-2 flex-wrap"},Ji={class:"d-flex align-center mt-3 mb-3 flex-wrap gap-2"},Gi={class:"d-flex align-center"},Yi={key:0},Xi={key:1},Zi={class:"text-caption text-grey"};function ea(t,e,a,l,i,r){return w(),C(se,{border:"",class:"settings-link-generator mb-4"},{default:s(()=>[n(ce,{class:"text-h6"},{default:s(()=>[n(L,{start:"",icon:"mdi-link-variant",class:"mr-2"}),e[3]||(e[3]=d(" 设置分享 "))]),_:1}),n(Z,null,{default:s(()=>[D("div",qi,[n(x,{size:"small",variant:"tonal",color:"primary","prepend-icon":"mdi-select-all",onClick:r.selectAll},{default:s(()=>e[4]||(e[4]=[d(" 全选 ")])),_:1},8,["onClick"]),n(x,{size:"small",variant:"tonal",color:"primary","prepend-icon":"mdi-server-network",onClick:r.selectDataSourceSettings},{default:s(()=>e[5]||(e[5]=[d(" 数据源设置 ")])),_:1},8,["onClick"]),n(x,{size:"small",variant:"tonal",color:"primary","prepend-icon":"mdi-compare",onClick:r.selectChangedSettings},{default:s(()=>e[6]||(e[6]=[d(" 已变更设置 ")])),_:1},8,["onClick"]),n(x,{size:"small",variant:"tonal",color:"error","prepend-icon":"mdi-select-remove",onClick:r.resetSelection},{default:s(()=>e[7]||(e[7]=[d(" 取消选择 ")])),_:1},8,["onClick"])]),D("div",Ji,[n(xe,{color:"primary",class:"mr-2"},{default:s(()=>[d(" 已选 "+E(i.selectedItems.length)+" 项设置 ",1)]),_:1}),i.selectedItems.length>0?(w(!0),U(le,{key:0},fe(i.selectedItems,o=>(w(),C(xe,{key:o,size:"small",class:"mr-1",variant:"text"},{default:s(()=>[d(E(r.getSettingDescription(o)),1)]),_:2},1024))),128)):H("",!0)]),n(ue,{modelValue:i.generatedLink,"onUpdate:modelValue":e[0]||(e[0]=o=>i.generatedLink=o),label:"生成的链接",readonly:"",variant:"outlined",class:"mb-2","append-inner-icon":i.linkCopied?"mdi-check":"mdi-content-copy","onClick:appendInner":r.copyLink},null,8,["modelValue","append-inner-icon","onClick:appendInner"]),n(mn,{variant:"accordion"},{default:s(()=>[n(bn,null,{default:s(()=>[n(vn,null,{default:s(()=>e[8]||(e[8]=[d(" 显示设置列表详情 ")])),_:1}),n(yn,null,{default:s(()=>[n(nn,{"items-per-page":r.settingItems.length,headers:i.headers,items:r.filteredItems,"item-value":"key",modelValue:i.selectedItems,"onUpdate:modelValue":e[2]||(e[2]=o=>i.selectedItems=o),"show-select":"",density:"compact",class:"rounded setting-table","onUpdate:selected":r.handleSelectionChange,"sort-by":[{key:"isChanged",order:"desc"}]},{top:s(()=>[n(ue,{modelValue:i.search,"onUpdate:modelValue":e[1]||(e[1]=o=>i.search=o),label:"搜索设置","prepend-inner-icon":"mdi-magnify","single-line":"","hide-details":"",class:"mb-4"},null,8,["modelValue"])]),"item.description":s(({item:o})=>[D("div",Gi,[n(L,{size:"small",icon:o.icon,class:"mr-2"},null,8,["icon"]),d(" "+E(o.description),1)])]),"item.value":s(({item:o})=>[typeof o.value=="boolean"?(w(),U("span",Yi,E(o.value?"是":"否"),1)):(w(),U("span",Xi,E(o.value),1))]),"item.key":s(({item:o})=>[D("span",Zi,E(o.key),1)]),"item.isChanged":s(({item:o})=>[n(xe,{size:"x-small",color:o.isChanged?"warning":"success",text:o.isChanged?"已修改":"默认",density:"compact"},null,8,["color","text"])]),_:2},1032,["items-per-page","headers","items","modelValue","onUpdate:selected"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}const ta=K(Wi,[["render",ea]]),na={name:"Settings",components:{ServerSettingsCard:Ns,EditSettingsCard:Ls,RefreshSettingsCard:Ps,DisplaySettingsCard:Fs,MessageLog:wn,SettingsCard:he,StudentListCard:_i,AboutCard:Ui,DataProviderSettingsCard:Hs,ThemeSettingsCard:Ws,TagManagementCard:ai,EchoChamberCard:hi,SettingsExplorer:Qi,SettingsLinkGenerator:ta,SubjectManagementCard:Fi},setup(){const{mobile:t}=Zt();return{isMobile:t}},data(){return{settings:{server:{domain:v("server.domain"),classNumber:v("server.classNumber"),provider:v("server.provider")},refresh:{auto:v("refresh.auto"),interval:v("refresh.interval")},font:{size:v("font.size")},edit:{autoSave:v("edit.autoSave"),blockNonTodayAutoSave:v("edit.blockNonTodayAutoSave"),confirmNonTodaySave:v("edit.confirmNonTodaySave"),refreshBeforeEdit:v("edit.refreshBeforeEdit")},display:{emptySubjectDisplay:v("display.emptySubjectDisplay"),dynamicSort:v("display.dynamicSort"),showRandomButton:v("display.showRandomButton"),showFullscreenButton:v("display.showFullscreenButton")},developer:{enabled:v("developer.enabled"),showDebugConfig:v("developer.showDebugConfig")},message:{showSidebar:v("message.showSidebar"),maxActiveMessages:v("message.maxActiveMessages"),timeout:v("message.timeout"),saveHistory:v("message.saveHistory")}},dataProviders:[{title:"服务器",value:"server"},{title:"本地数据库",value:"indexedDB"}],studentData:{list:[],text:"",advanced:!1},newStudent:"",editingIndex:-1,editingName:"",deleteDialog:!1,studentToDelete:null,numberDialog:!1,newPosition:"",studentToMove:null,touchStartTime:0,touchTimeout:null,studentsLoading:!1,studentsError:null,debugConfig:"",loading:{server:!1,students:!1},hasUnsavedChanges:!1,lastSavedData:null}},watch:{settings:{handler(t){this.handleSettingsChange(t)},deep:!0},studentData:{handler(t){this.lastSavedData&&(this.hasUnsavedChanges=JSON.stringify(t.list)!==JSON.stringify(this.lastSavedData)),this.studentData.text=t.list.join(`
`)},deep:!0}},mounted(){this.loadAllSettings(),this.unwatchSettings=gt(()=>{this.loadAllSettings()}),this.loadStudentList(),this.refreshDebugConfig(),this.settings.developer.enabled||(this.settings.developer.showDebugConfig=!1,this.handleSettingsChange(this.settings))},beforeUnmount(){this.unwatchSettings&&this.unwatchSettings()},methods:{loadAllSettings(){Object.keys(this.settings).forEach(t=>{Object.keys(this.settings[t]).forEach(e=>{this.settings[t][e]=v(`${t}.${e}`)})})},handleSettingsChange(t){this.settingsChangeTimeout&&clearTimeout(this.settingsChangeTimeout),this.settingsChangeTimeout=setTimeout(()=>{Object.entries(t).forEach(([e,a])=>{Object.entries(a).forEach(([l,i])=>{const r=`${e}.${l}`,o=v(r);i!==o&&(pe(r,i)?this.showMessage("设置已更新",`${r} 已保存`):(this.showError("保存失败",`${r} 设置失败`),this.settings[e][l]=o))})})},100)},showMessage(t,e="",a="success"){this.$message[a](t,e)},showError(t,e=""){this.$message.error(t,e)},async loadStudentList(){try{this.loading.students=!0,this.studentsError=null;const t=v("server.domain"),e=v("server.classNumber"),a=v("server.provider");if(!e)throw new Error("请先设置班号");const l=a==="server"?`${t}/${e}`:e,i=await Xe.loadConfig(a,l);if(!i.success)throw new Error(i.error.message);i.data&&Array.isArray(i.data.studentList)&&(this.studentData.list=i.data.studentList,this.studentData.text=i.data.studentList.join(`
`),this.lastSavedData=[...i.data.studentList],this.hasUnsavedChanges=!1)}catch(t){console.error("加载学生列表失败:",t),this.studentsError=t.message||"加载失败，请检查设置",this.showError("加载失败",this.studentsError)}finally{this.loading.students=!1}},async saveStudents(){try{const t=v("server.domain"),e=v("server.classNumber"),a=v("server.provider");if(!e)throw new Error("请先设置班号");const l=a==="server"?`${t}/${e}`:e,i=await Xe.saveConfig(a,l,{studentList:this.studentData.list});if(!i.success)throw new Error(i.error.message);this.lastSavedData=[...this.studentData.list],this.hasUnsavedChanges=!1,this.showMessage("保存成功","学生列表已更新")}catch(t){console.error("保存学生列表失败:",t),this.showError("保存失败",t.message||"请重试")}},handleStudentDataChange(t){JSON.stringify(t.list)!==JSON.stringify(this.studentData.list)&&(this.studentData={...t},this.lastSavedData&&(this.hasUnsavedChanges=JSON.stringify(t.list)!==JSON.stringify(this.lastSavedData)))},saveEdit(){if(this.editingIndex!==-1){const t=this.editingName.trim();t&&t!==this.studentData.list[this.editingIndex]&&(this.studentData.list[this.editingIndex]=t),this.editingIndex=-1,this.editingName=""}},startEdit(t,e){this.editingIndex=t,this.editingName=e},confirmDelete(t){this.studentToDelete={index:t,name:this.studentData.list[t]},this.deleteDialog=!0},moveStudent(t,e){const a=e==="up"?t-1:t+1;a>=0&&a<this.studentData.list.length&&([this.studentData.list[t],this.studentData.list[a]]=[this.studentData.list[a],this.studentData.list[t]])},setStudentNumber(t){this.studentToMove=t,this.newPosition=String(t+1),this.numberDialog=!0},applyNewPosition(){const t=parseInt(this.newPosition)-1;if(this.studentToMove!==null&&t>=0&&t<this.studentData.list.length&&t!==this.studentToMove){const e=this.studentData.list[this.studentToMove];this.studentData.list.splice(this.studentToMove,1),this.studentData.list.splice(t,0,e)}this.numberDialog=!1,this.studentToMove=null,this.newPosition=""},moveToTop(t){if(t>0){const e=this.studentData.list[t];this.studentData.list.splice(t,1),this.studentData.list.unshift(e)}},addStudent(){const t=this.newStudent.trim();t&&!this.studentData.list.includes(t)&&(this.studentData.list.push(t),this.newStudent="")},removeStudent(t){t!==void 0&&(this.studentData.list.splice(t,1),this.deleteDialog=!1,this.studentToDelete=null)},resetFontSize(){ht("font.size"),this.settings.font.size=v("font.size"),this.showMessage("字体已重置","字体大小已恢复默认值")},refreshDebugConfig(){const t={};Object.keys(this.settings).forEach(e=>{t[e]={},Object.keys(this.settings[e]).forEach(a=>{t[e][a]=v(`${e}.${a}`)})}),this.debugConfig=JSON.stringify(t,null,2)},async copyDebugConfig(){try{await navigator.clipboard.writeText(this.debugConfig),this.showMessage("复制成功","配置信息已复制到剪贴板")}catch(t){console.error("复制失败:",t),this.showError("复制失败","请手动复制")}},handleDeveloperChange(t){t||(this.settings.developer.showDebugConfig=!1,this.settings.message={showSidebar:!0,maxActiveMessages:5,timeout:5e3,saveHistory:!0})},resetDeveloperSettings(){this.settings.developer={enabled:!1,showDebugConfig:!1},this.settings.message={showSidebar:!0,maxActiveMessages:5,timeout:5e3,saveHistory:!0},this.handleSettingsChange(this.settings),this.showMessage("已重置","开发者设置已重置为默认值","warning")},adjustFontSize(t){const a=this.settings.font.size;t==="up"&&a<100?this.settings.font.size=a+2:t==="down"&&a>16&&(this.settings.font.size=a-2),this.handleSettingsChange(this.settings)},onSettingsSaved(){this.showMessage("设置已更新","您的设置已成功保存")},onSettingUpdate(t,e){this.showMessage("设置已更新",`${t} 已保存为 ${e}`)}}},sa={class:"settings-page"},ia={key:0},aa={class:"d-flex gap-2"},oa={class:"settings-actions"};function ra(t,e,a,l,i,r){const o=V("server-settings-card"),c=V("data-provider-settings-card"),h=V("edit-settings-card"),g=V("refresh-settings-card"),m=V("display-settings-card"),S=V("theme-settings-card"),A=V("tag-management-card"),T=V("settings-link-generator"),B=V("settings-card"),ee=V("student-list-card"),ae=V("subject-management-card"),Y=V("echo-chamber-card"),q=V("about-card"),re=V("settings-explorer"),F=V("message-log"),$=V("n-button");return w(),U("div",sa,[n(fn,{elevation:"1"},{prepend:s(()=>[n(x,{icon:"mdi-arrow-left",variant:"text",onClick:e[0]||(e[0]=y=>t.$router.push("/"))})]),default:s(()=>[n(pn,{class:"text-h6"},{default:s(()=>e[5]||(e[5]=[d("设置")])),_:1})]),_:1}),n(tn,{class:"py-4 px-3"},{default:s(()=>[n(de,{class:"ma-0"},{default:s(()=>[n(O,{cols:"12",md:"6",class:"pa-2"},{default:s(()=>[n(o,{border:"",loading:i.loading.server,onSaved:r.onSettingsSaved,class:"h-100"},null,8,["loading","onSaved"])]),_:1}),n(O,{cols:"12",md:"6"},{default:s(()=>[n(c,{border:""})]),_:1}),n(O,{cols:"12",md:"6"},{default:s(()=>[n(h,{onSaved:r.onSettingsSaved,border:""},null,8,["onSaved"])]),_:1}),n(O,{cols:"12",md:"6"},{default:s(()=>[n(g,{onSaved:r.onSettingsSaved,border:""},null,8,["onSaved"])]),_:1}),n(O,{cols:"12",md:"6"},{default:s(()=>[n(m,{onSaved:r.onSettingsSaved,border:""},null,8,["onSaved"])]),_:1}),n(O,{cols:"12",md:"6"},{default:s(()=>[n(S,{border:""})]),_:1}),n(O,{cols:"12",md:"6"},{default:s(()=>[n(A,{onSaved:r.onSettingsSaved,border:""},null,8,["onSaved"])]),_:1}),n(O,{cols:"12"},{default:s(()=>[n(T,{border:""})]),_:1}),n(O,{cols:12,md:i.settings.developer.enabled?12:6},{default:s(()=>[n(B,{border:"",title:"开发者选项",icon:"mdi-developer-board"},{default:s(()=>[n(ie,null,{default:s(()=>[n(j,null,{prepend:s(()=>[n(L,{icon:"mdi-code-tags",class:"mr-3"})]),append:s(()=>[n(Ve,{modelValue:i.settings.developer.enabled,"onUpdate:modelValue":e[1]||(e[1]=y=>i.settings.developer.enabled=y),density:"comfortable","hide-details":"",onChange:r.handleDeveloperChange},null,8,["modelValue","onChange"])]),default:s(()=>[n(P,null,{default:s(()=>e[6]||(e[6]=[d("启用开发者选项")])),_:1}),n(X,null,{default:s(()=>e[7]||(e[7]=[d("启用后可以查看和修改开发者设置")])),_:1})]),_:1}),i.settings.developer.enabled?(w(),U(le,{key:0},[n(R,{class:"my-2"}),n(j,null,{prepend:s(()=>[n(L,{icon:"mdi-file-code",class:"mr-3"})]),append:s(()=>[n(Ve,{modelValue:i.settings.developer.showDebugConfig,"onUpdate:modelValue":e[2]||(e[2]=y=>i.settings.developer.showDebugConfig=y),density:"comfortable","hide-details":""},null,8,["modelValue"])]),default:s(()=>[n(P,null,{default:s(()=>e[8]||(e[8]=[d("显示调试配置")])),_:1}),n(X,null,{default:s(()=>e[9]||(e[9]=[d("显示当前的调试配置信息")])),_:1})]),_:1}),n(Fe,null,{default:s(()=>[i.settings.developer.showDebugConfig?(w(),U("div",ia,[n(R,{class:"my-2"}),n(yt,{modelValue:i.debugConfig,"onUpdate:modelValue":e[3]||(e[3]=y=>i.debugConfig=y),label:"调试配置",readonly:"",rows:"10",class:"font-monospace mt-2"},null,8,["modelValue"]),D("div",aa,[n(x,{"prepend-icon":"mdi-refresh",variant:"text",onClick:r.refreshDebugConfig},{default:s(()=>e[10]||(e[10]=[d(" 刷新 ")])),_:1},8,["onClick"]),n(x,{"prepend-icon":"mdi-content-copy",variant:"text",onClick:r.copyDebugConfig},{default:s(()=>e[11]||(e[11]=[d(" 复制 ")])),_:1},8,["onClick"])])])):H("",!0)]),_:1})],64)):H("",!0)]),_:1})]),_:1})]),_:1},8,["md"]),n(O,{cols:"12"},{default:s(()=>[n(ee,{modelValue:i.studentData,"onUpdate:modelValue":[e[4]||(e[4]=y=>i.studentData=y),r.handleStudentDataChange],loading:i.loading.students,error:i.studentsError,"is-mobile":l.isMobile,"unsaved-changes":i.hasUnsavedChanges,onSave:r.saveStudents,onReload:r.loadStudentList},null,8,["modelValue","loading","error","is-mobile","unsaved-changes","onSave","onReload","onUpdate:modelValue"])]),_:1}),n(O,{cols:"12"},{default:s(()=>[n(ae,{border:""})]),_:1}),n(O,{cols:"12"},{default:s(()=>[n(Y,{border:""})]),_:1}),n(O,{cols:"12"},{default:s(()=>[n(q)]),_:1}),i.settings.developer.enabled?(w(),C(O,{key:0,cols:"12"},{default:s(()=>[n(se,{border:""},{default:s(()=>[n(ce,{class:"d-flex align-center"},{default:s(()=>[n(L,{icon:"mdi-cog-outline",class:"mr-2"}),e[12]||(e[12]=d(" 所有设置 "))]),_:1}),n(en,null,{default:s(()=>e[13]||(e[13]=[d(" 浏览和修改所有可用设置 ")])),_:1}),n(Z,null,{default:s(()=>[n(re,{onUpdate:r.onSettingUpdate},null,8,["onUpdate"])]),_:1})]),_:1})]),_:1})):H("",!0)]),_:1})]),_:1}),n(F,{ref:"messageLog"},null,512),D("div",oa,[n($,{onClick:r.resetDeveloperSettings,type:"warning",size:"small"},{default:s(()=>e[14]||(e[14]=[d(" 重置开发者设置 ")])),_:1},8,["onClick"]),n($,{onClick:t.resetMessageSettings,type:"warning",size:"small"},{default:s(()=>e[15]||(e[15]=[d(" 重置消息设置 ")])),_:1},8,["onClick"])])])}const ma=K(na,[["render",ra]]);export{ma as default};
